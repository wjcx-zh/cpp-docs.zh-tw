---
title: 日期類型
ms.date: 11/04/2016
f1_keywords:
- DATE
helpviewer_keywords:
- Date data type, implementing
- Date data type
- DATE type
- Date data type, about Date data type
- MFC, date and time
- hour values representation
ms.assetid: 695853ed-b614-4575-b793-b8c287372038
ms.openlocfilehash: 5a6c1e1cca5b2cb978d6af4208377db1a2926357
ms.sourcegitcommit: a1676bf6caae05ecd698f26ed80c08828722b237
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/29/2020
ms.locfileid: "91502183"
---
# <a name="date-type"></a>日期類型

日期類型是使用8位元組浮點數來執行。 天數是以整數遞增的方式表示，從1899年12月30日起算，以時間為零。 小時值則以小數點後數字部分的絕對值來表示。 下表說明數個日期以及其日期類型的對等專案：

|日期和時間|表示法|
|-------------------|--------------------|
|1899年12月30日，午夜|0.00|
|1年1月1900，午夜|2.00|
|1900年1月4日，午夜|5.00|
|4月1900日，上午6點|5.25|
|4年1月1900，中午|5.50|
|4月1900日，下午9點|5.875|

日期日期類型以及 `COleDateTime` 類別，會將日期和時程表示為傳統的數位行。 `COleDateTime`類別包含數個處理日期值的方法，包括其他一般日期格式的轉換。

在自動化中使用這些日期和時間格式時，應注意下列幾點：

- 日期會以當地時間指定;使用不同時區的日期時，必須手動執行同步處理。

- 日期類型不會考慮日光節約時間。

- 日期時間軸會在1899年12月30日之前的日期值小於 0 (變成非連續的) 。 這是因為日期值的整數部分會被視為帶正負號，而小數部分則會被視為未簽署。 換句話說，日期值的整數部分可以是正數或負數，而日期值的小數部分則一律會加到整體的邏輯日期。 下表說明一些範例：

|日期和時間|表示法|
|-------------------|--------------------|
|1899年12月27日，午夜|-3.00|
|1899年12月28日，中午|-2.50|
|1899年12月28日，午夜|-2.00|
|1899年12月29日，午夜|-1.00|
|1899年12月30日下午6點|-0.75|
|1899年12月30日，中午|-0.50|
|1899年12月30日，上午6點|-0.25|
|1899年12月30日，午夜|0.00|
|1899年12月30日，上午6點|0.25|
|1899年12月30日，中午|0.50|
|1899年12月30日下午6點|0.75|
|1899年12月31日，午夜|1.00|
|1年1月1900，午夜|2.00|
|1年1月1900，中午|2.50|
|2年1月1900，午夜|3.00|

> [!CAUTION]
> 請注意，因為 6:00 AM 一律是以小數值0.25 表示，不論代表 day 的整數是在12月30日之後的 (、1899) 或負 (，在 1899) 之前，簡單的浮點數比較都會錯誤地排序任何代表當天上午6:00 的 *日期（代表* 當天的12/30/1899）。

有關與日期和類型相關之問題的詳細資訊， `COleDateTime` 請參閱 [COleDateTime 類別](../atl-mfc-shared/reference/coledatetime-class.md) 和 [日期和時間：自動化支援](./date-and-time.md)。

## <a name="see-also"></a>另請參閱

[日期及時間](../atl-mfc-shared/date-and-time.md)<br/>
[COleDateTime 類別](../atl-mfc-shared/reference/coledatetime-class.md)
