---
title: CMDIFrameWndEx 類別
ms.date: 11/04/2016
f1_keywords:
- CMDIFrameWndEx
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ActiveItemRecalcLayout
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AddPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AdjustClientArea
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AdjustDockingLayout
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AreMDITabs
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::CanCovertControlBarToMDIChild
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ControlBarToTabbedDocument
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::CreateDocumentWindow
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::CreateNewWindow
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::DockPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::DockPaneLeftOf
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableAutoHidePanes
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableDocking
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableFullScreenMainMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableFullScreenMode
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableLoadDockState
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableMDITabbedGroups
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableMDITabs
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableMDITabsLastActiveActivation
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnablePaneMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableWindowsDialog
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetActivePopup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetDefaultResId
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMDITabGroups
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMDITabs
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMDITabsContextMenuAllowedItems
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMenuBar
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetRibbonBar
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetTearOffBars
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetToolbarButtonToolTipText
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::InsertPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsFullScreen
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsMDITabbedGroup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsMemberOfMDITabGroup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsMenuBarAvailable
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsPointNearDockSite
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsPrintPreview
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::LoadFrame
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::LoadMDIState
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::MDITabMoveToNextGroup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::MDITabNewGroup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::NegotiateBorderSpace
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnCloseDockingPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnCloseMiniFrame
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnClosePopupMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnCmdMsg
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnDrawMenuImage
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnDrawMenuLogo
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnEraseMDIClientBackground
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnMenuButtonToolHitTest
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnMoveMiniFrame
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnSetPreviewMode
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowCustomizePane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowMDITabContextMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowPanes
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowPopupMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnSizeMDIClient
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnTearOffMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnUpdateFrameMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::PaneFromPoint
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::RecalcLayout
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::RemovePaneFromDockManager
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::SaveMDIState
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::SetPrintPreviewFrame
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::SetupToolbarMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ShowFullScreen
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ShowPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ShowWindowsDialog
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::TabbedDocumentToControlBar
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::UpdateCaption
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::UpdateMDITabbedBarsIcons
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::WinHelp
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::m_bCanCovertControlBarToMDIChild
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::m_bDisableSetRedraw
helpviewer_keywords:
- CMDIFrameWndEx [MFC], ActiveItemRecalcLayout
- CMDIFrameWndEx [MFC], AddPane
- CMDIFrameWndEx [MFC], AdjustClientArea
- CMDIFrameWndEx [MFC], AdjustDockingLayout
- CMDIFrameWndEx [MFC], AreMDITabs
- CMDIFrameWndEx [MFC], CanCovertControlBarToMDIChild
- CMDIFrameWndEx [MFC], ControlBarToTabbedDocument
- CMDIFrameWndEx [MFC], CreateDocumentWindow
- CMDIFrameWndEx [MFC], CreateNewWindow
- CMDIFrameWndEx [MFC], DockPane
- CMDIFrameWndEx [MFC], DockPaneLeftOf
- CMDIFrameWndEx [MFC], EnableAutoHidePanes
- CMDIFrameWndEx [MFC], EnableDocking
- CMDIFrameWndEx [MFC], EnableFullScreenMainMenu
- CMDIFrameWndEx [MFC], EnableFullScreenMode
- CMDIFrameWndEx [MFC], EnableLoadDockState
- CMDIFrameWndEx [MFC], EnableMDITabbedGroups
- CMDIFrameWndEx [MFC], EnableMDITabs
- CMDIFrameWndEx [MFC], EnableMDITabsLastActiveActivation
- CMDIFrameWndEx [MFC], EnablePaneMenu
- CMDIFrameWndEx [MFC], EnableWindowsDialog
- CMDIFrameWndEx [MFC], GetActivePopup
- CMDIFrameWndEx [MFC], GetPane
- CMDIFrameWndEx [MFC], GetDefaultResId
- CMDIFrameWndEx [MFC], GetMDITabGroups
- CMDIFrameWndEx [MFC], GetMDITabs
- CMDIFrameWndEx [MFC], GetMDITabsContextMenuAllowedItems
- CMDIFrameWndEx [MFC], GetMenuBar
- CMDIFrameWndEx [MFC], GetRibbonBar
- CMDIFrameWndEx [MFC], GetTearOffBars
- CMDIFrameWndEx [MFC], GetToolbarButtonToolTipText
- CMDIFrameWndEx [MFC], InsertPane
- CMDIFrameWndEx [MFC], IsFullScreen
- CMDIFrameWndEx [MFC], IsMDITabbedGroup
- CMDIFrameWndEx [MFC], IsMemberOfMDITabGroup
- CMDIFrameWndEx [MFC], IsMenuBarAvailable
- CMDIFrameWndEx [MFC], IsPointNearDockSite
- CMDIFrameWndEx [MFC], IsPrintPreview
- CMDIFrameWndEx [MFC], LoadFrame
- CMDIFrameWndEx [MFC], LoadMDIState
- CMDIFrameWndEx [MFC], MDITabMoveToNextGroup
- CMDIFrameWndEx [MFC], MDITabNewGroup
- CMDIFrameWndEx [MFC], NegotiateBorderSpace
- CMDIFrameWndEx [MFC], OnCloseDockingPane
- CMDIFrameWndEx [MFC], OnCloseMiniFrame
- CMDIFrameWndEx [MFC], OnClosePopupMenu
- CMDIFrameWndEx [MFC], OnCmdMsg
- CMDIFrameWndEx [MFC], OnDrawMenuImage
- CMDIFrameWndEx [MFC], OnDrawMenuLogo
- CMDIFrameWndEx [MFC], OnEraseMDIClientBackground
- CMDIFrameWndEx [MFC], OnMenuButtonToolHitTest
- CMDIFrameWndEx [MFC], OnMoveMiniFrame
- CMDIFrameWndEx [MFC], OnSetPreviewMode
- CMDIFrameWndEx [MFC], OnShowCustomizePane
- CMDIFrameWndEx [MFC], OnShowMDITabContextMenu
- CMDIFrameWndEx [MFC], OnShowPanes
- CMDIFrameWndEx [MFC], OnShowPopupMenu
- CMDIFrameWndEx [MFC], OnSizeMDIClient
- CMDIFrameWndEx [MFC], OnTearOffMenu
- CMDIFrameWndEx [MFC], OnUpdateFrameMenu
- CMDIFrameWndEx [MFC], PaneFromPoint
- CMDIFrameWndEx [MFC], RecalcLayout
- CMDIFrameWndEx [MFC], RemovePaneFromDockManager
- CMDIFrameWndEx [MFC], SaveMDIState
- CMDIFrameWndEx [MFC], SetPrintPreviewFrame
- CMDIFrameWndEx [MFC], SetupToolbarMenu
- CMDIFrameWndEx [MFC], ShowFullScreen
- CMDIFrameWndEx [MFC], ShowPane
- CMDIFrameWndEx [MFC], ShowWindowsDialog
- CMDIFrameWndEx [MFC], TabbedDocumentToControlBar
- CMDIFrameWndEx [MFC], UpdateCaption
- CMDIFrameWndEx [MFC], UpdateMDITabbedBarsIcons
- CMDIFrameWndEx [MFC], WinHelp
- CMDIFrameWndEx [MFC], m_bCanCovertControlBarToMDIChild
- CMDIFrameWndEx [MFC], m_bDisableSetRedraw
ms.assetid: dbcafcb3-9a7a-4f11-9dfe-ba57565c81d0
ms.openlocfilehash: dad7c72510c64f5e63586a204f8994f429e7f80f
ms.sourcegitcommit: 8fd49f8ac20457710ceb5403ca46fc73cb3f95f8
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/01/2020
ms.locfileid: "85737441"
---
# <a name="cmdiframewndex-class"></a>CMDIFrameWndEx 類別

擴充[CMDIFrameWnd](../../mfc/reference/cframewnd-class.md)的功能，也就是 Windows 多重文件介面（MDI）框架視窗。

## <a name="syntax"></a>語法

```
class CMDIFrameWndEx : public CMDIFrameWnd
```

## <a name="members"></a>成員

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CMDIFrameWndEx：： ActiveItemRecalcLayout](#activeitemrecalclayout)|重新計算現用專案的版面配置。|
|`CMDIFrameWndEx::AddDockSite`|沒有使用這個方法。|
|[CMDIFrameWndEx：： AddPane](#addpane)|向銜接管理員註冊窗格。|
|[CMDIFrameWndEx：： AdjustClientArea](#adjustclientarea)|縮小工作區以允許框線。|
|[CMDIFrameWndEx：： AdjustDockingLayout](#adjustdockinglayout)|重新計算所有停駐窗格的版面配置。|
|[CMDIFrameWndEx：： AreMDITabs](#aremditabs)|決定是否啟用 [MDI 索引標籤] 功能或 [MDI 索引標籤式群組] 功能。|
|[CMDIFrameWndEx：： CanCovertControlBarToMDIChild](#cancovertcontrolbartomdichild)|由架構呼叫以判斷框架視窗是否可以將停駐窗格轉換成索引標籤式檔。|
|[CMDIFrameWndEx：： ControlBarToTabbedDocument](#controlbartotabbeddocument)|將指定的停駐窗格轉換成索引標籤式檔。|
|[CMDIFrameWndEx：： CreateDocumentWindow](#createdocumentwindow)|建立子文件視窗。|
|[CMDIFrameWndEx：： CreateNewWindow](#createnewwindow)|由架構呼叫以建立新視窗。|
|`CMDIFrameWndEx::CreateObject`|由建立此類別類型的動態執行個體架構所使用。|
|[CMDIFrameWndEx：:D ockPane](#dockpane)|將指定的窗格停駐到框架視窗。|
|[CMDIFrameWndEx：:D ockPaneLeftOf](#dockpaneleftof)|將窗格停駐在另一個窗格的左邊。|
|[CMDIFrameWndEx：： EnableAutoHidePanes](#enableautohidepanes)|當窗格停駐于主框架視窗的指定側邊時，啟用其自動隱藏模式。|
|[CMDIFrameWndEx：： EnableDocking](#enabledocking)|啟用停駐屬於 MDI 框架視窗的窗格。|
|[CMDIFrameWndEx::EnableFullScreenMainMenu](#enablefullscreenmainmenu)|以全螢幕模式顯示或隱藏主功能表。|
|[CMDIFrameWndEx::EnableFullScreenMode](#enablefullscreenmode)|啟用框架視窗的全螢幕模式。|
|[CMDIFrameWndEx::EnableLoadDockState](#enableloaddockstate)|啟用或停用銜接狀態的載入。|
|[CMDIFrameWndEx：： EnableMDITabbedGroups](#enablemditabbedgroups)|啟用或停用 MDI 索引標籤式群組功能。|
|[CMDIFrameWndEx：： EnableMDITabs](#enablemditabs)|啟用或停用 [MDI 索引標籤] 功能。 啟用時，框架視窗會顯示每個 MDI 子視窗的索引標籤。|
|[CMDIFrameWndEx：： EnableMDITabsLastActiveActivation](#enablemditabslastactiveactivation)|指定當使用者關閉目前的索引標籤時，是否應啟用最後一個使用中的索引標籤。|
|[CMDIFrameWndEx：： EnablePaneMenu](#enablepanemenu)|啟用或停用快顯窗格功能表的自動建立和管理，這會顯示應用程式窗格清單。  .|
|[CMDIFrameWndEx：： EnableWindowsDialog](#enablewindowsdialog)|插入其命令 ID 呼叫[CMFCWindowsManagerDialog](../../mfc/reference/cmfcwindowsmanagerdialog-class.md)對話方塊的功能表項目。|
|[CMDIFrameWndEx：： GetActivePopup](#getactivepopup)|將指標傳回到目前顯示的快顯功能表。|
|[CMDIFrameWndEx：： GetPane](#getpane)|傳回具有指定控制項 ID 之窗格的指標。|
|[CMDIFrameWndEx：： GetDefaultResId](#getdefaultresid)|傳回 MDI 框架視窗之共用資源的識別碼。|
|[CMDIFrameWndEx：： GetMDITabGroups](#getmditabgroups)|傳回 MDI 索引標籤式視窗的清單。|
|[CMDIFrameWndEx：： GetMDITabs](#getmditabs)|傳回加底線索引標籤式視窗的參考。|
|[CMDIFrameWndEx：： GetMDITabsCoNtextMenuAllowedItems](#getmditabscontextmenualloweditems)|傳回旗標的組合，用來決定啟用 MDI 索引標籤式群組功能時，哪些內容功能表項目是有效的。|
|[CMDIFrameWndEx：： GetMenuBar](#getmenubar)|傳回附加至框架視窗的功能表列物件指標。|
|[CMDIFrameWndEx::GetRibbonBar](#getribbonbar)|抓取框架的功能區列控制項。|
|[CMDIFrameWndEx：： GetTearOffBars](#gettearoffbars)|傳回處於卸載狀態的[CPane](../../mfc/reference/cpane-class.md)衍生物件清單。|
|`CMDIFrameWndEx::GetThisClass`|由架構呼叫，以取得與此類別類型相關聯之[CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md)物件的指標。|
|[CMDIFrameWndEx::GetToolbarButtonToolTipText](#gettoolbarbuttontooltiptext)|當應用程式顯示工具列按鈕的工具提示時，由架構呼叫。|
|[CMDIFrameWndEx：： InsertPane](#insertpane)|向銜接管理員註冊指定的窗格。|
|[CMDIFrameWndEx::IsFullScreen](#isfullscreen)|判斷框架視窗是否處於全螢幕模式。|
|[CMDIFrameWndEx：： IsMDITabbedGroup](#ismditabbedgroup)|決定是否啟用 MDI 索引標籤式群組功能。|
|[CMDIFrameWndEx：： IsMemberOfMDITabGroup](#ismemberofmditabgroup)|判斷指定的索引標籤式視窗是否在 MDI 索引標籤式群組的視窗清單中。|
|[CMDIFrameWndEx：： IsMenuBarAvailable](#ismenubaravailable)|決定框架視窗是否有功能表列。|
|[CMDIFrameWndEx：： IsPointNearDockSite](#ispointneardocksite)|判斷指定的點是否接近 dock 網站。|
|[CMDIFrameWndEx::IsPrintPreview](#isprintpreview)|判斷框架視窗是否處於預覽列印模式。|
|[CMDIFrameWndEx：： LoadFrame](#loadframe)|從資源資訊建立框架視窗。 (覆寫 `CMDIFrameWnd::LoadFrame`。)|
|[CMDIFrameWndEx：： LoadMDIState](#loadmdistate)|載入 MDI 索引標籤式群組的指定版面配置，以及先前開啟之檔的清單。|
|[CMDIFrameWndEx：： MDITabMoveToNextGroup](#mditabmovetonextgroup)|將作用中索引標籤從目前使用中的索引標籤式視窗移到下一個或上一個索引標籤式|
|[CMDIFrameWndEx：： MDITabNewGroup](#mditabnewgroup)|建立具有單一視窗的新索引標籤式群組。|
|[CMDIFrameWndEx：： NegotiateBorderSpace](#negotiateborderspace)|在 OLE 就地啟用期間，協調框架視窗中的框線空間。|
|[CMDIFrameWndEx：： OnCloseDockingPane](#onclosedockingpane)|當使用者按一下可停駐窗格上的 [**關閉**] 按鈕時由架構呼叫。|
|[CMDIFrameWndEx：： OnCloseMiniFrame](#oncloseminiframe)|當使用者按一下浮動迷你框架視窗上的 [**關閉**] 按鈕時，由架構呼叫。|
|[CMDIFrameWndEx：： OnClosePopupMenu](#onclosepopupmenu)|架構在作用中的快顯功能表處理 WM_DESTROY 訊息時所呼叫。|
|[CMDIFrameWndEx：： OnCmdMsg](#oncmdmsg)|由架構呼叫以路由傳送和分派命令訊息，以及更新命令使用者介面物件。|
|[CMDIFrameWndEx：： OnDrawMenuImage](#ondrawmenuimage)|架構在繪製與功能表項目相關聯的映像時所呼叫。|
|[CMDIFrameWndEx：： OnDrawMenuLogo](#ondrawmenulogo)|當[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)處理 WM_PAINT 訊息時，由架構呼叫。|
|[CMDIFrameWndEx：： OnEraseMDIClientBackground](#onerasemdiclientbackground)|當 MDI 框架視窗處理 WM_ERASEBKGND 訊息時，由架構呼叫。|
|[CMDIFrameWndEx：： OnMenuButtonToolHitTest](#onmenubuttontoolhittest)|當[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)物件處理 WM_NCHITTEST 訊息時，由架構呼叫。|
|[CMDIFrameWndEx：： OnMoveMiniFrame](#onmoveminiframe)|由架構呼叫以移動迷你框架視窗。|
|[CMDIFrameWndEx：： OnSetPreviewMode](#onsetpreviewmode)|設定應用程式的主框架視窗預覽列印模式。 (覆寫 [CFrameWnd::OnSetPreviewMode](../../mfc/reference/cframewnd-class.md#onsetpreviewmode)。)|
|[CMDIFrameWndEx：： OnShowCustomizePane](#onshowcustomizepane)|當快速自訂窗格啟動時由架構呼叫。|
|[CMDIFrameWndEx：： OnShowMDITabCoNtextMenu](#onshowmditabcontextmenu)|當內容功能表應該顯示在其中一個索引標籤上時，由架構呼叫。 （僅適用于 MDI 索引標籤式群組）。|
|[CMDIFrameWndEx：： OnShowPanes](#onshowpanes)|由架構呼叫以顯示或隱藏窗格。|
|[CMDIFrameWndEx：： OnShowPopupMenu](#onshowpopupmenu)|架構在啟動快顯功能表時所呼叫。|
|[CMDIFrameWndEx::OnSizeMDIClient](#onsizemdiclient)|當用戶端 MDI 視窗的大小變更時由架構呼叫。|
|[CMDIFrameWndEx：： OnTearOffMenu](#ontearoffmenu)|架構在啟動有分割列的功能表時所呼叫。|
|[CMDIFrameWndEx：： OnUpdateFrameMenu](#onupdateframemenu)|由架構呼叫以更新框架功能表。 (覆寫 `CMDIFrameWnd::OnUpdateFrameMenu`。)|
|[CMDIFrameWndEx：:P aneFromPoint](#panefrompoint)|傳回包含指定點的停駐窗格。|
|`CMDIFrameWndEx::PreTranslateMessage`|[CWinApp](../../mfc/reference/cwinapp-class.md) 類別用來轉譯分派至 [TranslateMessage](/windows/win32/api/winuser/nf-winuser-translatemessage) 和 [DispatchMessage](/windows/win32/api/winuser/nf-winuser-dispatchmessage) Windows 函式之前的視窗訊息。  (覆寫 `CMDIFrameWnd::PreTranslateMessage`。)|
|[CMDIFrameWndEx：： RecalcLayout](#recalclayout)|由架構呼叫以重新計算框架視窗的版面配置。 （覆寫[CFrameWnd：： RecalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout)。）|
|[CMDIFrameWndEx：： RemovePaneFromDockManager](#removepanefromdockmanager)|取消註冊窗格，並將它從停駐管理員移除。|
|[CMDIFrameWndEx：： SaveMDIState](#savemdistate)|儲存 MDI 索引標籤式群組的目前版面配置，以及先前開啟之檔的清單。|
|[CMDIFrameWndEx::SetPrintPreviewFrame](#setprintpreviewframe)|設定預覽列印框架視窗。|
|[CMDIFrameWndEx：： SetupToolbarMenu](#setuptoolbarmenu)|藉由搜尋虛設項目並替換成指定的使用者定義項目，修改工具列物件。|
|[CMDIFrameWndEx::ShowFullScreen](#showfullscreen)|將主框架從一般模式切換至全螢幕模式。|
|[CMDIFrameWndEx：： ShowPane](#showpane)|顯示或隱藏指定的窗格。|
|[CMDIFrameWndEx：： ShowWindowsDialog](#showwindowsdialog)|建立[CMFCWindowsManagerDialog](../../mfc/reference/cmfcwindowsmanagerdialog-class.md) box 並加以開啟。|
|[CMDIFrameWndEx：： TabbedDocumentToControlBar](#tabbeddocumenttocontrolbar)|將指定的索引標籤式檔轉換成停駐窗格。|
|[CMDIFrameWndEx::UpdateCaption](#updatecaption)|由架構呼叫以更新視窗框架標題。|
|[CMDIFrameWndEx：： UpdateMDITabbedBarsIcons](#updatemditabbedbarsicons)|設定每個 MDI 索引標籤式窗格的圖示。|
|[CMDIFrameWndEx：： WinHelp](#winhelp)|架構所呼叫以起始 WinHelp 應用程式或內容說明。 （覆寫[CWnd：： WinHelp](../../mfc/reference/cwnd-class.md#winhelp)）。|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CMDIFrameWndEx：： m_bCanCovertControlBarToMDIChild](#m_bcancovertcontrolbartomdichild)|決定停駐窗格是否可轉換為 MDI 子視窗。|
|[CMDIFrameWndEx：： m_bDisableSetRedraw](#m_bdisablesetredraw)|啟用或停用 MDI 子視窗的重繪優化。|

## <a name="remarks"></a>備註

若要在 MDI 應用程式中利用擴充的自訂功能，請從衍生應用程式的 MDI 框架視窗類別， `CMDIFrameWndEx` 而不是 `CMDIFrameWnd` 。

## <a name="example"></a>範例

下列範例會從衍生類別 `CMDIFrameWndEx` 。 此程式碼片段來自[DrawClient 範例： MFC 功能區型 OLE 物件繪圖應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_DrawClient#1](../../mfc/reference/codesnippet/cpp/cmdiframewndex-class_1.h)]

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md)

[CMDIFrameWndEx](../../mfc/reference/cmdiframewndex-class.md)

## <a name="requirements"></a>需求

**標頭：** afxMDIFrameWndEx。h

## <a name="cmdiframewndexactiveitemrecalclayout"></a><a name="activeitemrecalclayout"></a>CMDIFrameWndEx：： ActiveItemRecalcLayout

重新計算現用專案的版面配置。

```cpp
void ActiveItemRecalcLayout();
```

## <a name="cmdiframewndexaddpane"></a><a name="addpane"></a>CMDIFrameWndEx：： AddPane

向銜接管理員註冊窗格。

```
BOOL AddPane(
    CBasePane* pControlBar,
    BOOL bTail=TRUE);
```

### <a name="parameters"></a>參數

*pControlBar*<br/>
在要註冊的窗格指標。

*bTail*<br/>
在指定是否要將此窗格新增至清單的結尾。

### <a name="return-value"></a>傳回值

如果已成功註冊窗格，則會傳回非零值。 如果窗格已經向銜接管理員註冊，則會傳回0。

### <a name="remarks"></a>備註

每個窗格都必須向[CDockingManager 類別](../../mfc/reference/cdockingmanager-class.md)註冊，才能在停駐配置中進行部分。 使用此方法來通知停駐管理員您想要將特定窗格固定在一起。 註冊該窗格後，停駐管理員會根據其對齊設定和停駐管理員所維護之窗格清單中的位置來對齊。

## <a name="cmdiframewndexadjustclientarea"></a><a name="adjustclientarea"></a>CMDIFrameWndEx：： AdjustClientArea

縮小工作區以允許框線。

```
virtual void AdjustClientArea();
```

## <a name="cmdiframewndexadjustdockinglayout"></a><a name="adjustdockinglayout"></a>CMDIFrameWndEx：： AdjustDockingLayout

重新計算所有停駐窗格的版面配置。

```
virtual void AdjustDockingLayout(HDWP hdwp=NULL);
```

### <a name="parameters"></a>參數

*hdwp*<br/>
在識別多視窗位置結構。 您可以藉由呼叫來取得此值 `BeginDeferWindowPos` 。

### <a name="remarks"></a>備註

呼叫這個成員函式可重新計算停駐于框架視窗的所有窗格配置。

## <a name="cmdiframewndexaremditabs"></a><a name="aremditabs"></a>CMDIFrameWndEx：： AreMDITabs

決定是否啟用 [MDI 索引標籤] 功能或 [MDI 索引標籤式群組] 功能。

```
BOOL AreMDITabs(int* pnMDITabsType=NULL) const;
```

### <a name="parameters"></a>參數

*pnMDITabsType*<br/>
脫銷整數變數的指標，表示已啟用的功能：

- 0：所有功能都已停用。

- 1： MDI 索引標籤已啟用。

- 2：已啟用 MDI 索引標籤式群組。

### <a name="return-value"></a>傳回值

如果已啟用 MDI 索引標籤或 MDI 索引標籤式群組，則傳回 TRUE。

如果上述功能皆未啟用，則傳回 FALSE。

### <a name="remarks"></a>備註

使用此函式來判斷框架視窗是否啟用 MDI 索引標籤或 MDI 索引標籤式群組。 使用[CMDIFrameWndEx：： EnableMDITabs](#enablemditabs)來啟用或停用 [MDI 索引標籤] 功能。

使用[CMDIFrameWndEx：： EnableMDITabbedGroups](#enablemditabbedgroups)來啟用或停用 MDI 索引標籤式群組功能。

## <a name="cmdiframewndexcancovertcontrolbartomdichild"></a><a name="cancovertcontrolbartomdichild"></a>CMDIFrameWndEx：： CanCovertControlBarToMDIChild

由架構呼叫以判斷框架視窗是否可以將停駐窗格轉換成索引標籤式檔

```
virtual BOOL CanCovertControlBarToMDIChild();
```

### <a name="return-value"></a>傳回值

如果框架視窗可以將停駐窗格轉換成索引標籤式檔，則傳回 TRUE;否則會傳回 FALSE。

### <a name="remarks"></a>備註

覆寫衍生類別中的這個方法，並傳回 TRUE，以啟用將停駐窗格轉換成索引標籤式檔的功能。 或者，您可以將[CMDIFrameWndEx：： m_bCanCovertControlBarToMDIChild](#m_bcancovertcontrolbartomdichild)設定為 TRUE。

## <a name="cmdiframewndexcontrolbartotabbeddocument"></a><a name="controlbartotabbeddocument"></a>CMDIFrameWndEx：： ControlBarToTabbedDocument

將指定的停駐窗格轉換成索引標籤式檔。

```
virtual CMDIChildWndEx* ControlBarToTabbedDocument(CDockablePane* pBar);
```

### <a name="parameters"></a>參數

*pBar*<br/>
要轉換之停駐窗格的指標。

### <a name="return-value"></a>傳回值

傳回新的 MDI 子視窗的指標，其中包含停駐窗格。

### <a name="remarks"></a>備註

這個方法會將停駐窗格轉換成索引標籤式檔。 當您呼叫這個方法時，架構會建立[CMDIChildWndEx 類別](../../mfc/reference/cmdichildwndex-class.md)物件、從停駐管理員移除停駐窗格，然後將停駐窗格加入至新的 MDI 子視窗。 MDI 子視窗會調整停駐窗格的大小，以涵蓋整個工作區

## <a name="cmdiframewndexcreatedocumentwindow"></a><a name="createdocumentwindow"></a>CMDIFrameWndEx：： CreateDocumentWindow

建立子文件視窗。

```
virtual CMDIChildWndEx* CreateDocumentWindow(
    LPCTSTR lpcszDocName,
    CObject* pObj);
```

### <a name="parameters"></a>參數

*lpcszDocName*<br/>
在包含檔識別碼的文字字串。 一般而言，它是檔檔的完整路徑。

*pObj*<br/>
在使用者定義物件的指標。 例如，開發人員可以建立描述檔的應用程式特定資料結構，並告訴檔在啟動時應如何初始化。

### <a name="return-value"></a>傳回值

`CMDIChildWndEx` 的指標。

### <a name="remarks"></a>備註

當此架構載入先前儲存在登錄中的檔案清單時，會呼叫這個方法。

覆寫此方法，以便在從登錄載入檔時建立它們。

### <a name="example"></a>範例

下列範例顯示如何 `CreateDocumentWindow` 在 VisualStudioDemo 範例中使用[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

在此範例中， `g_strStartViewName` 可能是不是實際從磁片檔案載入的「虛擬檔案」名稱（例如，[起始頁]）。 因此，我們需要特殊處理來處理這種情況。

[!code-cpp[NVC_MFC_VisualStudioDemo#13](../../mfc/codesnippet/cpp/cmdiframewndex-class_2.cpp)]

## <a name="cmdiframewndexcreatenewwindow"></a><a name="createnewwindow"></a>CMDIFrameWndEx：： CreateNewWindow

由架構呼叫以建立新視窗。

```
virtual CMDIChildWndEx* CreateNewWindow(
    LPCTSTR lpcszDocName,
    CObject* pObj);
```

### <a name="parameters"></a>參數

*lpcszDocName*<br/>
在檔案名稱。

*pObj*<br/>
在保留供日後使用。

### <a name="return-value"></a>傳回值

新視窗的指標。

## <a name="cmdiframewndexdockpane"></a><a name="dockpane"></a>CMDIFrameWndEx：:D ockPane

將指定的窗格停駐到框架視窗。

```cpp
void DockPane(
    CBasePane* pBar,
    UINT nDockBarID=0,
    LPCRECT lpRect=NULL);
```

### <a name="parameters"></a>參數

*pBar*<br/>
在要停駐之窗格的指標。

*nDockBarID*<br/>
在指定要停駐在框架視窗的哪一邊。

*lpRect*<br/>
在未使用。

### <a name="remarks"></a>備註

這個方法會將指定的窗格停駐在呼叫[CBasePane：： EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)和[CMDIFrameWndEx：： EnableDocking](#enabledocking)時所指定的框架視窗的其中一個側邊。

### <a name="example"></a>範例

下列範例示範 `DockPane` 方法的用法。 此程式碼片段來自[VisualStudioDemo 範例： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#4](../../mfc/codesnippet/cpp/cmdiframewndex-class_3.cpp)]

## <a name="cmdiframewndexdockpaneleftof"></a><a name="dockpaneleftof"></a>CMDIFrameWndEx：:D ockPaneLeftOf

將窗格停駐在另一個窗格的左邊。

```
BOOL DockPaneLeftOf(
    CPane* pBar,
    CPane* pLeftOf);
```

### <a name="parameters"></a>參數

*pBar*<br/>
在停駐窗格的指標。

*pLeftOf*<br/>
在做為停駐網站之窗格的指標。 .

### <a name="return-value"></a>傳回值

如果作業成功，則傳回 TRUE。 否則傳回 FALSE。

### <a name="remarks"></a>備註

呼叫這個方法，以預先定義的順序停駐數個窗格物件。 這個方法會將*pBar*所指定的窗格，停駐在*pLeftOf*所指定之窗格的左邊。

### <a name="example"></a>範例

下列範例顯示如何 `DockPaneLeftOf` 在 VisualStudioDemo 範例中使用方法[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#5](../../mfc/codesnippet/cpp/cmdiframewndex-class_4.cpp)]

## <a name="cmdiframewndexenableautohidepanes"></a><a name="enableautohidepanes"></a>CMDIFrameWndEx：： EnableAutoHidePanes

當窗格停駐于主框架視窗的指定側邊時，會啟用 [自動隱藏] 模式。

```
BOOL EnableAutoHidePanes(DWORD dwDockStyle);
```

### <a name="parameters"></a>參數

*dwDockStyle*<br/>
在指定將啟用的主框架視窗的側邊。 使用下列一或多個旗標。

- CBRS_ALIGN_LEFT

- CBRS_ALIGN_RIGHT

- CBRS_ALIGN_TOP

- CBRS_ALIGN_BOTTOM

### <a name="return-value"></a>傳回值

呼叫此函式，可在窗格停駐于主框架視窗的指定側邊時，為其啟用自動隱藏模式。

### <a name="example"></a>範例

下列範例顯示如何 `EnableAutoHidePanes` 在 VisualStudioDemo 範例中使用方法[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#6](../../mfc/codesnippet/cpp/cmdiframewndex-class_5.cpp)]

### <a name="remarks"></a>備註

## <a name="cmdiframewndexenabledocking"></a><a name="enabledocking"></a>CMDIFrameWndEx：： EnableDocking

啟用停駐屬於 MDI 框架視窗的窗格。

```
BOOL EnableDocking(DWORD dwDockStyle);
```

### <a name="parameters"></a>參數

*dwDockStyle*<br/>
在指定您想要套用的銜接樣式。

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

呼叫此函式可啟用屬於物件之窗格的停駐 `CMDIFrameWndEx` 。

### <a name="example"></a>範例

下列範例顯示如何 `EnableDocking` 在 VisualStudioDemo 範例中使用方法[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#7](../../mfc/codesnippet/cpp/cmdiframewndex-class_6.cpp)]

## <a name="cmdiframewndexenablefullscreenmainmenu"></a><a name="enablefullscreenmainmenu"></a>CMDIFrameWndEx：： EnableFullScreenMainMenu

以全螢幕模式顯示或隱藏主功能表。

```cpp
void EnableFullScreenMainMenu(BOOL bEnableMenu);
```

### <a name="parameters"></a>參數

*bEnableMenu*<br/>
在TRUE 表示以全螢幕模式顯示主功能表，或為 FALSE 以隱藏它。

### <a name="remarks"></a>備註

## <a name="cmdiframewndexenablefullscreenmode"></a><a name="enablefullscreenmode"></a>CMDIFrameWndEx：： EnableFullScreenMode

啟用框架視窗的全螢幕模式。

```cpp
void EnableFullScreenMode(UINT uiFullScreenCmd);
```

### <a name="parameters"></a>參數

*uiFullScreenCmd*<br/>
在啟用或停用全螢幕模式的命令識別碼。

### <a name="remarks"></a>備註

在全螢幕模式中，會隱藏所有停駐控制列、工具列和功能表，而使用中的視圖會調整大小以佔用全螢幕。當您啟用全螢幕模式時，您必須指定啟用或停用命令的識別碼。 您可以 `EnableFullScreenMode` 從主框架的函式呼叫 `OnCreate` 。 當框架視窗切換至全螢幕模式時，架構會建立一個具有指定命令識別碼的浮動工具列，其中包含一個按鈕。如果您想要在螢幕上保留主功能表，請呼叫[CMDIFrameWndEx：： EnableFullScreenMainMenu](#enablefullscreenmainmenu)。

## <a name="cmdiframewndexenableloaddockstate"></a><a name="enableloaddockstate"></a>CMDIFrameWndEx：： EnableLoadDockState

啟用或停用銜接狀態的載入。

```cpp
void EnableLoadDockState(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在TRUE 表示啟用停駐狀態的載入，FALSE 則會停用銜接狀態的載入。

### <a name="remarks"></a>備註

## <a name="cmdiframewndexenablemditabbedgroups"></a><a name="enablemditabbedgroups"></a>CMDIFrameWndEx：： EnableMDITabbedGroups

啟用或停用框架視窗的 MDI 索引標籤式群組功能。

```cpp
void EnableMDITabbedGroups(
    BOOL bEnable,
    const CMDITabInfo& params);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在若為 TRUE，則會啟用 MDI 索引標籤式群組功能;如果為 FALSE，則會停用 MDI 索引標籤式群組功能。

*params*<br/>
在指定架構套用至在 MDI 工作區中建立之子視窗的參數。

### <a name="remarks"></a>備註

使用此方法來啟用或停用 MDI 索引標籤式群組功能。 這項功能可讓 MDI 應用程式將子視窗顯示為索引標籤式視窗，在 MDI 工作區中垂直或水準對齊。 索引視窗會以分隔器分隔。 使用者可以使用分隔器來調整索引標籤式群組的大小。

- 使用者可以：

- 將個別的索引標籤拖曳到群組之間。

- 將個別索引標籤拖曳至視窗邊緣，以建立新的群組。

- 使用快捷方式功能表移動索引標籤或建立新群組。

- 您的應用程式可以儲存索引標籤式視窗的目前版面配置，以及目前開啟的檔案清單。

如果您呼叫這個方法，並將*bEnable*設為 FALSE，則會忽略*params* 。

即使已經啟用 MDI 索引標籤式群組，您仍然可以再次呼叫這個方法來修改子視窗的設定。 呼叫方法，並將*bEnable*設為 TRUE，並修改 `CMDITabInfo` *params*參數所指定之物件的成員。

如需如何使用 MDI 索引標籤式群組的詳細資訊，請參閱 Mdi 索引標籤[式群組](../../mfc/mdi-tabbed-groups.md)。

### <a name="example"></a>範例

下列範例顯示如何 `EnableMDITabbedGroups` 在 VisualStudioDemo 範例中使用[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#8](../../mfc/codesnippet/cpp/cmdiframewndex-class_7.cpp)]

## <a name="cmdiframewndexenablemditabs"></a><a name="enablemditabs"></a>CMDIFrameWndEx：： EnableMDITabs

啟用或停用 MDI 框架視窗的 [MDI 索引標籤] 功能。 啟用時，框架視窗會顯示每個 MDI 子視窗的索引標籤。

```cpp
void EnableMDITabs(
    BOOL bEnable=TRUE,
    BOOL bIcons=TRUE,
    CMFCTabCtrl::Location tabLocation=CMFCTabCtrl::LOCATION_BOTTOM,
    BOOL bTabCloseButton=FALSE,
    CMFCTabCtrl::Style style=CMFCTabCtrl::STYLE_3D_SCROLLED,
    BOOL bTabCustomTooltips=FALSE,
    BOOL bActiveTabCloseButton=FALSE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
指定是否啟用索引標籤。

*bIcons*<br/>
指定是否應該在索引標籤上顯示圖示。

*tabLocation*<br/>
指定 tab 標籤的位置。

*bTabCloseButton*<br/>
指定是否要顯示定位鍵關閉按鈕。

*style*<br/>
指定索引標籤的樣式。 針對一般索引標籤或適用于 Microsoft OneNote 索引標籤的 STYLE_3D_ONENOTE 使用 [STYLE_3D_SCROLLED]。

*bTabCustomTooltips*<br/>
指定是否啟用自訂工具提示。

*bActiveTabCloseButton*<br/>
若為 TRUE，[**關閉**] 按鈕將會顯示在 [使用中] 索引標籤上，而不是在索引標籤區域的右上角。

### <a name="remarks"></a>備註

呼叫這個方法來啟用或停用 MDI 框架視窗的 MDI 索引標籤功能。 啟用時，所有的子視窗會顯示為索引標籤。

視參數*tabLocation*的設定而定，定位標籤可以位在畫面的頂端或底部。 您可以指定 `CMFCTabCtrl::LOCATION_BOTTOM` （預設設定）或 `CMFCTabCtrl::LOCATION_TOP` 。

如果*bTabCustomTooltips*為 TRUE，則會將 AFX_WM_ON_GET_TAB_TOOLTIP 訊息傳送到主框架視窗。 您的程式碼可以處理此訊息，並為 MDI 索引標籤提供具有自訂工具提示的架構。

### <a name="example"></a>範例

下列範例顯示如何 `EnableMDITabs` 在 MDITabsDemo 範例中使用[： MFC 索引標籤式 MDI 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_MDITabsDemo#3](../../mfc/reference/codesnippet/cpp/cmdiframewndex-class_8.cpp)]

## <a name="cmdiframewndexenablemditabslastactiveactivation"></a><a name="enablemditabslastactiveactivation"></a>CMDIFrameWndEx：： EnableMDITabsLastActiveActivation

指定當使用者關閉目前的索引標籤時，是否應開啟最後一個使用中的索引標籤。

```cpp
void EnableMDITabsLastActiveActivation(BOOL bLastActiveTab=TRUE);
```

### <a name="parameters"></a>參數

*bLastActiveTab*<br/>
在若為 TRUE，則啟用最後一個使用中的索引標籤。如果為 FALSE，則停用最後一個使用中索引標籤的啟用。

### <a name="remarks"></a>備註

有兩種方式可以在 [作用中] 索引標籤關閉時開啟索引標籤：

- 啟動下一個索引標籤。

- 啟用先前使用中的索引標籤。

預設的執行是使用第一種方式。

使用 `EnableMDITabsLastActiveActivation` 來啟用第二種啟動 tab 鍵的方式。 它會模擬 Windows 開啟 MDI 子視窗的方式。

## <a name="cmdiframewndexenablepanemenu"></a><a name="enablepanemenu"></a>CMDIFrameWndEx：： EnablePaneMenu

啟用或停用快顯窗格功能表的自動建立和管理，這會顯示應用程式窗格清單。

```cpp
void EnablePaneMenu(
    BOOL bEnable,
    UINT uiCustomizeCmd,
    const CString& strCustomizeLabel,
    UINT uiViewToolbarsMenuEntryID,
    BOOL bContextMenuShowsToolbarsOnly=FALSE,
    BOOL bViewMenuShowsToolbarsOnly=FALSE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在若為 TRUE，則會啟用窗格功能表的自動處理;如果為 FALSE，則會停用自動處理。

*uiCustomizeCmd*<br/>
在[**自訂**] 功能表項目的命令識別碼。 這個功能表項目通常會加入窗格清單的結尾。

*strCustomizeLabel*<br/>
在要針對 [**自訂**] 功能表項目顯示的文字（適用于當地語系化）。

*uiViewToolbarsMenuEntryID*<br/>
在指定開啟窗格功能表的工具列功能表項目識別碼。 這通常是 [ **View** ] 功能表的 [**工具列**] 子功能表。

*bCoNtextMenuShowsToolbarsOnly*<br/>
在若為 TRUE，窗格功能表只會顯示工具列清單。 如果為 FALSE，則功能表會顯示工具列和停駐列的清單。

*bViewMenuShowsToolbarsOnly*<br/>
在若為 TRUE，窗格功能表只會顯示工具列清單。 如果為 FALSE，則功能表會顯示工具列和停駐列的清單。

### <a name="remarks"></a>備註

快顯功能表窗格會顯示應用程式窗格的清單，並讓使用者顯示或隱藏個別窗格。

### <a name="example"></a>範例

下列範例顯示如何 `EnablePaneMenu` 在 VisualStudioDemo 範例中使用[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#9](../../mfc/codesnippet/cpp/cmdiframewndex-class_9.cpp)]

## <a name="cmdiframewndexenablewindowsdialog"></a><a name="enablewindowsdialog"></a>CMDIFrameWndEx：： EnableWindowsDialog

插入其命令 ID 呼叫[CMFCWindowsManagerDialog](../../mfc/reference/cmfcwindowsmanagerdialog-class.md)對話方塊的功能表項目。

```cpp
void EnableWindowsDialog(
    UINT uiMenuId,
    LPCTSTR lpszMenuText,
    BOOL bShowAllways=FALSE,
    BOOL bShowHelpButton=FALSE);

void EnableWindowsDialog(
    UINT uiMenuId,
    UINT uiMenuTextResId,
    BOOL bShowAllways=FALSE,
    BOOL bShowHelpButton=FALSE);
```

### <a name="parameters"></a>參數

*uiMenuId*<br/>
在指定功能表的資源識別碼。

*lpszMenuText*<br/>
在指定專案的文字。

*bShowHelpButton*<br/>
在指定是否要在 [windows 管理] 對話方塊中顯示 [說明 **] 按鈕。**

*uiMenuTextResId*<br/>
在包含專案文字字串的字串資源識別碼。

### <a name="remarks"></a>備註

使用此方法插入功能表項目，其命令會呼叫 MDI 子視窗管理對話方塊（ [CMFCWindowsManagerDialog 類別](../../mfc/reference/cmfcwindowsmanagerdialog-class.md)）。 新的專案會插入到*uiMenuId*所指定的功能表中。 `EnableWindowsDialog`當您處理 WM_CREATE 訊息時呼叫。

### <a name="example"></a>範例

下列範例顯示如何 `EnableWindowsDialog` 在 VisualStudioDemo 範例中使用[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#10](../../mfc/codesnippet/cpp/cmdiframewndex-class_10.cpp)]

## <a name="cmdiframewndexgetactivepopup"></a><a name="getactivepopup"></a>CMDIFrameWndEx：： GetActivePopup

將指標傳回到目前顯示的快顯功能表。

```
CMFCPopupMenu* GetActivePopup() const;
```

### <a name="return-value"></a>傳回值

現用快顯功能表的指標;如果沒有作用中的快顯功能表，則為 Null。

### <a name="remarks"></a>備註

使用此函式可取得目前顯示之[CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)物件的指標。

## <a name="cmdiframewndexgetdefaultresid"></a><a name="getdefaultresid"></a>CMDIFrameWndEx：： GetDefaultResId

傳回 MDI 框架視窗之共用資源的識別碼。

```
UINT GetDefaultResId() const;
```

### <a name="return-value"></a>傳回值

資源識別碼值。 如果框架視窗沒有功能表列，則為0。

### <a name="remarks"></a>備註

這個方法會傳回[CFrameWnd：： LoadFrame](../../mfc/reference/cframewnd-class.md#loadframe)載入 MDI 框架視窗時所指定的資源識別碼。

## <a name="cmdiframewndexgetmditabgroups"></a><a name="getmditabgroups"></a>CMDIFrameWndEx：： GetMDITabGroups

傳回 MDI 索引標籤式視窗的清單。

```
const CObList& GetMDITabGroups() const;
```

### <a name="return-value"></a>傳回值

[CObList 類別](../../mfc/reference/coblist-class.md)物件的參考，其中包含索引標籤式視窗的清單。 不要儲存或修改清單。

### <a name="remarks"></a>備註

使用此方法可存取索引標籤式視窗的清單。 如果您想要變更或查詢個別索引標籤式視窗的某些參數，這會很有説明。

## <a name="cmdiframewndexgetmditabs"></a><a name="getmditabs"></a>CMDIFrameWndEx：： GetMDITabs

傳回加底線索引標籤式視窗的參考。

```
CMFCTabCtrl& GetMDITabs();
```

### <a name="return-value"></a>傳回值

底線索引標籤式視窗的參考。

## <a name="cmdiframewndexgetmditabscontextmenualloweditems"></a><a name="getmditabscontextmenualloweditems"></a>CMDIFrameWndEx：： GetMDITabsCoNtextMenuAllowedItems

傳回旗標的組合，決定啟用 MDI 索引標籤式群組功能時，哪些作業有效。

```
DWORD GetMDITabsContextMenuAllowedItems();
```

### <a name="return-value"></a>傳回值

下列旗標的位 OR 組合：

- AFX_MDI_CREATE_VERT_GROUP-可以建立垂直索引標籤群組。

- AFX_MDI_CREATE_HORZ_GROUP-可以建立水準索引標籤群組。

- AFX_MDI_CAN_MOVE_PREV-可以將索引標籤移至上一個索引標籤群組。

- AFX_MDI_CAN_MOVE_NEXT-可以將索引標籤移到下一個索引標籤群組。

### <a name="remarks"></a>備註

啟用 [MDI 索引標籤式群組] 功能時，您必須知道特定視窗的索引標籤上允許哪些作業。 這個方法會分析索引標籤式視窗的目前版面配置，並傳回可用於建立的旗標組合，例如快捷方式功能表。

當所有索引標籤式視窗垂直對齊時，或當只有一個索引標籤式視窗時，您可以建立新的垂直索引標籤群組。

當所有索引標籤式視窗水準對齊，或只有一個索引標籤式視窗時，您可以建立新的水準索引標籤群組。

只有在索引標籤式視窗中有一個以上的索引標籤時，您才可以將索引標籤移至前一個群組。

只有在索引標籤式視窗中有一個以上的索引標籤時，您才可以將索引標籤移到下一個群組。

## <a name="cmdiframewndexgetmenubar"></a><a name="getmenubar"></a>CMDIFrameWndEx：： GetMenuBar

傳回附加至框架視窗的功能表列物件指標。

```
const CMFCMenuBar* GetMenuBar() const;
```

### <a name="return-value"></a>傳回值

功能表列物件的指標。

## <a name="cmdiframewndexgetpane"></a><a name="getpane"></a>CMDIFrameWndEx：： GetPane

傳回具有指定控制項 ID 之窗格的指標。

```
CBasePane* GetPane(UINT nID);
```

### <a name="parameters"></a>參數

*nID*<br/>
在控制項識別碼。

### <a name="return-value"></a>傳回值

具有指定控制項識別碼之窗格的指標（如果有的話）。 否則為 NULL。

## <a name="cmdiframewndexgetribbonbar"></a><a name="getribbonbar"></a>CMDIFrameWndEx：： GetRibbonBar

抓取框架的功能區列控制項。

```
CMFCRibbonBar* GetRibbonBar();
```

### <a name="return-value"></a>傳回值

框架之[CMFCRibbonBar 類別](../../mfc/reference/cmfcribbonbar-class.md)的指標。

### <a name="remarks"></a>備註

## <a name="cmdiframewndexgettearoffbars"></a><a name="gettearoffbars"></a>CMDIFrameWndEx：： GetTearOffBars

傳回卸載功能表的清單。

```
const CObList& GetTearOffBars() const;
```

### <a name="return-value"></a>傳回值

[CObList 類別](../../mfc/reference/coblist-class.md)物件的參考，其中包含處於卸載狀態之衍生物件的指標集合 `CPane` 。

### <a name="remarks"></a>備註

`CMDIFrameWndEx`維護卸載功能表的集合。 使用此方法來抓取此清單的參考。

## <a name="cmdiframewndexgettoolbarbuttontooltiptext"></a><a name="gettoolbarbuttontooltiptext"></a>CMDIFrameWndEx：： GetToolbarButtonToolTipText

當應用程式顯示工具列按鈕的工具提示時，由架構呼叫。

```
virtual BOOL GetToolbarButtonToolTipText(
    CMFCToolBarButton* pButton,
    CString& strTTText);
```

### <a name="parameters"></a>參數

*pButton*<br/>
在工具列按鈕的指標。

*strTTText*<br/>
在要針對按鈕顯示的工具提示文字。

### <a name="return-value"></a>傳回值

如果已顯示工具提示，則為 TRUE。 否則為 FALSE。

### <a name="remarks"></a>備註

## <a name="cmdiframewndexinsertpane"></a><a name="insertpane"></a>CMDIFrameWndEx：： InsertPane

向銜接管理員註冊指定的窗格。

```
BOOL InsertPane(
    CBasePane* pControlBar,
    CBasePane* pTarget,
    BOOL bAfter=TRUE);
```

### <a name="parameters"></a>參數

*pControlBar*<br/>
在要插入之窗格的指標。

*pTarget*<br/>
在要在其中插入窗格的窗格指標。

*bAfter*<br/>
在如果為 TRUE，則*pControlBar*會在*pTarget*之後插入。 如果為 FALSE，則會在*pTarget*之前插入*pControlBar* 。

### <a name="return-value"></a>傳回值

如果方法成功註冊窗格，則為 TRUE，如果窗格已經向銜接管理員註冊，則為 FALSE。

### <a name="remarks"></a>備註

使用此方法來告知停駐管理員有關*pControlBar*所指定的窗格。 停駐管理員會根據窗格在停駐管理員的內部清單中的對齊和位置來對齊此窗格。

## <a name="cmdiframewndexisfullscreen"></a><a name="isfullscreen"></a>CMDIFrameWndEx：： IsFullScreen

判斷框架視窗是否處於全螢幕模式。

```
BOOL IsFullScreen() const;
```

### <a name="return-value"></a>傳回值

如果框架視窗處於全螢幕模式，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

您可以藉由呼叫[CMDIFrameWndEx：： EnableFullScreenMode](#enablefullscreenmode)方法來設定全螢幕模式。

## <a name="cmdiframewndexismditabbedgroup"></a><a name="ismditabbedgroup"></a>CMDIFrameWndEx：： IsMDITabbedGroup

指定是否啟用 MDI 索引標籤式群組功能。

```
BOOL IsMDITabbedGroup() const;
```

### <a name="return-value"></a>傳回值

如果已啟用 MDI 索引標籤式群組功能，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

若要判斷是否已啟用一般 MDI 索引標籤或 [MDI 索引標籤式群組] 功能，請使用[CMDIFrameWndEx：： AreMDITabs](#aremditabs)。

## <a name="cmdiframewndexismemberofmditabgroup"></a><a name="ismemberofmditabgroup"></a>CMDIFrameWndEx：： IsMemberOfMDITabGroup

判斷指定的索引標籤式視窗是否在 MDI 索引標籤式群組的視窗清單中。

```
BOOL IsMemberOfMDITabGroup(CWnd* pWnd);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
在索引標籤式視窗的指標。

### <a name="return-value"></a>傳回值

如果指定的索引標籤式視窗位於組成 MDI 索引標籤式群組的索引標籤式視窗清單中，則為 TRUE 否則為 FALSE。

## <a name="cmdiframewndexismenubaravailable"></a><a name="ismenubaravailable"></a>CMDIFrameWndEx：： IsMenuBarAvailable

決定框架視窗是否有功能表列。

```
BOOL IsMenuBarAvailable() const;
```

### <a name="return-value"></a>傳回值

如果功能表列物件的指標不是 Null，則為 TRUE;否則為 FALSE。

## <a name="cmdiframewndexispointneardocksite"></a><a name="ispointneardocksite"></a>CMDIFrameWndEx：： IsPointNearDockSite

判斷指定的點是否接近 dock 網站。

```
BOOL IsPointNearDockSite(
    CPoint point,
    DWORD& dwBarAlignment,
    BOOL& bOuterEdge) const;
```

### <a name="parameters"></a>參數

*此處*<br/>
在螢幕座標中的指定點。

*dwBarAlignment*<br/>
在指定點接近的邊緣。 可能的值為 CBRS_ALIGN_LEFT、CBRS_ALIGN_RIGHT、CBRS_ALIGN_TOP 和 CBRS_ALIGN_BOTTOM

*bOuterEdge*<br/>
在如果點位於 dock 網站的外部框線附近，則為 TRUE;否則為 FALSE。

### <a name="return-value"></a>傳回值

如果點位於 dock 網站附近，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

當它在停駐管理員中的敏感度設定範圍內時，該點就會接近銜接網站。 預設敏感度為15圖元。

## <a name="cmdiframewndexisprintpreview"></a><a name="isprintpreview"></a>CMDIFrameWndEx：： IsPrintPreview

判斷框架視窗是否處於預覽列印模式。

```
BOOL IsPrintPreview();
```

### <a name="return-value"></a>傳回值

如果框架視窗處於預覽列印模式，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

## <a name="cmdiframewndexloadframe"></a><a name="loadframe"></a>CMDIFrameWndEx：： LoadFrame

從資源資訊建立框架視窗。

```
virtual BOOL LoadFrame(
    UINT nIDResource,
    DWORD dwDefaultStyle = WS_OVERLAPPEDWINDOW | FWS_ADDTOTITLE,
    CWnd* pParentWnd = NULL,
    CCreateContext* pContext = NULL);
```

### <a name="parameters"></a>參數

*nIDResource*<br/>
在與框架視窗相關聯之共用資源的識別碼。

*dwDefaultStyle*<br/>
在框架視窗的樣式。

*pParentWnd*<br/>
在框架父系的指標。

*pContext*<br/>
在[CCreateCoNtext 結構](../../mfc/reference/ccreatecontext-structure.md)的指標。 這個參數可以是 Null。

### <a name="return-value"></a>傳回值

如果方法成功，則為 TRUE，否則為 FALSE。

## <a name="cmdiframewndexloadmdistate"></a><a name="loadmdistate"></a>CMDIFrameWndEx：： LoadMDIState

載入 MDI 索引標籤式群組的指定版面配置，以及先前開啟之檔的清單。

```
virtual BOOL LoadMDIState(LPCTSTR lpszProfileName);
```

### <a name="parameters"></a>參數

*lpszProfileName*<br/>
在指定設定檔名稱。

### <a name="return-value"></a>傳回值

如果載入成功，則為 TRUE;如果載入失敗或沒有要載入的資料，則為 FALSE。

### <a name="remarks"></a>備註

若要載入或儲存 MDI 索引標籤和群組的狀態，以及已開啟檔的清單，請執行下列動作：

- 關閉主要畫面格時，呼叫[CMDIFrameWndEx：： SaveMDIState](#savemdistate)

- 建立主要畫面格時，請呼叫[CMDIFrameWndEx：： LoadMDIState](#loadmdistate) 。 此呼叫的建議位置是第一次顯示主要畫面格之前。 `CWinAppEx::EnableLoadWindowPlacement` `(FALSE);` `pMainFrame->LoadFrame (IDR_MAINFRAME);.` `CWinAppEx::ReloadWindowPlacement` `(pMainFrame);` 在呼叫之後加入，以在 `LoadMDIState` 儲存在登錄中的位置顯示主畫面格。

- `GetDocumentName` `CMDIChildWndEx` 如果您的應用程式顯示不是儲存為檔案的檔，則會覆寫衍生類別中的。 傳回的字串將會儲存在登錄中做為檔識別碼。 [CMDIChildWndEx：： GetDocumentName](../../mfc/reference/cmdichildwndex-class.md#getdocumentname)的基底執行會傳回從[CDocument：： GetPathName](../../mfc/reference/cdocument-class.md#getpathname)取得的值。

- 覆寫[CMDIFrameWndEx：： CreateDocumentWindow](#createdocumentwindow) ，以便在從登錄載入檔時，正確地建立檔。 第一個參數是傳回的字串 `GetDocumentName` 。

### <a name="example"></a>範例

下列範例顯示如何 `LoadMDIState` 在 VisualStudioDemo 範例中使用[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#11](../../mfc/codesnippet/cpp/cmdiframewndex-class_11.cpp)]

## <a name="cmdiframewndexmditabmovetonextgroup"></a><a name="mditabmovetonextgroup"></a>CMDIFrameWndEx：： MDITabMoveToNextGroup

將作用中索引標籤從目前使用中的索引標籤式視窗移到下一個或上一個索引標籤式

```cpp
void MDITabMoveToNextGroup(BOOL bNext=TRUE);
```

### <a name="parameters"></a>參數

*bNext*<br/>
在若為 TRUE，請將索引標籤移至下一個索引標籤式群組。 若為 FALSE，請將它移至先前的索引標籤式群組。

## <a name="cmdiframewndexmditabnewgroup"></a><a name="mditabnewgroup"></a>CMDIFrameWndEx：： MDITabNewGroup

建立具有單一視窗的新索引標籤式群組。

```cpp
void MDITabNewGroup(BOOL bVert=TRUE);
```

### <a name="parameters"></a>參數

*bVert*<br/>
在指定新的群組對齊方式。 若為 TRUE，則會垂直對齊新的群組。 如果為 FALSE，則新群組會水準對齊。

### <a name="remarks"></a>備註

使用此函數來建立新的索引標籤式視窗（新的索引標籤式群組），並在其中新增第一個索引標籤。

### <a name="example"></a>範例

下列範例顯示如何 `MDITabNewGroup` 在 VisualStudioDemo 範例中使用[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#12](../../mfc/codesnippet/cpp/cmdiframewndex-class_12.cpp)]

## <a name="cmdiframewndexm_bcancovertcontrolbartomdichild"></a><a name="m_bcancovertcontrolbartomdichild"></a>CMDIFrameWndEx：： m_bCanCovertControlBarToMDIChild

指定停駐窗格是否可轉換為 MDI 子視窗。

```
BOOL m_bCanCovertControlBarToMDIChild;
```

### <a name="remarks"></a>備註

指出停駐控制列是否可轉換為 MDI 子視窗。 如果此旗標為 TRUE，則當使用者選取索引標籤**式檔**命令時，架構會自動處理轉換。 旗標會受到保護，而且您必須明確地啟用此選項 `m_bCanCovertControlBarToMDIChild` ，方法是在衍生類別的函式中設定 `CMDIFrameWndEx` ，或覆寫 `CanConvertControlBarToMDIChild` 。

預設值為 `FALSE`。

### <a name="example"></a>範例

下列範例顯示如何 `m_bCanCovertControlBarToMDIChild` 在 VisualStudioDemo 範例中使用[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#13](../../mfc/codesnippet/cpp/cmdiframewndex-class_2.cpp)]

## <a name="cmdiframewndexm_bdisablesetredraw"></a><a name="m_bdisablesetredraw"></a>CMDIFrameWndEx：： m_bDisableSetRedraw

啟用或停用 MDI 子視窗的重繪優化。

```
AFX_IMPORT_DATA static BOOL m_bDisableSetRedraw;
```

### <a name="remarks"></a>備註

預設值為 TRUE。

如果您想要優化 MDI 子系的重繪，請將此旗標設定為 FALSE。 在此情況下，架構會在 `SetRedraw (FALSE)` 應用程式變更作用中索引標籤時，針對主框架呼叫。

此旗標可能會造成不想要的效果（例如背景應用程式會變成可見）。 因此，建議您只有在 MDI 索引標籤啟用期間遇到明顯閃爍時，才變更預設值。

## <a name="cmdiframewndexnegotiateborderspace"></a><a name="negotiateborderspace"></a>CMDIFrameWndEx：： NegotiateBorderSpace

在 OLE 就地啟用期間，協調框架視窗中的框線空間。

```
virtual BOOL NegotiateBorderSpace(
    UINT nBorderCmd,
    LPRECT lpRectBorder);
```

### <a name="parameters"></a>參數

*nBorderCmd*<br/>
在包含列舉中的下列其中一個值 `CFrameWnd::BorderCmd` ：

- `borderGet` = 1

- `borderRequest` = 2

- `borderSet` = 3

*lpRectBorder*<br/>
[in、out][矩形結構](/windows/win32/api/windef/ns-windef-rect)的指標，或指定框線座標的[CRect 類別](../../atl-mfc-shared/reference/crect-class.md)物件。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零;否則為0。

### <a name="remarks"></a>備註

這個方法是 OLE border space 談判的執行。

## <a name="cmdiframewndexonclosedockingpane"></a><a name="onclosedockingpane"></a>CMDIFrameWndEx：： OnCloseDockingPane

當使用者按一下可停駐窗格上的 [**關閉**] 按鈕時由架構呼叫。

```
virtual BOOL OnCloseDockingPane(CDockablePane* pWnd);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
在要關閉之窗格的指標。

### <a name="return-value"></a>傳回值

如果停駐窗格可以關閉，則為 TRUE。 否則，FALSE。

### <a name="remarks"></a>備註

覆寫這個方法，以處理隱藏停駐窗格。 如果您想要防止隱藏停駐窗格，則傳回 FALSE。

預設的執行不會執行任何操作，而且會傳回 TRUE。

## <a name="cmdiframewndexoncloseminiframe"></a><a name="oncloseminiframe"></a>CMDIFrameWndEx：： OnCloseMiniFrame

當使用者按一下浮動迷你框架視窗上的 [**關閉**] 按鈕時，由架構呼叫。

```
virtual BOOL OnCloseMiniFrame(CPaneFrameWnd*);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
在要關閉之迷你框架視窗的指標。

### <a name="return-value"></a>傳回值

如果可以關閉浮動的迷你框架視窗，則為 TRUE。 否則，FALSE。

### <a name="remarks"></a>備註

覆寫這個方法，以處理隱藏浮動的迷你框架視窗。 如果您想要防止隱藏浮動的迷你框架視窗，則傳回 FALSE。

預設的執行不會執行任何操作，而且會傳回 TRUE。

## <a name="cmdiframewndexonclosepopupmenu"></a><a name="onclosepopupmenu"></a>CMDIFrameWndEx：： OnClosePopupMenu

架構在作用中的快顯功能表處理 WM_DESTROY 訊息時所呼叫。

```
virtual void OnClosePopupMenu(CMFCPopupMenu* pMenuPopup);
```

### <a name="parameters"></a>參數

*pMenuPopup*<br/>
在快顯功能表的指標。

### <a name="remarks"></a>備註

如果您想要在這些物件處理 WM_DESTROY 訊息時，從屬於 MDI 框架視窗的[CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)物件中處理通知，請覆寫這個方法。

## <a name="cmdiframewndexoncmdmsg"></a><a name="oncmdmsg"></a>CMDIFrameWndEx：： OnCmdMsg

由架構呼叫以路由傳送和分派命令訊息，以及更新命令使用者介面物件。

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>參數

*nID*<br/>
在命令識別碼。

*nCode*<br/>
在識別命令通知碼。 如需*nCode*值的詳細資訊，請參閱[CCmdTarget：： OnCmdMsg](../../mfc/reference/ccmdtarget-class.md#oncmdmsg) 。

*pExtra*<br/>
在根據*nCode*的值使用。 如需有關*pExtra*的詳細資訊，請參閱[CCmdTarget：： OnCmdMsg](../../mfc/reference/ccmdtarget-class.md#oncmdmsg) 。

*pHandlerInfo*<br/>
[in、out]通常，這個參數應該是 Null。如果不是 Null，則會 `OnCmdMsg` 填入 `pTarget` `pmf` *pHandlerInfo*結構的和成員，而不是分派命令。

### <a name="return-value"></a>傳回值

如果已處理訊息，則為非零值。否則為0。

## <a name="cmdiframewndexondrawmenuimage"></a><a name="ondrawmenuimage"></a>CMDIFrameWndEx：： OnDrawMenuImage

架構在繪製與功能表項目相關聯的映像時所呼叫。

```
virtual BOOL OnDrawMenuImage(
    CDC* pDC,
    const CMFCToolBarMenuButton* pMenuButton,
    const CRect& rectImage);
```

### <a name="parameters"></a>參數

*pDC*<br/>
在裝置內容的指標。

*pMenuButton*<br/>
在功能表按鈕的指標。

*rectImage*<br/>
在影像的周框。

### <a name="return-value"></a>傳回值

如果方法繪製影像，則為 TRUE。 預設的實值會傳回 FALSE。

### <a name="remarks"></a>備註

如果您想要針對屬於衍生物件所擁有之功能表列的功能表項目自訂影像呈現，請覆寫這個方法 `CMDIFrameWndEx` 。 預設實作不做任何動作。

## <a name="cmdiframewndexondrawmenulogo"></a><a name="ondrawmenulogo"></a>CMDIFrameWndEx：： OnDrawMenuLogo

當[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)處理 WM_PAINT 訊息時，由架構呼叫。

```
virtual void OnDrawMenuLogo(
    CDC*,
    CMFCPopupMenu*,
    const CRect&);
```

### <a name="remarks"></a>備註

覆寫此函式，以顯示快顯功能表上的標誌，而此功能表列屬於衍生物件所擁有的功能表列 `CMDIFrameWndEx` 。 預設實作不做任何動作。

## <a name="cmdiframewndexonerasemdiclientbackground"></a><a name="onerasemdiclientbackground"></a>CMDIFrameWndEx：： OnEraseMDIClientBackground

當 MDI 框架視窗處理 WM_ERASEBKGND 訊息時，由架構呼叫。

```
virtual BOOL OnEraseMDIClientBackground(CDC*);
```

### <a name="return-value"></a>傳回值

如果應用程式處理訊息並清除背景，則為 TRUE。

### <a name="remarks"></a>備註

如果您想要處理衍生類別中的 WM_ERASEBKGND 訊息，請覆寫這個成員函 `CMDIFrameWndEx` 式。

## <a name="cmdiframewndexonmenubuttontoolhittest"></a><a name="onmenubuttontoolhittest"></a>CMDIFrameWndEx：： OnMenuButtonToolHitTest

當[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)物件處理 WM_NCHITTEST 訊息時，由架構呼叫。

```
virtual BOOL OnMenuButtonToolHitTest(
    CMFCToolBarButton* pButton,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>參數

*pButton*<br/>
在工具列按鈕。

*pTI*<br/>
脫銷[TOOLINFO](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa)結構的指標。

### <a name="return-value"></a>傳回值

如果應用程式填滿*pTI*參數，則為 TRUE。 預設的實值會傳回 FALSE。

### <a name="remarks"></a>備註

如果您想要將特定功能表項目的相關資訊提供給工具提示，請覆寫這個方法。 預設實作不做任何動作。

## <a name="cmdiframewndexonmoveminiframe"></a><a name="onmoveminiframe"></a>CMDIFrameWndEx：： OnMoveMiniFrame

由架構呼叫以移動迷你框架視窗。

```
virtual BOOL OnMoveMiniFrame(CWnd* pFrame);
```

### <a name="parameters"></a>參數

*pFrame*<br/>
在迷你框架視窗的指標。

### <a name="return-value"></a>傳回值

如果方法成功，則為 TRUE，否則為 FALSE。

## <a name="cmdiframewndexonsetpreviewmode"></a><a name="onsetpreviewmode"></a>CMDIFrameWndEx：： OnSetPreviewMode

設定應用程式的主框架視窗預覽列印模式。

```
virtual void OnSetPreviewMode(
    BOOL bPreview,
    CPrintPreviewState* pState);
```

### <a name="parameters"></a>參數

*bPreview*<br/>
在若為 TRUE，則設定預覽列印模式。 如果為 FALSE，則會取消預覽模式。

*pState*<br/>
在結構的指標 `CPrintPreviewState` 。

### <a name="remarks"></a>備註

這個方法會覆寫[CFrameWnd：： OnSetPreviewMode](../../mfc/reference/cframewnd-class.md#onsetpreviewmode)。

## <a name="cmdiframewndexonshowcustomizepane"></a><a name="onshowcustomizepane"></a>CMDIFrameWndEx：： OnShowCustomizePane

當快速自訂窗格啟動時由架構呼叫。

```
virtual BOOL OnShowCustomizePane(
    CMFCPopupMenu* pMenuPane,
    UINT uiToolbarID);
```

### <a name="parameters"></a>參數

*pMenuPane*<br/>
在[快速自訂] 窗格的指標。

*uiToolbarID*<br/>
在要自訂之工具列的控制項 ID。

### <a name="return-value"></a>傳回值

這個方法一律會傳回 TRUE。

### <a name="remarks"></a>備註

[快速自訂] 窗格是在使用者按一下工具列上的 [**自訂**] 時開啟的功能表。

覆寫衍生類別中的這個方法，以在 [快速自訂] 窗格中進行變更。

## <a name="cmdiframewndexonshowmditabcontextmenu"></a><a name="onshowmditabcontextmenu"></a>CMDIFrameWndEx：： OnShowMDITabCoNtextMenu

在快捷方式功能表顯示在其中一個索引標籤上之前，由架構呼叫。 僅適用于 MDI 索引標籤式群組。

```
virtual BOOL OnShowMDITabContextMenu(
    CPoint point,
    DWORD dwAllowedItems,
    BOOL bTabDrop);
```

### <a name="parameters"></a>參數

*此處*<br/>
在功能表在螢幕座標中的位置。

*dwAllowedItems*<br/>
在旗標的位 OR 組合，表示目前索引標籤允許哪些動作：

- AFX_MDI_CREATE_VERT_GROUP-可以建立垂直索引標籤群組。

- AFX_MDI_CREATE_HORZ_GROUP-可以建立水準索引標籤群組。

- AFX_MDI_CAN_MOVE_PREV-可以將索引標籤移至上一個索引標籤群組。

- AFX_MDI_CAN_MOVE_NEXT-可以將索引標籤移到下一個索引標籤群組。

- AFX_MDI_CAN_BE_DOCKED-將索引標籤式檔切換為停駐狀態（僅適用于索引標籤式檔）。

*bTabDrop*<br/>
在TRUE 表示將索引標籤拖曳至另一個索引標籤式群組後，顯示功能表。 [FALSE] 會在目前使用中的索引標籤上顯示功能表做為快捷方式功能表。

### <a name="return-value"></a>傳回值

在[CMDIFrameWndEx](../../mfc/reference/cmdiframewndex-class.md)衍生的類別中覆寫這個方法。

### <a name="remarks"></a>備註

如果您未處理 `OnShowMDITabContextMenu` ，將不會顯示快捷方式功能表。 當您啟用 MDI 索引標籤式群組功能時， **MFC 應用程式精靈**會產生這個函數。

### <a name="example"></a>範例

下列範例顯示如何 `OnShowMDITabContextMenu` 在 VisualStudioDemo 範例中使用[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#14](../../mfc/codesnippet/cpp/cmdiframewndex-class_13.cpp)]

## <a name="cmdiframewndexonshowpanes"></a><a name="onshowpanes"></a>CMDIFrameWndEx：： OnShowPanes

由架構呼叫以顯示或隱藏窗格。

```
virtual BOOL OnShowPanes(BOOL bShow);
```

### <a name="parameters"></a>參數

*bShow*<br/>
在TRUE 表示顯示窗格，FALSE 則隱藏窗格。

### <a name="return-value"></a>傳回值

如果窗格的狀態因呼叫這個方法而變更，則為 TRUE，如果窗格已經在*bShow*所指定的狀態中，則為 FALSE。 例如，如果窗格已隱藏，而*bShow*為 false，則傳回值為 false。

### <a name="remarks"></a>備註

預設的實值會從最上層框架視窗中移除工具列。

如果[CDockingManager：： m_bHideDockingBarsInContainerMode](../../mfc/reference/cdockingmanager-class.md#m_bhidedockingbarsincontainermode)為 TRUE （預設值），則會隱藏所有停駐窗格。

## <a name="cmdiframewndexonshowpopupmenu"></a><a name="onshowpopupmenu"></a>CMDIFrameWndEx：： OnShowPopupMenu

在開啟快顯功能表時由架構呼叫。

```
virtual BOOL OnShowPopupMenu(CMFCPopupMenu*);
```

### <a name="return-value"></a>傳回值

如果要顯示快顯功能表，則為 TRUE。 否則，FALSE。 預設的實值會傳回 TRUE。

### <a name="remarks"></a>備註

如果您想要在快顯功能表啟用時執行特殊處理，請覆寫這個方法。 例如，如果您想要將一般功能表項目變更為 [色彩] 功能表按鈕，請設定 [卸載] 橫條，依此類推。

預設實作不做任何動作。

## <a name="cmdiframewndexonsizemdiclient"></a><a name="onsizemdiclient"></a>CMDIFrameWndEx：： OnSizeMDIClient

當用戶端 MDI 視窗的大小變更時由架構呼叫。

```
virtual void OnSizeMDIClient(
    const CRect& rectOld,
    const CRect& rectNew);
```

### <a name="parameters"></a>參數

*rectOld*<br/>
在MDI 用戶端視窗的目前大小。

*rectNew*<br/>
在MDI 用戶端視窗的新大小。

### <a name="remarks"></a>備註

## <a name="cmdiframewndexontearoffmenu"></a><a name="ontearoffmenu"></a>CMDIFrameWndEx：： OnTearOffMenu

架構在啟動有分割列的功能表時所呼叫。

```
virtual BOOL OnTearOffMenu(
    CMFCPopupMenu* pMenuPopup,
    CPane* pBar);
```

### <a name="parameters"></a>參數

*pMenuPopup*<br/>
在快顯功能表的指標。

*pBar*<br/>
在卸載列的指標。

### <a name="return-value"></a>傳回值

TRUE 表示允許啟用關閉列的快顯功能表，而使其成為啟動;否則為 FALSE。 預設值是 TRUE。

### <a name="remarks"></a>備註

當您想要為清除列執行特殊設定時，請覆寫此函式。 預設實作不做任何動作。

## <a name="cmdiframewndexonupdateframemenu"></a><a name="onupdateframemenu"></a>CMDIFrameWndEx：： OnUpdateFrameMenu

由架構呼叫以更新框架功能表。

```
virtual void OnUpdateFrameMenu(HMENU hMenuAlt);
```

### <a name="parameters"></a>參數

*hMenuAlt*<br/>
在功能表的控制碼。

## <a name="cmdiframewndexpanefrompoint"></a><a name="panefrompoint"></a>CMDIFrameWndEx：:P aneFromPoint

傳回包含指定點的停駐窗格。

```
CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    bool bExactBar,
    CRuntimeClass* pRTCBarType) const;

CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    DWORD& dwAlignment,
    CRuntimeClass* pRTCBarType) const;
```

### <a name="parameters"></a>參數

*此處*<br/>
在點（以螢幕座標表示）。

*nSensitivity*<br/>
在每個已檢查窗格的視窗矩形都會以這個值的所有方向放大。

*bExactBar*<br/>
在若為 TRUE，則會忽略*nSensitivity*參數。

*pRTCBarType*<br/>
在如果不是 Null，方法只會逐一查看指定類型的窗格。

*dwAlignment*<br/>
脫銷如果找到窗格，此參數會指定窗格最接近指定點的哪一邊。

### <a name="return-value"></a>傳回值

停駐窗格的指標，如果沒有控制項包含*point*所指定的點，則為 Null。

### <a name="remarks"></a>備註

呼叫會重新導向至[CDockingManager 類別](../../mfc/reference/cdockingmanager-class.md)。 如需詳細資訊，請參閱[CDockingManager：： ControlBarFromPoint](../../mfc/reference/cdockingmanager-class.md#panefrompoint) 。

## <a name="cmdiframewndexrecalclayout"></a><a name="recalclayout"></a>CMDIFrameWndEx：： RecalcLayout

由架構呼叫以重新計算框架視窗的版面配置。

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>參數

*bNotify*<br/>
在判斷框架視窗的現用就地專案是否會收到配置變更的通知。 若為 TRUE，則會通知專案;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會覆寫[CFrameWnd：： RecalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout)。

## <a name="cmdiframewndexremovepanefromdockmanager"></a><a name="removepanefromdockmanager"></a>CMDIFrameWndEx：： RemovePaneFromDockManager

取消註冊窗格，並將它從停駐管理員移除。

```cpp
void RemovePaneFromDockManager(
    CBasePane* pControlBar,
    BOOL bDestroy,
    BOOL bAdjustLayout,
    BOOL bAutoHide,
    CBasePane* pBarReplacement);
```

### <a name="parameters"></a>參數

*pControlBar*<br/>
在要移除之窗格的指標。

*bDestroy*<br/>
在TRUE 表示損毀已移除的窗格。 FALSE 表示不摧毀。

*bAdjustLayout*<br/>
在TRUE 表示立即調整銜接配置。 若為 FALSE，則只有在因其他原因而發生重繪事件時（使用者調整視窗大小、拖曳主框架等），才會進行調整。

*bAutoHide*<br/>
在TRUE 表示從自動隱藏窗格清單中移除窗格。 FALSE 表示要從一般窗格清單中移除窗格。

*pBarReplacement*<br/>
在取代已移除窗格之窗格的指標。

### <a name="remarks"></a>備註

您必須向銜接管理員註冊每個窗格，使其參與停駐配置。 使用[CMDIFrameWndEx：： AddPane](#addpane)或[CMDIFrameWndEx：： InsertPane](#insertpane)來註冊窗格。

當窗格不再屬於框架視窗的停駐版面配置時，請使用這個方法。

## <a name="cmdiframewndexsavemdistate"></a><a name="savemdistate"></a>CMDIFrameWndEx：： SaveMDIState

儲存 MDI 索引標籤式群組的目前版面配置，以及先前開啟之檔的清單。

```
virtual BOOL SaveMDIState(LPCTSTR lpszProfileName);
```

### <a name="parameters"></a>參數

*lpszProfileName*<br/>
在指定設定檔名稱。

### <a name="return-value"></a>傳回值

如果儲存成功，則為 TRUE;如果儲存失敗，則為 FALSE。

### <a name="remarks"></a>備註

若要載入或儲存 MDI 索引標籤和群組的狀態，以及已開啟檔的清單，請執行下列動作：

- `SaveMDIState`關閉主要畫面格時呼叫

- 建立主要畫面格時，請呼叫[CMDIFrameWndEx：： LoadMDIState](#loadmdistate) 。 此呼叫的建議位置是第一次顯示主要畫面格之前。

- `CWinAppEx::EnableLoadWindowPlacement(FALSE);`在之前呼叫`pMainFrame->LoadFrame (IDR_MAINFRAME);`

- 在 `CWinAppEx::ReloadWindowPlacement(pMainFrame)` 之後呼叫 `LoadMDIState` ，以在儲存于登錄中的位置顯示主要畫面格。

- `GetDocumentName` `CMDIChildWndEx` 如果您的應用程式顯示不是儲存為檔案的檔，則會覆寫衍生類別中的。 傳回的字串將會儲存在登錄中做為檔識別碼。 如需詳細資訊，請參閱[CMDIChildWndEx：： GetDocumentName](../../mfc/reference/cmdichildwndex-class.md#getdocumentname)。

- 覆寫[CMDIFrameWndEx：： CreateDocumentWindow](#createdocumentwindow) ，以便在從登錄載入檔時，正確地加以建立。 的參數 `CreateDocumentWindow` 是先前傳回的字串 `GetDocumentName` 。

### <a name="example"></a>範例

下列範例顯示如何 `SaveMDIState` 在 VisualStudioDemo 範例中使用[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#15](../../mfc/codesnippet/cpp/cmdiframewndex-class_14.cpp)]

## <a name="cmdiframewndexsetprintpreviewframe"></a><a name="setprintpreviewframe"></a>CMDIFrameWndEx：： SetPrintPreviewFrame

設定預覽列印框架視窗。

```cpp
void SetPrintPreviewFrame(CFrameWnd* pWnd);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
在預覽列印框架視窗的指標。

### <a name="remarks"></a>備註

## <a name="cmdiframewndexsetuptoolbarmenu"></a><a name="setuptoolbarmenu"></a>CMDIFrameWndEx：： SetupToolbarMenu

藉由將虛擬專案取代為使用者定義的專案，來修改工具列物件。

```cpp
void SetupToolbarMenu(
    CMenu& menu,
    const UINT uiViewUserToolbarCmdFirst,
    const UINT uiViewUserToolbarCmdLast);
```

### <a name="parameters"></a>參數

*下拉式功能表*<br/>
在要修改之[CMenu 類別](../../mfc/reference/cmenu-class.md)物件的參考。

*uiViewUserToolbarCmdFirst*<br/>
在指定第一個使用者定義的命令。

*uiViewUserToolbarCmdLast*<br/>
在指定最後一個使用者定義的命令。

## <a name="cmdiframewndexshowfullscreen"></a><a name="showfullscreen"></a>CMDIFrameWndEx：： ShowFullScreen

將主框架從一般模式切換至全螢幕模式。

```cpp
void ShowFullScreen();
```

### <a name="remarks"></a>備註

## <a name="cmdiframewndexshowpane"></a><a name="showpane"></a>CMDIFrameWndEx：： ShowPane

顯示或隱藏指定的窗格。

```cpp
void ShowPane(
    CBasePane* pBar,
    BOOL bShow,
    BOOL bDelay,
    BOOL bActivate);
```

### <a name="parameters"></a>參數

*pBar*<br/>
在要顯示或隱藏之窗格的指標。

*bShow*<br/>
在TRUE 表示顯示窗格。 FALSE 表示隱藏窗格。

*bDelay*<br/>
在TRUE 表示延遲重新計算停駐版面配置。 FALSE 會立即重新計算銜接配置。

*bActivate*<br/>
在TRUE 表示窗格應為作用中。 FALSE 會將窗格顯示為非作用中。

### <a name="remarks"></a>備註

呼叫這個方法，以顯示或隱藏窗格。 不要用於停駐 `ShowWindow` 窗格。

### <a name="example"></a>範例

下列範例顯示如何 `ShowPane` 在 VisualStudioDemo 範例中使用[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#16](../../mfc/codesnippet/cpp/cmdiframewndex-class_15.cpp)]

## <a name="cmdiframewndexshowwindowsdialog"></a><a name="showwindowsdialog"></a>CMDIFrameWndEx：： ShowWindowsDialog

建立[CMFCWindowsManagerDialog](../../mfc/reference/cmfcwindowsmanagerdialog-class.md) box 並加以開啟。

```cpp
void ShowWindowsDialog();
```

### <a name="example"></a>範例

下列範例顯示如何 `ShowWindowsDialog` 在 VisualStudioDemo 範例中使用[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#18](../../mfc/codesnippet/cpp/cmdiframewndex-class_16.cpp)]

## <a name="cmdiframewndextabbeddocumenttocontrolbar"></a><a name="tabbeddocumenttocontrolbar"></a>CMDIFrameWndEx：： TabbedDocumentToControlBar

將指定的索引標籤式檔轉換成停駐窗格。

```
virtual BOOL TabbedDocumentToControlBar(CMDIChildWndEx* pMDIChildWnd);
```

### <a name="parameters"></a>參數

*pMDIChildWnd*<br/>
包含停駐窗格之 MDI 子視窗的指標。

### <a name="return-value"></a>傳回值

如果方法成功，則為 TRUE，如果失敗，則為 FALSE。

### <a name="remarks"></a>備註

使用此方法可將索引標籤式檔轉換成停駐窗格。 索引標籤式檔必須使用[CMDIFrameWndEx：： ControlBarToTabbedDocument](#controlbartotabbeddocument)來建立。

### <a name="example"></a>範例

下列範例顯示如何 `TabbedDocumentToControlBar` 在 VisualStudioDemo 範例中使用[： MFC Visual Studio 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#19](../../mfc/codesnippet/cpp/cmdiframewndex-class_17.cpp)]

## <a name="cmdiframewndexupdatecaption"></a><a name="updatecaption"></a>CMDIFrameWndEx：： UpdateCaption

由架構呼叫以更新視窗框架標題。

```cpp
void UpdateCaption();
```

### <a name="remarks"></a>備註

## <a name="cmdiframewndexupdatemditabbedbarsicons"></a><a name="updatemditabbedbarsicons"></a>CMDIFrameWndEx：： UpdateMDITabbedBarsIcons

設定每個 MDI 索引標籤式窗格的圖示。

```cpp
void UpdateMDITabbedBarsIcons();
```

## <a name="cmdiframewndexwinhelp"></a><a name="winhelp"></a>CMDIFrameWndEx：： WinHelp

架構所呼叫以起始 WinHelp 應用程式或內容說明。

```
virtual void WinHelp(
    DWORD dwData,
    UINT nCmd = HELP_CONTEXT);
```

### <a name="parameters"></a>參數

*dwData*<br/>
在指定*nCmd*所指定的說明類型所需的資料。

*nCmd*<br/>
在指定所要求的說明類型。 如需可能值的清單，以及它們對*dwData*參數的影響，請參閱 Windows SDK 中的[WinHelp](/windows/win32/api/winuser/nf-winuser-winhelpw)函式。

### <a name="remarks"></a>備註

這個方法會覆寫 [CWnd::WinHelp](../../mfc/reference/cwnd-class.md#winhelp)。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMDIFrameWnd](../../mfc/reference/cframewnd-class.md)<br/>
[CMDIChildWndEx 類別](../../mfc/reference/cmdichildwndex-class.md)
