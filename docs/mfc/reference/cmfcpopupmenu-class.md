---
title: CMFCPopupMenu 類別
ms.date: 10/18/2018
f1_keywords:
- CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::ActivatePopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::AlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::AreAllCommandsShown
- AFXPOPUPMENU/CMFCPopupMenu::CheckArea
- AFXPOPUPMENU/CMFCPopupMenu::CloseMenu
- AFXPOPUPMENU/CMFCPopupMenu::Create
- AFXPOPUPMENU/CMFCPopupMenu::DefaultMouseClickOnClose
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuLogo
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::EnableResize
- AFXPOPUPMENU/CMFCPopupMenu::EnableScrolling
- AFXPOPUPMENU/CMFCPopupMenu::EnableVertResize
- AFXPOPUPMENU/CMFCPopupMenu::FindSubItemByCommand
- AFXPOPUPMENU/CMFCPopupMenu::GetActiveMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::GetDropDirection
- AFXPOPUPMENU/CMFCPopupMenu::GetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::GetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::GetHMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuBar
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItem
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItemCount
- AFXPOPUPMENU/CMFCPopupMenu::GetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::GetParentArea
- AFXPOPUPMENU/CMFCPopupMenu::GetParentButton
- AFXPOPUPMENU/CMFCPopupMenu::GetParentPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::GetParentToolBar
- AFXPOPUPMENU/CMFCPopupMenu::GetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::GetSelItem
- AFXPOPUPMENU/CMFCPopupMenu::HasBeenResized
- AFXPOPUPMENU/CMFCPopupMenu::HideRarelyUsedCommands
- AFXPOPUPMENU/CMFCPopupMenu::InCommand
- AFXPOPUPMENU/CMFCPopupMenu::InsertItem
- AFXPOPUPMENU/CMFCPopupMenu::InsertSeparator
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysClose
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::IsCustomizePane
- AFXPOPUPMENU/CMFCPopupMenu::IsEscClose
- AFXPOPUPMENU/CMFCPopupMenu::IsIdle
- AFXPOPUPMENU/CMFCPopupMenu::IsMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::IsQuickCustomize
- AFXPOPUPMENU/CMFCPopupMenu::IsResizeble
- AFXPOPUPMENU/CMFCPopupMenu::IsRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::IsScrollable
- AFXPOPUPMENU/CMFCPopupMenu::IsSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::IsShown
- AFXPOPUPMENU/CMFCPopupMenu::MoveTo
- AFXPOPUPMENU/CMFCPopupMenu::OnCmdMsg
- AFXPOPUPMENU/CMFCPopupMenu::PostCommand
- AFXPOPUPMENU/CMFCPopupMenu::PreTranslateMessage
- AFXPOPUPMENU/CMFCPopupMenu::RecalcLayout
- AFXPOPUPMENU/CMFCPopupMenu::RemoveAllItems
- AFXPOPUPMENU/CMFCPopupMenu::RemoveItem
- AFXPOPUPMENU/CMFCPopupMenu::SaveState
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::SetAutoDestroy
- AFXPOPUPMENU/CMFCPopupMenu::SetDefaultItem
- AFXPOPUPMENU/CMFCPopupMenu::SetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::SetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::SetMaxWidth
- AFXPOPUPMENU/CMFCPopupMenu::SetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::SetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickMode
- AFXPOPUPMENU/CMFCPopupMenu::SetRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::SetSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::ShowAllCommands
- AFXPOPUPMENU/CMFCPopupMenu::TriggerResize
- AFXPOPUPMENU/CMFCPopupMenu::UpdateAllShadows
- AFXPOPUPMENU/CMFCPopupMenu::UpdateShadow
- AFXPOPUPMENU/CMFCPopupMenu::CreateTearOffBar
- AFXPOPUPMENU/CMFCPopupMenu::OnChangeHot
- AFXPOPUPMENU/CMFCPopupMenu::OnChooseItem
helpviewer_keywords:
- CMFCPopupMenu [MFC], CMFCPopupMenu
- CMFCPopupMenu [MFC], ActivatePopupMenu
- CMFCPopupMenu [MFC], AlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], AreAllCommandsShown
- CMFCPopupMenu [MFC], CheckArea
- CMFCPopupMenu [MFC], CloseMenu
- CMFCPopupMenu [MFC], Create
- CMFCPopupMenu [MFC], DefaultMouseClickOnClose
- CMFCPopupMenu [MFC], EnableMenuLogo
- CMFCPopupMenu [MFC], EnableMenuSound
- CMFCPopupMenu [MFC], EnableResize
- CMFCPopupMenu [MFC], EnableScrolling
- CMFCPopupMenu [MFC], EnableVertResize
- CMFCPopupMenu [MFC], FindSubItemByCommand
- CMFCPopupMenu [MFC], GetActiveMenu
- CMFCPopupMenu [MFC], GetAnimationSpeed
- CMFCPopupMenu [MFC], GetAnimationType
- CMFCPopupMenu [MFC], GetDropDirection
- CMFCPopupMenu [MFC], GetForceMenuFocus
- CMFCPopupMenu [MFC], GetForceShadow
- CMFCPopupMenu [MFC], GetHMenu
- CMFCPopupMenu [MFC], GetMenuBar
- CMFCPopupMenu [MFC], GetMenuItem
- CMFCPopupMenu [MFC], GetMenuItemCount
- CMFCPopupMenu [MFC], GetMessageWnd
- CMFCPopupMenu [MFC], GetParentArea
- CMFCPopupMenu [MFC], GetParentButton
- CMFCPopupMenu [MFC], GetParentPopupMenu
- CMFCPopupMenu [MFC], GetParentRibbonElement
- CMFCPopupMenu [MFC], GetParentToolBar
- CMFCPopupMenu [MFC], GetQuickCustomizeType
- CMFCPopupMenu [MFC], GetSelItem
- CMFCPopupMenu [MFC], HasBeenResized
- CMFCPopupMenu [MFC], HideRarelyUsedCommands
- CMFCPopupMenu [MFC], InCommand
- CMFCPopupMenu [MFC], InsertItem
- CMFCPopupMenu [MFC], InsertSeparator
- CMFCPopupMenu [MFC], IsAlwaysClose
- CMFCPopupMenu [MFC], IsAlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], IsCustomizePane
- CMFCPopupMenu [MFC], IsEscClose
- CMFCPopupMenu [MFC], IsIdle
- CMFCPopupMenu [MFC], IsMenuSound
- CMFCPopupMenu [MFC], IsQuickCustomize
- CMFCPopupMenu [MFC], IsResizeble
- CMFCPopupMenu [MFC], IsRightAlign
- CMFCPopupMenu [MFC], IsScrollable
- CMFCPopupMenu [MFC], IsSendMenuSelectMsg
- CMFCPopupMenu [MFC], IsShown
- CMFCPopupMenu [MFC], MoveTo
- CMFCPopupMenu [MFC], OnCmdMsg
- CMFCPopupMenu [MFC], PostCommand
- CMFCPopupMenu [MFC], PreTranslateMessage
- CMFCPopupMenu [MFC], RecalcLayout
- CMFCPopupMenu [MFC], RemoveAllItems
- CMFCPopupMenu [MFC], RemoveItem
- CMFCPopupMenu [MFC], SaveState
- CMFCPopupMenu [MFC], SetAnimationSpeed
- CMFCPopupMenu [MFC], SetAnimationType
- CMFCPopupMenu [MFC], SetAutoDestroy
- CMFCPopupMenu [MFC], SetDefaultItem
- CMFCPopupMenu [MFC], SetForceMenuFocus
- CMFCPopupMenu [MFC], SetForceShadow
- CMFCPopupMenu [MFC], SetMaxWidth
- CMFCPopupMenu [MFC], SetMessageWnd
- CMFCPopupMenu [MFC], SetParentRibbonElement
- CMFCPopupMenu [MFC], SetQuickCustomizeType
- CMFCPopupMenu [MFC], SetQuickMode
- CMFCPopupMenu [MFC], SetRightAlign
- CMFCPopupMenu [MFC], SetSendMenuSelectMsg
- CMFCPopupMenu [MFC], ShowAllCommands
- CMFCPopupMenu [MFC], TriggerResize
- CMFCPopupMenu [MFC], UpdateAllShadows
- CMFCPopupMenu [MFC], UpdateShadow
- CMFCPopupMenu [MFC], CreateTearOffBar
- CMFCPopupMenu [MFC], OnChangeHot
- CMFCPopupMenu [MFC], OnChooseItem
ms.assetid: 9555dca1-8c9c-44c9-af72-0659ddad128e
ms.openlocfilehash: 89089559916419bc27b0528430fe7ad12ca804b0
ms.sourcegitcommit: ec6dd97ef3d10b44e0fedaa8e53f41696f49ac7b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/25/2020
ms.locfileid: "88841021"
---
# <a name="cmfcpopupmenu-class"></a>CMFCPopupMenu 類別

實作 Windows 快顯功能表功能，並加入功能 (例如 Tear-Off 功能表和工具提示) 進行擴充。
如需詳細資訊，請參閱位於 Visual Studio 安裝的 **VC \\ atlmfc \\ src \\ mfc** 資料夾中的原始程式碼。

## <a name="syntax"></a>語法

```
class CMFCPopupMenu : public CMiniFrameWnd
```

## <a name="members"></a>成員

### <a name="protected-constructors"></a>受保護的建構函式

|名稱|描述|
|----------|-----------------|
|[CMFCPopupMenu：： CMFCPopupMenu](#cmfcpopupmenu)|建構 `CMFCPopupMenu` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CMFCPopupMenu：： ActivatePopupMenu](#activatepopupmenu)||
|[CMFCPopupMenu：： AlwaysShowEmptyToolsEntry](#alwaysshowemptytoolsentry)|設定是否啟用快顯功能表，以顯示使用者定義工具的空白專案。|
|[CMFCPopupMenu：： AreAllCommandsShown](#areallcommandsshown)||
|[CMFCPopupMenu：： CheckArea](#checkarea)|決定相對於快顯功能表的點位置。|
|[CMFCPopupMenu：： CloseMenu](#closemenu)||
|[CMFCPopupMenu：： Create](#create)|建立快顯功能表，並將其附加至 `CMFCPopupMenu` 物件。|
|[CMFCPopupMenu：:D efaultMouseClickOnClose](#defaultmouseclickonclose)||
|[CMFCPopupMenu：： EnableMenuLogo](#enablemenulogo)|初始化快顯功能表的標誌。|
|[CMFCPopupMenu：： EnableMenuSound](#enablemenusound)|啟用功能表音效。|
|[CMFCPopupMenu：： EnableResize](#enableresize)||
|[CMFCPopupMenu：： EnableScrolling](#enablescrolling)||
|[CMFCPopupMenu：： EnableVertResize](#enablevertresize)||
|[CMFCPopupMenu：： FindSubItemByCommand](#findsubitembycommand)||
|[CMFCPopupMenu：： GetActiveMenu](#getactivemenu)|傳回目前使用中的功能表。|
|[CMFCPopupMenu：： GetAnimationSpeed](#getanimationspeed)|傳回快顯功能表的動畫速度。|
|[CMFCPopupMenu：： GetAnimationType](#getanimationtype)|傳回目前的快顯功能表動畫類型。|
|[CMFCPopupMenu：： GetDropDirection](#getdropdirection)||
|[CMFCPopupMenu：： GetForceMenuFocus](#getforcemenufocus)|指出當快顯功能表顯示時，焦點是否傳回功能表列。|
|[CMFCPopupMenu：： GetForceShadow](#getforceshadow)||
|[CMFCPopupMenu：： GetHMenu](#gethmenu)|傳回附加功能表資源的控制碼。|
|[CMFCPopupMenu：： GetMenuBar](#getmenubar)|傳回內嵌于快顯功能表內的 [CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md) 。|
|[CMFCPopupMenu：： GetMenuItem](#getmenuitem)|傳回位於指定索引處之功能表項目的指標。|
|[CMFCPopupMenu：： GetMenuItemCount](#getmenuitemcount)|傳回快顯功能表中的專案數。|
|[CMFCPopupMenu：： GetMessageWnd](#getmessagewnd)|傳回視窗的指標，架構會在其中路由快顯功能表訊息。|
|[CMFCPopupMenu：： GetParentArea](#getparentarea)||
|[CMFCPopupMenu：： GetParentButton](#getparentbutton)|傳回父工具列按鈕的指標。|
|[CMFCPopupMenu：： GetParentPopupMenu](#getparentpopupmenu)|傳回父快顯功能表的指標。|
|[CMFCPopupMenu：： GetParentRibbonElement](#getparentribbonelement)||
|[CMFCPopupMenu：： GetParentToolBar](#getparenttoolbar)|傳回父工具列的指標。|
|[CMFCPopupMenu：： GetQuickCustomizeType](#getquickcustomizetype)||
|[CMFCPopupMenu：： GetSelItem](#getselitem)|傳回目前所選功能表命令的指標。|
|[CMFCPopupMenu：： HasBeenResized](#hasbeenresized)||
|[CMFCPopupMenu：： HideRarelyUsedCommands](#hiderarelyusedcommands)|指出快顯功能表是否可以隱藏少用的命令。|
|[CMFCPopupMenu：： InCommand](#incommand)||
|[CMFCPopupMenu：： InsertItem](#insertitem)|將新專案插入快顯功能表中指定的位置。|
|[CMFCPopupMenu：： InsertSeparator](#insertseparator)|將分隔符號插入快顯功能表中指定的位置。|
|[CMFCPopupMenu：： IsAlwaysClose](#isalwaysclose)||
|[CMFCPopupMenu：： IsAlwaysShowEmptyToolsEntry](#isalwaysshowemptytoolsentry)||
|[CMFCPopupMenu：： IsCustomizePane](#iscustomizepane)|指出快顯功能表是否以 **QuickCustomizePane**的形式運作。|
|[CMFCPopupMenu：： IsEscClose](#isescclose)||
|[CMFCPopupMenu：： IsIdle](#isidle)|指出快顯功能表目前是否閒置。|
|[CMFCPopupMenu：： IsMenuSound](#ismenusound)||
|[CMFCPopupMenu：： IsQuickCustomize](#isquickcustomize)|判斷相關聯的 [CMFCToolBarMenuButton 類別](../../mfc/reference/cmfctoolbarmenubutton-class.md) 是否處於 QuickCustomize 模式。|
|[CMFCPopupMenu：： IsResizeble](#isresizeble)||
|[CMFCPopupMenu：： IsRightAlign](#isrightalign)|指出功能表是否靠右對齊或靠左對齊。|
|[CMFCPopupMenu：： IsScrollable](#isscrollable)||
|[CMFCPopupMenu：： IsSendMenuSelectMsg](#issendmenuselectmsg)|指出當使用者從快顯功能表選取命令時，架構是否會通知父框架。|
|[CMFCPopupMenu：： IsShown](#isshown)|指出快顯功能表目前是否可見。|
|[CMFCPopupMenu：： MoveTo](#moveto)||
|[CMFCPopupMenu：： OnCmdMsg](#oncmdmsg)|(覆寫 `CFrameWnd::OnCmdMsg`。)|
|[CMFCPopupMenu：:P ostCommand](#postcommand)||
|[CMFCPopupMenu：:P reTranslateMessage](#pretranslatemessage)|(覆寫 `CFrameWnd::PreTranslateMessage`。)|
|[CMFCPopupMenu：： RecalcLayout](#recalclayout)|當系統切換標準控制列或調整框架視窗大小時，由架構呼叫。  (覆寫 [CFrameWnd：： RecalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout)。 ) |
|[CMFCPopupMenu：： RemoveAllItems](#removeallitems)|清除快顯功能表中的所有專案。|
|[CMFCPopupMenu：： RemoveItem](#removeitem)|從快顯功能表中移除指定的專案。|
|[CMFCPopupMenu：： SaveState](#savestate)||
|[CMFCPopupMenu：： SetAnimationSpeed](#setanimationspeed)|設定快顯功能表的動畫速度。|
|[CMFCPopupMenu：： SetAnimationType](#setanimationtype)|設定快顯功能表的動畫類型。|
|[CMFCPopupMenu：： SetAutoDestroy](#setautodestroy)||
|[CMFCPopupMenu：： SetDefaultItem](#setdefaultitem)|設定快顯功能表的預設命令。|
|[CMFCPopupMenu：： SetForceMenuFocus](#setforcemenufocus)|當顯示快顯功能表時，強制輸入焦點回到功能表列。|
|[CMFCPopupMenu：： SetForceShadow](#setforceshadow)|當快顯功能表出現在主框架之外時，強制架構繪製功能表遮蔽。|
|[CMFCPopupMenu：： SetMaxWidth](#setmaxwidth)|設定快顯功能表的最大寬度。|
|[CMFCPopupMenu：： SetMessageWnd](#setmessagewnd)||
|[CMFCPopupMenu：： SetParentRibbonElement](#setparentribbonelement)||
|[CMFCPopupMenu：： SetQuickCustomizeType](#setquickcustomizetype)||
|[CMFCPopupMenu：： SetQuickMode](#setquickmode)||
|[CMFCPopupMenu：： SetRightAlign](#setrightalign)|設定快顯功能表的功能表對齊。|
|[CMFCPopupMenu：： SetSendMenuSelectMsg](#setsendmenuselectmsg)|設定旗標，控制當使用者選取命令時，快顯功能表是否會通知其父框架。|
|[CMFCPopupMenu：： ShowAllCommands](#showallcommands)|強制快顯功能表顯示所有命令。|
|[CMFCPopupMenu：： TriggerResize](#triggerresize)||
|[CMFCPopupMenu：： UpdateAllShadows](#updateallshadows)|更新所有開啟的快顯功能表的陰影。|
|[CMFCPopupMenu：： UpdateShadow](#updateshadow)|更新快顯功能表的陰影。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[CMFCPopupMenu：： CreateTearOffBar](#createtearoffbar)||
|[CMFCPopupMenu：： OnChangeHot](#onchangehot)||
|[CMFCPopupMenu：： OnChooseItem](#onchooseitem)||

### <a name="remarks"></a>備註

一般來說，MFC 會自動建立快顯功能表。 如果您想要手動建立 `CMFCPopupMenu` 物件，請在堆積上配置一個物件，然後呼叫 [CMFCPopupMenu：： create](#create)。

## <a name="example"></a>範例

下列範例示範如何設定快顯功能表物件。 此範例示範如何設定快顯功能表的標誌和音效、設定動畫速度和類型、在主框架外出現快顯功能表時繪製功能表陰影、設定最大寬度，以及設定快顯功能表的右功能表對齊。 此程式碼片段是 [自訂頁面範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_CustomPages#2](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[CMiniFrameWnd](../../mfc/reference/cminiframewnd-class.md)

`CMFCPopupMenu`

## <a name="requirements"></a>規格需求

**標頭：** afxpopupmenu。h

## <a name="cmfcpopupmenuactivatepopupmenu"></a><a name="activatepopupmenu"></a> CMFCPopupMenu：： ActivatePopupMenu

```
static BOOL __stdcall ActivatePopupMenu(
    CFrameWnd* pTopFrame,
    CMFCPopupMenu* pPopupMenu);
```

### <a name="parameters"></a>參數

在 *pTopFrame*<br/>
在 *pPopupMenu*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenualwaysshowemptytoolsentry"></a><a name="alwaysshowemptytoolsentry"></a> CMFCPopupMenu：： AlwaysShowEmptyToolsEntry

設定是否啟用快顯功能表，以顯示使用者定義工具的空白專案。

```
static void AlwaysShowEmptyToolsEntry(BOOL bShow = TRUE);
```

### <a name="parameters"></a>參數

*bShow*<br/>
在如果快顯功能表可以顯示空白專案則為 TRUE;否則為 FALSE。

## <a name="cmfcpopupmenuareallcommandsshown"></a><a name="areallcommandsshown"></a> CMFCPopupMenu：： AreAllCommandsShown

```
BOOL AreAllCommandsShown() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenucheckarea"></a><a name="checkarea"></a> CMFCPopupMenu：： CheckArea

決定相對於快顯功能表的點位置。

```
MENUAREA_TYPE CheckArea(const CPoint& ptScreen) const;
```

### <a name="parameters"></a>參數

*ptScreen*<br/>
在以螢幕座標表示的點。

### <a name="return-value"></a>傳回值

MENUAREA_TYPE 的參數，指出點相對於快顯功能表的位置。

### <a name="remarks"></a>備註

MENUAREA_TYPE 參數可以是下列任何一個值。

- 外部 *ptScreen* 在快顯功能表之外。

- 標誌- *ptScreen* 是在標誌區域上方。

- TEAROFF_CAPTION- *ptScreen* 已超出清除的標題。

- SHADOW_BOTTOM- *ptScreen* 是在快顯功能表的底部陰影上方。

- SHADOW_RIGHT- *ptScreen* 是在快顯功能表的右方陰影上方。

- 功能表- *ptScreen* 是在命令之上。

## <a name="cmfcpopupmenuclosemenu"></a><a name="closemenu"></a> CMFCPopupMenu：： CloseMenu

```cpp
void CloseMenu(BOOL bSetFocusToBar = FALSE);
```

### <a name="parameters"></a>參數

在 *bSetFocusToBar*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenucmfcpopupmenu"></a><a name="cmfcpopupmenu"></a> CMFCPopupMenu：： CMFCPopupMenu

結構 [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) 物件。

```
CMFCPopupMenu(
    CMFCToolBarsMenuPropertyPage* pCustPage,
    LPCTSTR lpszTitle);
```

### <a name="parameters"></a>參數

*pCustPage*<br/>
在自訂頁面的指標。

*lpszTitle*<br/>
在包含功能表標題的字串。

### <a name="remarks"></a>備註

這個方法會配置的資源 `CMFCPopupMenu` 。 若要建立快顯功能表專案，請呼叫 [CMFCPopupMenu：： create](#create)。

## <a name="cmfcpopupmenucreate"></a><a name="create"></a> CMFCPopupMenu：： Create

建立快顯功能表，並將其附加至 [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) 物件。

```
virtual BOOL Create(
    CWnd* pWndParent,
    int x,
    int y,
    HMENU hMenu,
    BOOL bLocked = FALSE,
    BOOL bOwnMessage = FALSE);
```

### <a name="parameters"></a>參數

*pWndParent*<br/>
在的父視窗 `CMFCPopupMenu` 。

*x*<br/>
在快顯功能表位置的水準螢幕座標

*y*<br/>
在快顯功能表位置的垂直螢幕座標。

*hMenu*<br/>
在功能表資源的控制碼。

*封鎖*<br/>
在布林值參數，指出功能表是否可自訂。 FALSE 表示快顯功能表可自訂。

*bOwnMessage*<br/>
在布林值參數，指出架構如何路由功能表訊息。 如需詳細資訊，請參閱＜備註＞一節。

### <a name="return-value"></a>傳回值

如果方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

如果 *bOwnMessage* 為 TRUE，則架構會將任何功能表訊息路由傳送至 *pWndParent*。 如果*bOwnMessage*為 TRUE， *PWNDPARENT*不得為 Null。 如果 *bOwnMessage* 為 FALSE，則架構會將功能表訊息路由傳送至上層快顯功能表。

### <a name="example"></a>範例

下列範例示範如何使用 `Create` 類別的方法 `CMFCPopuMenu` 。 此程式碼片段是 [自訂頁面範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_CustomPages#1](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_2.cpp)]

## <a name="cmfcpopupmenucreatetearoffbar"></a><a name="createtearoffbar"></a> CMFCPopupMenu：： CreateTearOffBar

```
virtual CPane* CreateTearOffBar(
    CFrameWnd* pWndMain,
    UINT uiID,
    LPCTSTR lpszName);
```

### <a name="parameters"></a>參數

在 *pWndMain*<br/>
在 *uiID*<br/>
在 *lpszName*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenudefaultmouseclickonclose"></a><a name="defaultmouseclickonclose"></a> CMFCPopupMenu：:D efaultMouseClickOnClose

```
virtual BOOL DefaultMouseClickOnClose() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuenablemenulogo"></a><a name="enablemenulogo"></a> CMFCPopupMenu：： EnableMenuLogo

初始化快顯功能表的標誌。

```cpp
void EnableMenuLogo(
    int iLogoSize,
    LOGO_LOCATION nLogoLocation = MENU_LOGO_LEFT);
```

### <a name="parameters"></a>參數

*iLogoSize*<br/>
在標誌的大小（以圖元為單位）。

*nLogoLocation*<br/>
在指出標誌位置的列舉資料類型。

### <a name="remarks"></a>備註

若要顯示標誌，請在主框架視窗中執行 [CFrameWndEx：： OnDrawMenuLogo](../../mfc/reference/cframewndex-class.md#ondrawmenulogo) 方法。

*NLogoLocation*的可能值為 MENU_LOGO_LEFT、MENU_LOGO_RIGHT、MENU_LOGO_TOP 和 MENU_LOGO_BOTTOM。

## <a name="cmfcpopupmenuenablemenusound"></a><a name="enablemenusound"></a> CMFCPopupMenu：： EnableMenuSound

啟用功能表音效。

```
static void EnableMenuSound(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在TRUE 表示啟用音效，否則為 FALSE。

### <a name="remarks"></a>備註

如果您啟用音效，則當使用者開啟快顯功能表或選取功能表命令時，架構會呼叫 [PlaySound](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iusernotification-playsound) 方法。 預設會啟用這項功能。

## <a name="cmfcpopupmenuenableresize"></a><a name="enableresize"></a> CMFCPopupMenu：： EnableResize

```cpp
void EnableResize(CSize sizeMinResize);
```

### <a name="parameters"></a>參數

在 *sizeMinResize*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuenablescrolling"></a><a name="enablescrolling"></a> CMFCPopupMenu：： EnableScrolling

```cpp
void EnableScrolling(BOOL = TRUE);
```

### <a name="parameters"></a>參數

在 *BOOL*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuenablevertresize"></a><a name="enablevertresize"></a> CMFCPopupMenu：： EnableVertResize

```cpp
void EnableVertResize(int nMinResize);
```

### <a name="parameters"></a>參數

在 *nMinResize*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenufindsubitembycommand"></a><a name="findsubitembycommand"></a> CMFCPopupMenu：： FindSubItemByCommand

```
CMFCToolBarMenuButton* FindSubItemByCommand(UINT uiCmd) const;
```

### <a name="parameters"></a>參數

在 *uiCmd*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenugetactivemenu"></a><a name="getactivemenu"></a> CMFCPopupMenu：： GetActiveMenu

傳回目前使用中的功能表。

```
static CMFCPopupMenu* GetActiveMenu();
```

### <a name="return-value"></a>傳回值

作用中快顯功能表的指標，如果沒有任何快顯功能表目前為使用中，則為 Null。

### <a name="remarks"></a>備註

每個應用程式最多隻能有一個作用中快顯功能表。

## <a name="cmfcpopupmenugetanimationspeed"></a><a name="getanimationspeed"></a> CMFCPopupMenu：： GetAnimationSpeed

傳回快顯功能表的動畫速度。

```
static UINT GetAnimationSpeed();
```

### <a name="return-value"></a>傳回值

整數，表示快顯功能表動畫完成所需的時間（以毫秒為單位）。

### <a name="remarks"></a>備註

動畫速度是全域值。 使用 [CMFCPopupMenu：： SetAnimationSpeed](#setanimationspeed) 來變更快顯功能表的動畫速度。

## <a name="cmfcpopupmenugetanimationtype"></a><a name="getanimationtype"></a> CMFCPopupMenu：： GetAnimationType

傳回目前的彈出動畫類型。

```
static CMFCPopupMenu::ANIMATION_TYPE GetAnimationType(BOOL bNoSystem = FALSE);
```

### <a name="parameters"></a>參數

*bNoSystem*<br/>
在指出此方法是否會檢查全域值的布林值參數。 如果您想要此方法傳回這個 [CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)實例的動畫樣式，則為 FALSE。

### <a name="return-value"></a>傳回值

描述動畫類型的列舉值。

### <a name="remarks"></a>備註

快顯功能表的動畫樣式在應用程式中是全域的。 使用 [CMFCPopupMenu：： SetAnimationType](#setanimationtype) 來設定動畫樣式。

下表列出可能的動畫類型。

|值|描述|
|-|-|
|NO_ANIMATION|快顯功能表不會以動畫顯示，且會立即顯示。  |
|展開|架構會顯示從左上角到右下角的快顯功能表。  |
|幻燈片|快顯功能表會從上往下移動。  |
|褪色|快顯功能表會先出現透明並逐漸 solidifies。  |

## <a name="cmfcpopupmenugetdropdirection"></a><a name="getdropdirection"></a> CMFCPopupMenu：： GetDropDirection

```
DROP_DIRECTION GetDropDirection() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenugetforcemenufocus"></a><a name="getforcemenufocus"></a> CMFCPopupMenu：： GetForceMenuFocus

指出當快顯功能表顯示時，焦點是否傳回功能表列。

```
static BOOL GetForceMenuFocus();
```

### <a name="return-value"></a>傳回值

如果在顯示快顯功能表時，將輸入焦點傳回至功能表列，則為 TRUE。如果快顯功能表保留焦點，則為 FALSE。

### <a name="remarks"></a>備註

根據預設，您的應用程式不會將焦點放在功能表列上。 若要變更此設定，請使用 [CMFCPopupMenu：： SetForceMenuFocus](#setforcemenufocus)。

## <a name="cmfcpopupmenugetforceshadow"></a><a name="getforceshadow"></a> CMFCPopupMenu：： GetForceShadow

```
static BOOL __stdcall GetForceShadow();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenugethmenu"></a><a name="gethmenu"></a> CMFCPopupMenu：： GetHMenu

傳回附加功能表資源的控制碼。

```
HMENU GetHMenu();
```

## <a name="cmfcpopupmenugetmenubar"></a><a name="getmenubar"></a> CMFCPopupMenu：： GetMenuBar

傳回內嵌于快顯功能表內的 [CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md) 。

```
virtual CMFCPopupMenuBar* GetMenuBar();
```

### <a name="return-value"></a>傳回值

內嵌的指標 `CMFCPopupMenuBar` 。

### <a name="remarks"></a>備註

快顯功能表具有內嵌 `CMFCPopupMenuBar` 物件。 如果您使用不同的內嵌類別，則必須在衍生類別中覆寫這個方法。

## <a name="cmfcpopupmenugetmenuitem"></a><a name="getmenuitem"></a> CMFCPopupMenu：： GetMenuItem

傳回位於指定索引處之功能表項目的指標。

```
CMFCToolBarMenuButton* GetMenuItem(int iIndex) const;
```

### <a name="parameters"></a>參數

*iIndex*<br/>
在以零為基底的功能表項目索引。

### <a name="return-value"></a>傳回值

功能表項目的指標。 如果索引無效，則為 Null。

### <a name="remarks"></a>備註

功能表項目會以 [CMFCToolBarMenuButton 類別](../../mfc/reference/cmfctoolbarmenubutton-class.md)表示。 當您呼叫這個方法時，它會將指標傳回至適當的 `CMFCToolBarMenuButton` 。

## <a name="cmfcpopupmenugetmenuitemcount"></a><a name="getmenuitemcount"></a> CMFCPopupMenu：： GetMenuItemCount

傳回快顯功能表中的專案數。

```
int GetMenuItemCount() const;
```

### <a name="return-value"></a>傳回值

功能表中的專案數。

## <a name="cmfcpopupmenugetmessagewnd"></a><a name="getmessagewnd"></a> CMFCPopupMenu：： GetMessageWnd

傳回視窗的指標，架構會在其中路由快顯功能表訊息。

```
CWnd* GetMessageWnd() const;
```

### <a name="return-value"></a>傳回值

接收快顯功能表訊息之視窗的指標;如果沒有視窗，則為 Null。

### <a name="remarks"></a>備註

當您使用 [CMFCPopupMenu：： create](#create) 方法來建立快顯功能表時，可以指定要接收功能表訊息的視窗。

## <a name="cmfcpopupmenugetparentarea"></a><a name="getparentarea"></a> CMFCPopupMenu：： GetParentArea

```
virtual CWnd* GetParentArea(CRect& rectParentBtn);
```

### <a name="parameters"></a>參數

在 *rectParentBtn*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenugetparentbutton"></a><a name="getparentbutton"></a> CMFCPopupMenu：： GetParentButton

傳回父工具列按鈕的指標。

```
CMFCToolBarMenuButton* GetParentButton() const;
```

### <a name="return-value"></a>傳回值

父工具列按鈕的指標。 如果快顯功能表沒有父工具列按鈕，則為 Null。

### <a name="remarks"></a>備註

`CMFCPopupMenu`可以與功能表上的按鈕相關聯。 在此案例中，當使用者選取父工具列按鈕時，會出現快顯功能表。

如果快顯功能表是快捷方式功能表，則不會有父工具列按鈕。

## <a name="cmfcpopupmenugetparentpopupmenu"></a><a name="getparentpopupmenu"></a> CMFCPopupMenu：： GetParentPopupMenu

傳回父快顯功能表的指標。

```
CMFCPopupMenu* GetParentPopupMenu() const;
```

### <a name="return-value"></a>傳回值

父物件的指標 `CMFCPopupMenu` ;如果沒有上層快顯功能表，則為 Null。

### <a name="remarks"></a>備註

`CMFCPopupMenu`只有當它是子功能表時，快顯功能表才會有父物件。

## <a name="cmfcpopupmenugetparentribbonelement"></a><a name="getparentribbonelement"></a> CMFCPopupMenu：： GetParentRibbonElement

```
CMFCRibbonBaseElement* GetParentRibbonElement() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenugetparenttoolbar"></a><a name="getparenttoolbar"></a> CMFCPopupMenu：： GetParentToolBar

傳回父工具列的指標。

```
CMFCToolBar* GetParentToolBar() const;
```

### <a name="return-value"></a>傳回值

父工具列的指標。 如果快顯功能表沒有父工具列，則為 Null。

### <a name="remarks"></a>備註

如果 `CMFCPopupMenu` 是快捷方式功能表，則沒有父工具列。

## <a name="cmfcpopupmenugetquickcustomizetype"></a><a name="getquickcustomizetype"></a> CMFCPopupMenu：： GetQuickCustomizeType

```
QUICK_CUSTOMIZE_TYPE GetQuickCustomizeType() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenugetselitem"></a><a name="getselitem"></a> CMFCPopupMenu：： GetSelItem

傳回目前所選功能表命令的指標。

```
CMFCToolBarMenuButton* GetSelItem();
```

### <a name="return-value"></a>傳回值

目前選取之功能表命令的指標;如果未選取任何專案，則為 Null。

### <a name="remarks"></a>備註

快顯功能表上的功能表命令會以 [CMFCToolBarMenuButton 類別](../../mfc/reference/cmfctoolbarmenubutton-class.md)或衍生自的類別來表示 `CMFCToolBarMenuButton` 。

## <a name="cmfcpopupmenuhasbeenresized"></a><a name="hasbeenresized"></a> CMFCPopupMenu：： HasBeenResized

```
BOOL HasBeenResized() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuhiderarelyusedcommands"></a><a name="hiderarelyusedcommands"></a> CMFCPopupMenu：： HideRarelyUsedCommands

指出快顯功能表是否可以隱藏少用的命令。

```
BOOL HideRarelyUsedCommands() const;
```

### <a name="return-value"></a>傳回值

如果快顯功能表可以隱藏少用的命令，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法只會指定快顯功能表是否可以隱藏少用的命令，而不是啟用該設定。 如果快顯功能表具有父按鈕且父視窗衍生自 [CMFCMenuBar 類別](../../mfc/reference/cmfcmenubar-class.md)，則可以隱藏很少使用的命令。 使用 [CMFCMenuBar：： SetRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#setrecentlyusedmenus) 來啟用這項功能，並使用 [CMFCMenuBar：： IsRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#isrecentlyusedmenus) 來判斷這項功能目前是否已啟用。 您必須為父視窗呼叫這兩種方法。

## <a name="cmfcpopupmenuincommand"></a><a name="incommand"></a> CMFCPopupMenu：： InCommand

```
virtual BOOL InCommand();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuinsertitem"></a><a name="insertitem"></a> CMFCPopupMenu：： InsertItem

將新專案插入快顯功能表中指定的位置。

```
int InsertItem(
    const CMFCToolBarMenuButton& button,
    int iInsertA = -1);
```

### <a name="parameters"></a>參數

*按鈕*<br/>
在要加入之功能表項目的參考。

*iInsertAt*<br/>
在新專案以零為基底的索引。 如果 *iInsertAt* 為-1，則會將專案加入至功能表的結尾。

### <a name="return-value"></a>傳回值

插入專案之位置的以零為基底的索引。 如果方法失敗，則為-1。

### <a name="remarks"></a>備註

如果您為 *iInsertAt*提供了不正確值（例如大於目前快顯功能表上的專案數目的整數），這個方法將會失敗。

## <a name="cmfcpopupmenuinsertseparator"></a><a name="insertseparator"></a> CMFCPopupMenu：： InsertSeparator

將分隔符號插入快顯功能表中指定的位置。

```
int InsertSeparator(int iInsertAt = -1);
```

### <a name="parameters"></a>參數

*iInsertAt*<br/>
在以零為基底的索引，此為這個方法將插入分隔符號的位置。

### <a name="return-value"></a>傳回值

插入分隔符號之位置以零為基底的索引。 如果此方法失敗，則為-1。

### <a name="remarks"></a>備註

*IInsertAt*的值為-1，表示這個方法會將分隔符號加入快顯功能表的結尾。

如果 *iInsertAt* 是不正確值，則這個方法會失敗。

## <a name="cmfcpopupmenuisalwaysclose"></a><a name="isalwaysclose"></a> CMFCPopupMenu：： IsAlwaysClose

```
virtual BOOL IsAlwaysClose() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuisalwaysshowemptytoolsentry"></a><a name="isalwaysshowemptytoolsentry"></a> CMFCPopupMenu：： IsAlwaysShowEmptyToolsEntry

```
static BOOL __stdcall IsAlwaysShowEmptyToolsEntry();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuiscustomizepane"></a><a name="iscustomizepane"></a> CMFCPopupMenu：： IsCustomizePane

指出快顯功能表是否以 **QuickCustomizePane**的形式運作。

```
BOOL IsCustomizePane();
```

### <a name="return-value"></a>傳回值

如果快顯視窗是 **QuckCustomizePane**，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

使用 **QuickCustomizePane** 可讓使用者直接自訂快顯功能表。 **QuickCustomizePane**是 `CMFCPopupMenu` 當使用者按一下工具列按鈕來直接編輯時所顯示的。

您的應用程式應該在 [CMDIFrameWndEx：： OnShowCustomizePane](../../mfc/reference/cmdiframewndex-class.md#onshowcustomizepane)期間呼叫此方法。

## <a name="cmfcpopupmenuisescclose"></a><a name="isescclose"></a> CMFCPopupMenu：： IsEscClose

```
BOOL IsEscClose();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuisidle"></a><a name="isidle"></a> CMFCPopupMenu：： IsIdle

指出快顯功能表目前是否閒置。

```
virtual BOOL IsIdle() const;
```

### <a name="return-value"></a>傳回值

如果快顯功能表處於閒置模式，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

依預設，如果顯示動畫已完成，而且使用者不會滾動快顯功能表，則快顯功能表會處於閒置模式。

## <a name="cmfcpopupmenuismenusound"></a><a name="ismenusound"></a> CMFCPopupMenu：： IsMenuSound

```
static UINT __stdcall IsMenuSound();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuisquickcustomize"></a><a name="isquickcustomize"></a> CMFCPopupMenu：： IsQuickCustomize

判斷相關聯的 [CMFCToolBarMenuButton 類別](../../mfc/reference/cmfctoolbarmenubutton-class.md) 是否處於 QuickCustomize 模式。

```
BOOL IsQuickCustomize();
```

### <a name="return-value"></a>傳回值

如果相關聯的功能表按鈕處於 QuickCustomize 模式，則為 TRUE;否則為 FALSE。 如果快顯功能表未與相關聯，這個方法也會傳回 FALSE `CMFCToolBarMenuButton` 。

### <a name="remarks"></a>備註

在 QuickCustomize 模式中，使用者可以選取工具列上的按鈕，直接自訂按鈕。

## <a name="cmfcpopupmenuisresizeble"></a><a name="isresizeble"></a> CMFCPopupMenu：： IsResizeble

```
BOOL IsResizeble() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuisrightalign"></a><a name="isrightalign"></a> CMFCPopupMenu：： IsRightAlign

指出功能表是否靠右對齊或靠左對齊。

```
BOOL IsRightAlign() const;
```

### <a name="return-value"></a>傳回值

如果功能表靠右對齊，則為 TRUE;如果功能表靠左對齊，則為 FALSE。

### <a name="remarks"></a>備註

您可以使用 [CMFCPopupMenu：： SetRightAlign](#setrightalign) 來設定功能表對齊。 依預設，快顯功能表會使用靠左對齊。

功能表對齊不是全域設定，而且在快顯功能表之間可能會有所不同。

## <a name="cmfcpopupmenuisscrollable"></a><a name="isscrollable"></a> CMFCPopupMenu：： IsScrollable

```
BOOL IsScrollable() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuissendmenuselectmsg"></a><a name="issendmenuselectmsg"></a> CMFCPopupMenu：： IsSendMenuSelectMsg

指出當使用者從快顯功能表選取命令時，架構是否會通知父框架。

```
static BOOL IsSendMenuSelectMsg();
```

### <a name="return-value"></a>傳回值

如果架構通知父框架則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

架構會在使用選取功能表命令時，將 WM_MENUSELECT 訊息傳送給父框架。

## <a name="cmfcpopupmenuisshown"></a><a name="isshown"></a> CMFCPopupMenu：： IsShown

指出快顯功能表目前是否可見。

```
BOOL IsShown() const;
```

### <a name="return-value"></a>傳回值

如果可以看到快顯功能表，則為 TRUE;否則為 FALSE。

## <a name="cmfcpopupmenumoveto"></a><a name="moveto"></a> CMFCPopupMenu：： MoveTo

```cpp
void MoveTo(const CPoint& pt);
```

### <a name="parameters"></a>參數

在 *pt*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuonchangehot"></a><a name="onchangehot"></a> CMFCPopupMenu：： OnChangeHot

```
virtual void OnChangeHot(int nHot);
```

### <a name="parameters"></a>參數

在 *nHot*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuonchooseitem"></a><a name="onchooseitem"></a> CMFCPopupMenu：： OnChooseItem

```
virtual void OnChooseItem(UINT uidCmdID);
```

### <a name="parameters"></a>參數

在 *uidCmdID*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuoncmdmsg"></a><a name="oncmdmsg"></a> CMFCPopupMenu：： OnCmdMsg

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>參數

在 *nID*<br/>
在 *nCode*<br/>
在 *pExtra*<br/>
在 *pHandlerInfo*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenupostcommand"></a><a name="postcommand"></a> CMFCPopupMenu：:P ostCommand

```
BOOL PostCommand(UINT uiCommandID);
```

### <a name="parameters"></a>參數

在 *uiCommandID*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenupretranslatemessage"></a><a name="pretranslatemessage"></a> CMFCPopupMenu：:P reTranslateMessage

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>參數

在 *pMsg*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenurecalclayout"></a><a name="recalclayout"></a> CMFCPopupMenu：： RecalcLayout

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>參數

在 *bNotify*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuremoveallitems"></a><a name="removeallitems"></a> CMFCPopupMenu：： RemoveAllItems

清除快顯功能表中的所有專案。

```cpp
void RemoveAllItems();
```

## <a name="cmfcpopupmenuremoveitem"></a><a name="removeitem"></a> CMFCPopupMenu：： RemoveItem

從快顯功能表中移除指定的專案。

```
BOOL RemoveItem(int iIndex);
```

### <a name="parameters"></a>參數

*iIndex*<br/>
在要刪除之專案的以零為基底的索引。

### <a name="return-value"></a>傳回值

如果方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會自動排文任何由移除專案所影響的分隔符號。 如需架構如何重新排列分隔符號的詳細資訊，請參閱 [CMFCToolBar：： RemoveButton](../../mfc/reference/cmfctoolbar-class.md#removebutton)。

## <a name="cmfcpopupmenusavestate"></a><a name="savestate"></a> CMFCPopupMenu：： SaveState

```
virtual void SaveState();
```

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenusetanimationspeed"></a><a name="setanimationspeed"></a> CMFCPopupMenu：： SetAnimationSpeed

設定快顯功能表的動畫速度。

```
static void SetAnimationSpeed(UINT nElapse);
```

### <a name="parameters"></a>參數

*nElapse*<br/>
在新的動畫速度（以毫秒為單位）。

### <a name="remarks"></a>備註

動畫速度是全域值，會影響應用程式中的所有快顯功能表。 這個值會指定快顯功能表完成動畫所需的時間。

根據預設，此參數設定為30毫秒。 *NElapse*的有效值範圍是從0到200。

## <a name="cmfcpopupmenusetanimationtype"></a><a name="setanimationtype"></a> CMFCPopupMenu：： SetAnimationType

設定這個快顯功能表的動畫類型。

```
static void SetAnimationType(CMFCPopupMenu::ANIMATION_TYPE type);
```

### <a name="parameters"></a>參數

*type*<br/>
在指定動畫類型的列舉資料類型。

### <a name="remarks"></a>備註

請參閱 [CMFCPopupMenu：： GetAnimationType](#getanimationtype) ，以取得 *類型*的有效值清單。

## <a name="cmfcpopupmenusetautodestroy"></a><a name="setautodestroy"></a> CMFCPopupMenu：： SetAutoDestroy

```cpp
void SetAutoDestroy(BOOL bAutoDestroy = TRUE);
```

### <a name="parameters"></a>參數

在 *bAutoDestroy*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenusetdefaultitem"></a><a name="setdefaultitem"></a> CMFCPopupMenu：： SetDefaultItem

設定快顯功能表的預設命令。

```cpp
void SetDefaultItem(UINT uiCmd);
```

### <a name="parameters"></a>參數

*uiCmd*<br/>
在新預設命令的功能表命令識別碼。

### <a name="remarks"></a>備註

快顯功能表中的預設命令是在快顯功能表出現時選取的命令。

## <a name="cmfcpopupmenusetforcemenufocus"></a><a name="setforcemenufocus"></a> CMFCPopupMenu：： SetForceMenuFocus

當顯示快顯功能表時，強制輸入焦點回到功能表列。

```
static void SetForceMenuFocus(BOOL bValue);
```

### <a name="parameters"></a>參數

*其中 bvalue system.boolean.true*<br/>
在如果您想要在顯示快顯功能表時，讓架構強制將輸入焦點放在功能表列上，則為 TRUE。 如果您想要快顯功能表來保留焦點，則為 FALSE。

### <a name="remarks"></a>備註

這個方法會為應用程式中的所有快顯功能表設定全域旗標。 依預設，不會啟用這項功能。

## <a name="cmfcpopupmenusetforceshadow"></a><a name="setforceshadow"></a> CMFCPopupMenu：： SetForceShadow

當快顯功能表出現在主框架之外時，強制架構繪製功能表遮蔽。

```
static void SetForceShadow(BOOL bValue);
```

### <a name="parameters"></a>參數

*其中 bvalue system.boolean.true*<br/>
在如果您想要讓架構繪製功能表陰影，則為 TRUE，否則為 FALSE。

### <a name="remarks"></a>備註

當您呼叫這個方法時，它會在您的應用程式中設定全域旗標。 此旗標會影響您應用程式中的所有快顯功能表。

## <a name="cmfcpopupmenusetmaxwidth"></a><a name="setmaxwidth"></a> CMFCPopupMenu：： SetMaxWidth

設定快顯功能表的最大寬度。

```cpp
void SetMaxWidth(int iMaxWidth);
```

### <a name="parameters"></a>參數

*iMaxWidth*<br/>
在快顯功能表的最大寬度（以圖元為單位）。

### <a name="remarks"></a>備註

如果與功能表命令相關聯的文字無法容納最大寬度，則會被截斷，而且不適合的部分會以三個點取代。

## <a name="cmfcpopupmenusetmessagewnd"></a><a name="setmessagewnd"></a> CMFCPopupMenu：： SetMessageWnd

```cpp
void SetMessageWnd(CWnd* pMsgWnd);
```

### <a name="parameters"></a>參數

在 *pMsgWnd*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenusetparentribbonelement"></a><a name="setparentribbonelement"></a> CMFCPopupMenu：： SetParentRibbonElement

```cpp
void SetParentRibbonElement(CMFCRibbonBaseElement* pElem);
```

### <a name="parameters"></a>參數

在 *pElem*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenusetquickcustomizetype"></a><a name="setquickcustomizetype"></a> CMFCPopupMenu：： SetQuickCustomizeType

```cpp
void SetQuickCustomizeType(QUICK_CUSTOMIZE_TYPE Type);
```

### <a name="parameters"></a>參數

在 *類型*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenusetquickmode"></a><a name="setquickmode"></a> CMFCPopupMenu：： SetQuickMode

```cpp
void SetQuickMode();
```

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenusetrightalign"></a><a name="setrightalign"></a> CMFCPopupMenu：： SetRightAlign

設定快顯功能表的功能表對齊。

```cpp
void SetRightAlign(BOOL bRightAlign = TRUE);
```

### <a name="parameters"></a>參數

*bRightAlign*<br/>
在指出功能表對齊的布林值。 TRUE 表示靠右對齊，FALSE 表示靠左對齊。

### <a name="remarks"></a>備註

依預設，所有快顯功能表都會靠左對齊。

## <a name="cmfcpopupmenusetsendmenuselectmsg"></a><a name="setsendmenuselectmsg"></a> CMFCPopupMenu：： SetSendMenuSelectMsg

設定旗標，控制當使用者選取命令時，快顯功能表是否會通知其父框架。

```
static void SetSendMenuSelectMsg(BOOL bSet = TRUE);
```

### <a name="parameters"></a>參數

*bSet*<br/>
在如果快顯功能表通知其父框架則為 TRUE，否則為 FALSE。

### <a name="remarks"></a>備註

這是應用程式中所有快顯功能表的全域選項。 如果已啟用，則當使用者選取命令時，快顯功能表會將 WM_MENUSELECT 訊息傳送至父框架。

## <a name="cmfcpopupmenushowallcommands"></a><a name="showallcommands"></a> CMFCPopupMenu：： ShowAllCommands

強制快顯功能表顯示所有命令。

```cpp
void ShowAllCommands();
```

### <a name="remarks"></a>備註

這不是全域設定，只會影響目前的快顯功能表。

## <a name="cmfcpopupmenutriggerresize"></a><a name="triggerresize"></a> CMFCPopupMenu：： TriggerResize

```cpp
void TriggerResize();
```

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuupdateallshadows"></a><a name="updateallshadows"></a> CMFCPopupMenu：： UpdateAllShadows

更新所有開啟的快顯功能表的陰影。

```
static void UpdateAllShadows(LPRECT lprectScreen = NULL);
```

### <a name="parameters"></a>參數

*lprectScreen*<br/>
在指定要更新之區域的矩形（以螢幕座標為單位）。

### <a name="remarks"></a>備註

當快顯功能表顯示在具有動態內容的動畫控制項或其他視窗上時，這個方法很有用。

## <a name="cmfcpopupmenuupdateshadow"></a><a name="updateshadow"></a> CMFCPopupMenu：： UpdateShadow

更新快顯功能表的陰影。

```cpp
void UpdateShadow(LPRECT lprectScreen = NULL);
```

### <a name="parameters"></a>參數

*lprectScreen*<br/>
在以螢幕座標表示的矩形，可指定要更新之區域的界限。

### <a name="remarks"></a>備註

當具有陰影的快顯功能表與動畫影像重迭時，請呼叫這個方法。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMFCPopupMenuBar 類別](../../mfc/reference/cmfcpopupmenubar-class.md)
