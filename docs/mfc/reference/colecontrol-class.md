---
title: COleControl 類別
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 074b0e1df5a8d70c8b32ee03dcb073c26c13be9b
ms.sourcegitcommit: ec6dd97ef3d10b44e0fedaa8e53f41696f49ac7b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/25/2020
ms.locfileid: "88840995"
---
# <a name="colecontrol-class"></a>COleControl 類別

開發 OLE 控制項的強大基底類別。

## <a name="syntax"></a>語法

```
class COleControl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[COleControl：： COleControl](#colecontrol)|建立 `COleControl` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[COleControl：： AmbientAppearance](#ambientappearance)|抓取控制項目前的外觀。|
|[COleControl：： AmbientBackColor](#ambientbackcolor)|傳回環境背景色彩屬性的值。|
|[COleControl：： AmbientDisplayName](#ambientdisplayname)|傳回容器所指定的控制項名稱。|
|[COleControl：： AmbientFont](#ambientfont)|傳回環境字型屬性的值。|
|[COleControl：： AmbientForeColor](#ambientforecolor)|傳回環境前景屬性的值。|
|[COleControl：： AmbientLocaleID](#ambientlocaleid)|傳回容器的地區設定識別碼。|
|[COleControl：： AmbientScaleUnits](#ambientscaleunits)|傳回容器所使用的單位類型。|
|[COleControl：： AmbientShowGrabHandles](#ambientshowgrabhandles)|決定是否應該顯示抓取控點。|
|[COleControl：： AmbientShowHatching](#ambientshowhatching)|決定是否應該顯示影線。|
|[COleControl：： AmbientTextAlign](#ambienttextalign)|傳回容器所指定的文字對齊類型。|
|[COleControl：： AmbientUIDead](#ambientuidead)|判斷控制項是否應該回應使用者介面動作。|
|[COleControl：： AmbientUserMode](#ambientusermode)|決定容器的模式。|
|[COleControl：： BoundPropertyChanged](#boundpropertychanged)|通知容器系結的屬性已變更。|
|[COleControl：： BoundPropertyRequestEdit](#boundpropertyrequestedit)|要求編輯屬性值的許可權。|
|[COleControl：： ClientToParent](#clienttoparent)|將相對於控制項原點的點轉譯為相對於其容器原點的相對位置。|
|[COleControl：： ClipCaretRect](#clipcaretrect)|調整插入號矩形（如果它由控制項重迭）。|
|[COleControl：： ControlInfoChanged](#controlinfochanged)|當控制項所處理的助憶鍵集合變更之後，請呼叫此函式。|
|[COleControl：:D isplayError](#displayerror)|將股票錯誤事件顯示給控制項的使用者。|
|[COleControl：:D oClick](#doclick)|內建方法的執行 `DoClick` 。|
|[COleControl：:D oPropExchange](#dopropexchange)|序列化物件的屬性 `COleControl` 。|
|[COleControl：:D oSuperclassPaint](#dosuperclasspaint)|重新繪製已從 Windows 控制項子類別化的 OLE 控制項。|
|[COleControl：： EnableSimpleFrame](#enablesimpleframe)|啟用控制項的簡單框架支援。|
|[COleControl：： ExchangeExtent](#exchangeextent)|序列化控制項的寬度和高度。|
|[COleControl：： ExchangeStockProps](#exchangestockprops)|序列化控制項的內建屬性。|
|[COleControl：： ExchangeVersion](#exchangeversion)|序列化控制項的版本號碼。|
|[COleControl：： FireClick](#fireclick)|引發內建 `Click` 事件。|
|[COleControl：： FireDblClick](#firedblclick)|引發內建 `DblClick` 事件。|
|[COleControl：： FireError](#fireerror)|引發內建 `Error` 事件。|
|[COleControl：： FireEvent](#fireevent)|引發自訂事件。|
|[COleControl：： FireKeyDown](#firekeydown)|引發內建 `KeyDown` 事件。|
|[COleControl：： FireKeyPress](#firekeypress)|引發內建 `KeyPress` 事件。|
|[COleControl：： FireKeyUp](#firekeyup)|引發內建 `KeyUp` 事件。|
|[COleControl：： FireMouseDown](#firemousedown)|引發內建 `MouseDown` 事件。|
|[COleControl：： FireMouseMove](#firemousemove)|引發內建 `MouseMove` 事件。|
|[COleControl：： FireMouseUp](#firemouseup)|引發內建 `MouseUp` 事件。|
|[COleControl：： FireReadyStateChange](#firereadystatechange)|當控制項的就緒狀態變更時引發事件。|
|[COleControl：： GetActivationPolicy](#getactivationpolicy)|改變支援介面之控制項的預設啟用行為 `IPointerInactive` 。|
|[COleControl：： GetAmbientProperty](#getambientproperty)|傳回指定的環境屬性值。|
|[COleControl：： GetAppearance](#getappearance)|傳回 stock 外觀屬性的值。|
|[COleControl：： GetBackColor](#getbackcolor)|傳回庫存背景色彩屬性的值。|
|[COleControl：： GetBorderStyle](#getborderstyle)|傳回 stock BorderStyle 屬性的值。|
|[COleControl：： GetCapture](#getcapture)|判斷無視窗、啟用的控制項物件是否具有滑鼠捕捉。|
|[COleControl：： GetClassID](#getclassid)|抓取控制項的 OLE 類別識別碼。|
|[COleControl：： GetClientOffset](#getclientoffset)|抓取控制項矩形區域左上角和其用戶端區域左上角之間的差異。|
|[COleControl：： GetClientRect](#getclientrect)|抓取控制項工作區的大小。|
|[COleControl：： GetClientSite](#getclientsite)|查詢物件，以取得其容器內其目前用戶端網站的指標。|
|[COleControl：： GetControlFlags](#getcontrolflags)|抓取控制項旗標設定。|
|[COleControl：： GetControlSize](#getcontrolsize)|傳回 OLE 控制項的位置和大小。|
|[COleControl：： GetDC](#getdc)|提供一個方法，讓無視窗控制項從其容器取得裝置內容。|
|[COleControl：： GetEnabled](#getenabled)|傳回已啟用庫存屬性的值。|
|[COleControl：： GetExtendedControl](#getextendedcontrol)|抓取屬於容器之延伸控制項物件的指標。|
|[COleControl：： GetFocus](#getfocus)|判斷控制項是否具有焦點。|
|[COleControl：： GetFont](#getfont)|傳回 stock 字型屬性的值。|
|[COleControl：： GetFontTextMetrics](#getfonttextmetrics)|傳回物件的度量 `CFontHolder` 。|
|[COleControl：： GetForeColor](#getforecolor)|傳回股票前景屬性的值。|
|[COleControl：： GetHwnd](#gethwnd)|傳回 stock hWnd 屬性的值。|
|[COleControl：： GetMessageString](#getmessagestring)|提供功能表項目的狀態列文字。|
|[COleControl：： GetNotSupported](#getnotsupported)|防止使用者存取控制項的屬性值。|
|[COleControl：： GetReadyState](#getreadystate)|傳回控制項的就緒狀態。|
|[COleControl：： GetRectInContainer](#getrectincontainer)|傳回相對於其容器的控制項矩形。|
|[COleControl：： GetStockTextMetrics](#getstocktextmetrics)|傳回股票字型屬性的度量。|
|[COleControl：： GetText](#gettext)|傳回 stock Text 或 Caption 屬性的值。|
|[COleControl：： GetWindowlessDropTarget](#getwindowlessdroptarget)|覆寫以允許無視窗控制項成為拖放作業的目標。|
|[COleControl：： InitializeIIDs](#initializeiids)|通知控制項將使用的 Iid 基類。|
|[COleControl：： InternalGetFont](#internalgetfont)|傳回 `CFontHolder` Stock 字型屬性的物件。|
|[COleControl：： InternalGetText](#internalgettext)|抓取股票字幕或文字屬性。|
|[COleControl：： InternalSetReadyState](#internalsetreadystate)|設定控制項的就緒狀態，並引發就緒狀態變更事件。|
|[COleControl：： InvalidateControl](#invalidatecontrol)|使顯示控制項的區域失效，使其重新繪製。|
|[COleControl：： InvalidateRgn](#invalidatergn)|使容器視窗在指定區域內的工作區失效。 可以用來在區域中重新繪製無視窗的控制項。|
|[COleControl：： IsConvertingVBX](#isconvertingvbx)|允許 OLE 控制項的特殊載入。|
|[COleControl：： IsModified](#ismodified)|判斷控制項狀態是否已變更。|
|[COleControl：： IsOptimizedDraw](#isoptimizeddraw)|指出容器是否支援目前繪圖作業的優化繪圖。|
|[COleControl：： IsSubclassedControl](#issubclassedcontrol)|呼叫以判斷控制項是否子類別化 Windows 控制項。|
|[COleControl：： Load](#load)|重設任何先前的非同步資料，並起始控制項非同步屬性的新負載。|
|[COleControl：： LockInPlaceActive](#lockinplaceactive)|決定容器是否可以停用您的控制項。|
|[COleControl：： OnAmbientPropertyChange](#onambientpropertychange)|當環境屬性變更時呼叫。|
|[COleControl：： OnAppearanceChanged](#onappearancechanged)|當庫存外觀屬性變更時呼叫。|
|[COleControl：： OnBackColorChanged](#onbackcolorchanged)|當庫存背景顏色屬性變更時呼叫。|
|[COleControl：： OnBorderStyleChanged](#onborderstylechanged)|當 stock BorderStyle 屬性變更時呼叫。|
|[COleControl：： OnClick](#onclick)|呼叫以引發 stock Click 事件。|
|[COleControl：： OnClose](#onclose)|通知控制項已 `IOleControl::Close` 被呼叫。|
|[COleControl：： OnDoVerb](#ondoverb)|在控制項動詞執行之後呼叫。|
|[COleControl：： OnDraw](#ondraw)|要求控制項重新繪製時呼叫。|
|[COleControl：： OnDrawMetafile](#ondrawmetafile)|當要求控制項使用中繼檔裝置內容重繪自己時，由容器呼叫。|
|[COleControl：： OnEdit](#onedit)|由容器呼叫至 UI 可啟動 OLE 控制項。|
|[COleControl：： OnEnabledChanged](#onenabledchanged)|當已啟用庫存屬性變更時呼叫。|
|[COleControl：： OnEnumVerbs](#onenumverbs)|由容器呼叫以列舉控制項的動詞。|
|[COleControl：： OnEventAdvise](#oneventadvise)|當事件處理常式連接或與控制項中斷連接時呼叫。|
|[COleControl：： OnFontChanged](#onfontchanged)|當 stock 字型屬性變更時呼叫。|
|[COleControl：： OnForeColorChanged](#onforecolorchanged)|當庫存前景屬性變更時呼叫。|
|[COleControl：： OnFreezeEvents](#onfreezeevents)|當控制項的事件凍結或解除凍結時呼叫。|
|[COleControl：： OnGetColorSet](#ongetcolorset)|通知控制項已 `IOleObject::GetColorSet` 被呼叫。|
|[COleControl：： OnGetControlInfo](#ongetcontrolinfo)|提供助憶鍵資訊給容器。|
|[COleControl：： OnGetDisplayString](#ongetdisplaystring)|呼叫以取得代表屬性值的字串。|
|[COleControl：： OnGetInPlaceMenu](#ongetinplacemenu)|要求將與容器功能表合併之控制項功能表的控制碼。|
|[COleControl：： OnGetNaturalExtent](#ongetnaturalextent)|覆寫以抓取控制項的顯示大小，最接近建議的大小和範圍模式。|
|[COleControl：： OnGetPredefinedStrings](#ongetpredefinedstrings)|傳回代表屬性可能值的字串。|
|[COleControl：： OnGetPredefinedValue](#ongetpredefinedvalue)|傳回對應至預先定義之字串的值。|
|[COleControl：： OnGetViewExtent](#ongetviewextent)|覆寫以抓取控制項顯示區域的大小 (可以用來啟用兩階段繪圖) 。|
|[COleControl：： OnGetViewRect](#ongetviewrect)|覆寫將控制項的大小轉換成從特定位置開始的矩形。|
|[COleControl：： OnGetViewStatus](#ongetviewstatus)|覆寫以取得控制項的檢視狀態。|
|[COleControl：： OnHideToolBars](#onhidetoolbars)|當控制項已停用時，由容器呼叫。|
|[COleControl：： OnInactiveMouseMove](#oninactivemousemove)|[覆寫]，讓滑鼠指標下的非使用中控制項的容器 WM_MOUSEMOVE 傳送給控制項的訊息。|
|[COleControl：： OnInactiveSetCursor](#oninactivesetcursor)|[覆寫]，讓滑鼠指標下的非使用中控制項的容器 WM_SETCURSOR 傳送給控制項的訊息。|
|[COleControl：： OnKeyDownEvent](#onkeydownevent)|在引發 stock KeyDown 事件之後呼叫。|
|[COleControl：： OnKeyPressEvent](#onkeypressevent)|在引發 stock KeyPress 事件之後呼叫。|
|[COleControl：： OnKeyUpEvent](#onkeyupevent)|在引發 stock KeyUp 事件之後呼叫。|
|[COleControl：： OnMapPropertyToPage](#onmappropertytopage)|指出要用來編輯屬性的屬性頁。|
|[COleControl：： OnMnemonic](#onmnemonic)|在按下控制項的助憶鍵鍵時呼叫。|
|[COleControl：： OnProperties](#onproperties)|在叫用控制項的 "Properties" 動詞時呼叫。|
|[COleControl：： OnQueryHitPoint](#onqueryhitpoint)|覆寫以查詢控制項的顯示是否與給定的點重迭。|
|[COleControl：： OnQueryHitRect](#onqueryhitrect)|覆寫以查詢控制項的顯示是否與給定矩形中的任何點重迭。|
|[COleControl：： OnRenderData](#onrenderdata)|由架構呼叫以取得指定格式的資料。|
|[COleControl：： OnRenderFileData](#onrenderfiledata)|由架構呼叫以從指定格式的檔案中取出資料。|
|[COleControl：： OnRenderGlobalData](#onrenderglobaldata)|由架構呼叫，以指定的格式從全域記憶體中取出資料。|
|[COleControl：： OnResetState](#onresetstate)|將控制項的屬性重設為預設值。|
|[COleControl：： OnSetClientSite](#onsetclientsite)|通知控制項已 `IOleControl::SetClientSite` 被呼叫。|
|[COleControl：： OnSetData](#onsetdata)|以另一個值取代控制項的資料。|
|[COleControl：： OnSetExtent](#onsetextent)|在控制項的範圍變更之後呼叫。|
|[COleControl：： OnSetObjectRects](#onsetobjectrects)|在控制項的維度變更之後呼叫。|
|[COleControl：： OnShowToolBars](#onshowtoolbars)|在控制項已啟用 UI 時呼叫。|
|[COleControl：： OnTextChanged](#ontextchanged)|當 stock Text 或 Caption 屬性變更時呼叫。|
|[COleControl：： OnWindowlessMessage](#onwindowlessmessage)|處理視窗訊息 (非無視窗控制項) 的滑鼠和鍵盤訊息。|
|[COleControl：:P arentToClient](#parenttoclient)|將相對於容器原點的點轉譯為相對於控制項原點的點。|
|[COleControl：:P ostModalDialog](#postmodaldialog)|通知容器已關閉強制回應對話方塊。|
|[COleControl：:P reModalDialog](#premodaldialog)|通知容器要顯示模式對話方塊。|
|[COleControl：： RecreateControlWindow](#recreatecontrolwindow)|終結並重新建立控制項的視窗。|
|[COleControl：： Refresh](#refresh)|強制重新繪製控制項的外觀。|
|[COleControl：： ReleaseCapture](#releasecapture)|釋放滑鼠捕捉。|
|[COleControl：： ReleaseDC](#releasedc)|釋放無視窗控制項容器的顯示裝置內容。|
|[COleControl：： ReparentControlWindow](#reparentcontrolwindow)|重設控制項視窗的父系。|
|[COleControl：： ResetStockProps](#resetstockprops)|`COleControl`將股票屬性初始化為其預設值。|
|[COleControl：： ResetVersion](#resetversion)|將版本號碼初始化為指定的值。|
|[COleControl：： ScrollWindow](#scrollwindow)|允許無視窗控制項在顯示畫面上，將區域內的現用影像內的區域滾動。|
|[COleControl：： SelectFontObject](#selectfontobject)|在裝置內容中選取自訂字型屬性。|
|[COleControl：： SelectStockFont](#selectstockfont)|在裝置內容中選取股票字型屬性。|
|[COleControl：： SerializeExtent](#serializeextent)|序列化或初始化控制項的顯示空間。|
|[COleControl：： SerializeStockProps](#serializestockprops)|序列化或初始化內建 `COleControl` 屬性。|
|[COleControl：： SerializeVersion](#serializeversion)|序列化或初始化控制項的版本資訊。|
|[COleControl：： SetAppearance](#setappearance)|設定股票外觀屬性的值。|
|[COleControl：： SetBackColor](#setbackcolor)|設定股票背景色彩屬性的值。|
|[COleControl：： SetBorderStyle](#setborderstyle)|設定 stock BorderStyle 屬性的值。|
|[COleControl：： SetCapture](#setcapture)|使控制項的容器視窗代表控制項擁有滑鼠捕捉。|
|[COleControl：： SetControlSize](#setcontrolsize)|設定 OLE 控制項的位置和大小。|
|[COleControl：： SetEnabled](#setenabled)|設定 stock Enabled 屬性的值。|
|[COleControl：： SetFocus](#setfocus)|讓控制項的容器視窗代表控制項擁有輸入焦點。|
|[COleControl：： SetFont](#setfont)|設定股票字型屬性的值。|
|[COleControl：： SetForeColor](#setforecolor)|設定股票前景屬性的值。|
|[COleControl：： SetInitialSize](#setinitialsize)|設定在容器中第一次顯示 OLE 控制項時的大小。|
|[COleControl：： SetModifiedFlag](#setmodifiedflag)|變更控制項的修改狀態。|
|[COleControl：： SetNotPermitted](#setnotpermitted)|指出編輯要求已失敗。|
|[COleControl：： SetNotSupported](#setnotsupported)|防止使用者修改控制項的屬性值。|
|[COleControl：： SetRectInContainer](#setrectincontainer)|設定控制項相對於其容器的矩形。|
|[COleControl：： SetText](#settext)|設定 stock Text 或 Caption 屬性的值。|
|[COleControl：： ThrowError](#throwerror)|表示 OLE 控制項中發生錯誤。|
|[COleControl：： TransformCoords](#transformcoords)|轉換容器與控制項之間的座標值。|
|[COleControl：： TranslateColor](#translatecolor)|將 OLE_COLOR 值轉換為 COLORRE光圈值。|
|[COleControl：： WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|決定下次載入控制項時，是否可以使用環境屬性。|
|[COleControl：： WindowProc](#windowproc)|提供物件的 Windows 程式 `COleControl` 。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[COleControl：:D rawContent](#drawcontent)|當控制項的外觀需要更新時，由架構呼叫。|
|[COleControl：:D rawMetafile](#drawmetafile)|當使用中繼檔裝置內容時，由架構呼叫。|
|[COleControl：： IsInvokeAllowed](#isinvokeallowed)|啟用 automation 方法調用。|
|[COleControl：： SetInitialDataFormats](#setinitialdataformats)|由架構呼叫以初始化控制項所支援的資料格式清單。|

## <a name="remarks"></a>備註

衍生自 `CWnd` ，這個類別會繼承 Windows 視窗物件的所有功能，再加上 OLE 特有的其他功能，例如事件引發以及支援方法和屬性的功能。

OLE 控制項可以插入至 OLE 容器應用程式，並使用雙向系統的事件引發和將方法和屬性公開給容器來與容器通訊。 請注意，標準 OLE 容器僅支援 OLE 控制項的基本功能。 它們無法支援 OLE 控制項的擴充功能。 當事件因為控制項中發生特定動作而傳送至容器時，就會引發事件。 然後，容器會使用一組公開的方法和屬性（類似于 c + + 類別的成員函式和資料成員），與控制項進行通訊。 這種方法可讓開發人員控制控制項的外觀，並在發生特定動作時通知容器。

## <a name="windowless-controls"></a>無視窗控制項

OLE 控制項可在沒有視窗的情況下使用就地啟用。 無視窗控制項有顯著的優點：

- 無視窗控制項可以是透明的，也不是矩形

- 無視窗控制項減少物件的實例大小和建立時間

控制項不需要視窗。 視窗提供的服務可以透過單一共用視窗輕鬆地提供 (通常是容器的) 和一些分派程式碼。 擁有視窗大多是物件的不必要複雜問題。

使用無視窗啟用時，具有視窗) 的容器 (會負責提供由控制項本身視窗提供的服務。 例如，如果您的控制項需要查詢鍵盤焦點、查詢滑鼠捕捉，或取得裝置內容，則這些作業是由容器所管理。 `COleControl`無視窗操作成員函式會在容器上叫用這些作業。

啟用無視窗啟用時，容器會將輸入訊息委派給控制項的 `IOleInPlaceObjectWindowless` 介面， ([IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) 的延伸模組，以提供無視窗支援) 。 `COleControl`此介面的執行會在適當調整滑鼠座標之後，透過您控制項的訊息對應來分派這些訊息。 您可以藉由將對應的專案加入至訊息對應，來處理這些訊息，例如一般視窗訊息。

在無視窗控制項中，您應該一律使用成員函式， `COleControl` 而不是對應的成員函式 `CWnd` 或其相關的 Windows API 函數。

OLE 控制項物件也可以在啟動時建立一個視窗，但非作用中的作用中轉換所需的工作量會啟動，而轉換的速度也會下降。 在某些情況下，這是一個問題：例如，請考慮使用文字方塊的方格。 在資料行中向上和向下 cursoring 時，每個控制項都必須就地啟用並停用。 非作用中/作用中轉換的速度會直接影響捲動速度。

如需有關開發 OLE 控制項架構的詳細資訊，請參閱 [mfc](../../mfc/mfc-activex-controls.md) activex 控制項和 [總覽：建立 Mfc activex 控制項程式](../../mfc/reference/mfc-activex-control-wizard.md)的文章。 如需優化 OLE 控制項的相關資訊，包括無視窗和無閃爍的控制項，請參閱 [MFC ActiveX 控制項：優化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>規格需求

**標頭：** afxctl.h。h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a> COleControl：： AmbientBackColor

傳回環境背景色彩屬性的值。

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>傳回值

容器的環境背景色彩屬性目前的值（如果有的話）。 如果不支援此屬性，此函數會傳回系統定義的 Windows 背景色彩。

### <a name="remarks"></a>備註

環境背景色彩屬性可供所有控制項使用，而且是由容器定義。 請注意，不需要容器來支援此屬性。

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a> COleControl：： AmbientDisplayName

容器指派給控制項的名稱可以用在向使用者顯示的錯誤訊息中。

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>傳回值

OLE 控制項的名稱。 預設為零長度字串。

### <a name="remarks"></a>備註

請注意，不需要容器來支援此屬性。

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a> COleControl：： AmbientFont

傳回環境字型屬性的值。

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>傳回值

容器的環境字型分派介面指標。 預設值是 NULL。 如果傳回的值不等於 Null，您就必須藉由呼叫其 [IUnknown：： Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) 成員函式來釋放字型。

### <a name="remarks"></a>備註

環境字型屬性是由容器定義，並且可供所有控制項使用。請注意，不需要容器來支援此屬性。

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a> COleControl：： AmbientForeColor

傳回環境前景屬性的值。

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>傳回值

容器的環境前景屬性目前的值（如果有的話）。 如果不支援，此函式會傳回系統定義的 Windows 文字色彩。

### <a name="remarks"></a>備註

環境前景屬性可供所有控制項使用，而且是由容器定義。 請注意，不需要容器來支援此屬性。

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a> COleControl：： AmbientLocaleID

傳回容器的地區設定識別碼。

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>傳回值

容器 LocaleID 屬性的值（如果有的話）。 如果這個屬性不受支援，此函數會傳回0。

### <a name="remarks"></a>備註

控制項可以使用 LocaleID 來調整特定地區設定的使用者介面。 請注意，不需要容器來支援此屬性。

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a> COleControl：： AmbientAppearance

抓取控制項物件目前的外觀設定。

```
short AmbientAppearance();
```

### <a name="return-value"></a>傳回值

控制項的外觀：

- **0** 平面外觀

- **1** 個3d 外觀

### <a name="remarks"></a>備註

呼叫此函式可取得控制項之 DISPID_AMBIENT_APPEARANCE 屬性的目前值。

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a> COleControl：： AmbientScaleUnits

傳回容器所使用的單位類型。

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>傳回值

字串，包含容器的環境 ScaleUnits。 如果不支援這個屬性，此函數會傳回長度為零的字串。

### <a name="remarks"></a>備註

容器的環境 ScaleUnits 屬性可以用來顯示位置或維度（以所選擇的單位標示，例如緹或公分）。 請注意，不需要容器來支援此屬性。

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a> COleControl：： AmbientShowGrabHandles

決定容器是否允許控制項在使用中時，顯示其本身的抓取控制碼。

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>傳回值

如果應該顯示抓取控點，則為非零;否則為0。 如果這個屬性不受支援，此函式會傳回非零值。

### <a name="remarks"></a>備註

請注意，不需要容器來支援此屬性。

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a> COleControl：： AmbientShowHatching

決定當 UI 為使用中時，容器是否允許控制項以影線圖樣顯示本身。

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>傳回值

如果應該顯示影線圖樣，則為非零。否則為0。 如果這個屬性不受支援，此函式會傳回非零值。

### <a name="remarks"></a>備註

請注意，不需要容器來支援此屬性。

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a> COleControl：： AmbientTextAlign

決定控制項容器慣用的環境文字對齊方式。

```
short AmbientTextAlign();
```

### <a name="return-value"></a>傳回值

容器的環境內容對齊屬性的狀態。 如果這個屬性不受支援，此函數會傳回0。

以下是有效傳回值的清單：

|傳回值|意義|
|------------------|-------------|
|0| (數位靠右對齊的一般對齊) 左邊的文字。|
|1|靠左對齊|
|2|Center|
|3|靠右對齊|

### <a name="remarks"></a>備註

這個屬性可供所有內嵌的控制項使用，而且是由容器定義。 請注意，不需要容器來支援此屬性。

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a> COleControl：： AmbientUIDead

判斷容器是否希望控制項回應使用者介面動作。

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>傳回值

如果控制項應該回應使用者介面動作，則為非零。否則為0。 如果這個屬性不受支援，此函數會傳回0。

### <a name="remarks"></a>備註

例如，容器可能會在設計模式中將此設為 TRUE。

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a> COleControl：： AmbientUserMode

判斷容器處於設計模式或使用者模式。

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>傳回值

如果容器處於使用者模式，則為非零。否則，在設計模式中為 0 () 。 如果這個屬性不受支援，此函數會傳回 TRUE。

### <a name="remarks"></a>備註

例如，容器可能會在設計模式中將此設為 FALSE。

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a> COleControl：： BoundPropertyChanged

表示系結的屬性值已變更。

```cpp
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項之系結屬性的分派識別碼。

### <a name="remarks"></a>備註

這必須在每次屬性的值變更時呼叫，即使不是透過屬性集方法進行變更也是如此。 請特別注意對應到成員變數的系結屬性。 任何時候都必須呼叫這類成員變數變更 `BoundPropertyChanged` 。

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a> COleControl：： BoundPropertyRequestEdit

從介面要求許可權 `IPropertyNotifySink` ，以變更控制項所提供的系結屬性值。

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項之系結屬性的分派識別碼。

### <a name="return-value"></a>傳回值

如果允許變更，則為非零;否則為0。 預設值為非零。

### <a name="remarks"></a>備註

如果拒絕許可權，控制項就不能讓屬性值變更。 這可以藉由忽略或失敗嘗試變更屬性值的動作來完成。

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a> COleControl：： ClientToParent

將 *pPoint* 的座標轉譯為父座標。

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
容器內 OLE 控制項界限的指標。 不是工作區，而是整個控制項的區域，包括框線和捲軸。

*pPoint*<br/>
要轉譯成父 (容器) 座標的 OLE 用戶端區域點指標。

### <a name="remarks"></a>備註

在 [輸入 *pPoint* ] 上，相對於控制項) 工作區 (左上角的 OLE 控制項工作區原點。 在輸出 *pPoint* 上，相對於容器) 左上角 (的原點。

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a> COleControl：： ClipCaretRect

如果插入號矩形完全或部分由重迭的不透明物件所涵蓋，則調整它。

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
在輸入上，包含要調整之插入號區域的 [RECT](/windows/win32/api/windef/ns-windef-rect) 結構指標。 在輸出中，已調整的插入號區域，如果完全涵蓋插入號矩形，則為 Null。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

插入號是閃爍的線條、區塊或點陣圖，通常會指出文字或圖形的插入位置。

無視窗物件無法安全地顯示插入號，而不需要先檢查插入點是否已部分或完全隱藏在重迭的物件中。 為了達成此目的，物件可以使用 `ClipCaretRect` 來取得已調整的插入號 (縮減) ，以確保它符合裁剪區域。

建立插入號的物件應該將插入號矩形提交至 `ClipCaretRect` ，並針對插入號使用已調整的矩形。 如果插入號完全隱藏，這個方法會傳回 FALSE，而且在此情況下，不應該完全顯示插入號。

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a> COleControl：： COleControl

建構 `COleControl` 物件。

```
COleControl();
```

### <a name="remarks"></a>備註

通常不會直接呼叫此函數。 相反地，OLE 控制項通常是由其 class factory 所建立。

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a> COleControl：： ControlInfoChanged

當控制項所支援的助憶鍵集合變更時，請呼叫此函式。

```cpp
void ControlInfoChanged();
```

### <a name="remarks"></a>備註

收到此通知時，控制項的容器會呼叫 [IOleControl：： GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)來取得一組新的助憶鍵。 請注意，容器不是回應此通知的必要項。

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a> COleControl：:D isplayError

在處理內建錯誤事件之後由架構呼叫 (除非事件處理常式已抑制錯誤的顯示) 。

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>參數

*scode*<br/>
要報告的狀態碼值。 如需可能程式碼的完整清單，請參閱 [ActiveX 控制項： Advanced 主題](../../mfc/mfc-activex-controls-advanced-topics.md)一文。

*lpszDescription*<br/>
所報告之錯誤的描述。

*lpszSource*<br/>
產生錯誤的模組名稱 (通常是 OLE 控制項模組) 的名稱。

*lpszHelpFile*<br/>
包含錯誤描述的說明檔名稱。

*nHelpID*<br/>
所報告之錯誤的說明內容識別碼。

### <a name="remarks"></a>備註

預設行為會顯示訊息方塊，其中包含包含在 *lpszDescription*中的錯誤描述。

覆寫此函式以自訂錯誤的顯示方式。

## <a name="colecontroldoclick"></a><a name="doclick"></a> COleControl：:D oClick

在控制項上模擬滑鼠點擊動作。

```cpp
void DoClick();
```

### <a name="remarks"></a>備註

將會呼叫可覆寫的成員函式，並會引發內建的 `COleControl::OnClick` Click 事件（如果控制項支援的話）。

基類支援此函式 `COleControl` 作為 stock 方法（稱為 DoClick）。 如需詳細資訊，請參閱 [ActiveX 控制項：方法](../../mfc/mfc-activex-controls-methods.md)。

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a> COleControl：:D oPropExchange

從持續性儲存體標記法（例如資料流程或屬性集）載入或儲存控制項時，由架構呼叫。

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>參數

*pPX*<br/>
`CPropExchange` 物件的指標。 架構會提供此物件來建立屬性交換的內容，包括其方向。

### <a name="remarks"></a>備註

此函數通常會呼叫 **PX_** 系列的函式，以載入或儲存 OLE 控制項的特定使用者定義屬性。

如果已使用 [控制項嚮導] 來建立 OLE 控制項專案，則此函式的覆寫版本將會序列化支援的內建屬性 `COleControl` （base class 函式的呼叫） `COleControl::DoPropExchange` 。 當您將使用者定義的屬性新增至您的 OLE 控制項時，您必須修改此函式以序列化新的屬性。 如需序列化的詳細資訊，請參閱 [ActiveX 控制項：](../../mfc/mfc-activex-controls-serializing.md)序列化一文。

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a> COleControl：:D oSuperclassPaint

重新繪製已從 Windows 控制項子類別化的 OLE 控制項。

```cpp
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>參數

*Pdc*<br/>
控制項容器之裝置內容的指標。

*rcBounds*<br/>
要在其中繪製控制項的區域。

### <a name="remarks"></a>備註

呼叫此函式可適當地處理非使用中的 OLE 控制項的繪製。 只有當 OLE 控制項子類別化 Windows 控制項，而且應該在控制項的函式中呼叫時，才應該使用這個函式 `OnDraw` 。

如需這個函式和子類別化 Windows 控制項的詳細資訊，請參閱 [ActiveX 控制項：子類別化 Windows 控制項一](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)文。

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a> COleControl：:D rawContent

當控制項的外觀需要更新時，由架構呼叫。

```cpp
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>參數

*Pdc*<br/>
裝置內容的指標。

*鋼筋混凝土*<br/>
要在其中繪製的矩形區域。

### <a name="remarks"></a>備註

這個函式會直接呼叫可覆寫的函式 `OnDraw` 。

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a> COleControl：:D rawMetafile

當使用中繼檔裝置內容時，由架構呼叫。

```cpp
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>參數

*Pdc*<br/>
中繼檔裝置內容的指標。

*鋼筋混凝土*<br/>
要在其中繪製的矩形區域。

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a> COleControl：： EnableSimpleFrame

啟用 OLE 控制項的簡單框架特性。

```cpp
void EnableSimpleFrame();
```

### <a name="remarks"></a>備註

此特性可讓控制項支援其他控制項的視覺化內含專案，但不支援真正的 OLE 內含專案。 其中一個範例就是內含數個控制項的群組方塊。 這些控制項不是包含 OLE 的控制項，但它們位於相同的群組方塊中。

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a> COleControl：： ExchangeExtent

將控制項範圍的狀態序列化或初始化 (在 HIMETRIC 單位) 中的維度。

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>參數

*pPX*<br/>
[CPropExchange](../../mfc/reference/cpropexchange-class.md)物件的指標。 架構會提供此物件來建立屬性交換的內容，包括其方向。

### <a name="return-value"></a>傳回值

如果函式成功，則為非零;否則為0。

### <a name="remarks"></a>備註

這個函式通常是由的預設實作為呼叫 `COleControl::DoPropExchange` 。

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a> COleControl：： ExchangeStockProps

序列化或初始化控制項之內建屬性的狀態。

```cpp
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>參數

*pPX*<br/>
[CPropExchange](../../mfc/reference/cpropexchange-class.md)物件的指標。 架構會提供此物件來建立屬性交換的內容，包括其方向。

### <a name="remarks"></a>備註

這個函式通常是由的預設實作為呼叫 `COleControl::DoPropExchange` 。

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a> COleControl：： ExchangeVersion

序列化或初始化控制項版本資訊的狀態。

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>參數

*pPX*<br/>
`CPropExchange` 物件的指標。 架構會提供此物件來建立屬性交換的內容，包括其方向。

*dwVersionDefault*<br/>
控制項目前的版本號碼。

*bConvert*<br/>
指出持續性資料是否應該在儲存時轉換為最新的格式，或是以載入的相同格式進行維護。

### <a name="return-value"></a>傳回值

函數的非零：否則為0。

### <a name="remarks"></a>備註

一般來說，這會是控制項的覆寫所呼叫的第一個函式 `COleControl::DoPropExchange` 。 載入時，此函式會讀取持續性資料的版本號碼，並據以設定 [CPropExchange](../../mfc/reference/cpropexchange-class.md) 物件的 version 屬性。 儲存時，此函數會寫入持續性資料的版本號碼。

如需持續性和版本設定的詳細資訊，請參閱 [ActiveX 控制項：](../../mfc/mfc-activex-controls-serializing.md)序列化一文。

## <a name="colecontrolfireclick"></a><a name="fireclick"></a> COleControl：： FireClick

當滑鼠在現用控制項上按一下時，由架構呼叫。

```cpp
void FireClick();
```

### <a name="remarks"></a>備註

如果這個事件定義為自訂事件，您就會判斷事件的引發時間。

若要自動引發 Click 事件，控制項的事件對應必須定義內建的 Click 事件。

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a> COleControl：： FireDblClick

當滑鼠按兩下現用控制項時，由架構呼叫。

```cpp
void FireDblClick();
```

### <a name="remarks"></a>備註

如果這個事件定義為自訂事件，您就會判斷事件的引發時間。

若要自動引發執行的 DblClick 事件，控制項的事件對應必須定義 stock DblClick 事件。

## <a name="colecontrolfireerror"></a><a name="fireerror"></a> COleControl：： FireError

引發 stock Error 事件。

```cpp
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>參數

*scode*<br/>
要報告的狀態碼值。 如需可能程式碼的完整清單，請參閱 [ActiveX 控制項： Advanced 主題](../../mfc/mfc-activex-controls-advanced-topics.md)一文。

*lpszDescription*<br/>
所報告之錯誤的描述。

*nHelpID*<br/>
所報告錯誤的說明識別碼。

### <a name="remarks"></a>備註

此事件可讓您在程式碼中適當的位置，在您的控制項內發生錯誤。 不同于其他內建事件（例如，按一下或 MouseMove），架構絕對不會引發錯誤。

若要報告屬性取得函數、屬性集函式或 automation 方法期間發生的錯誤，請呼叫 [COleControl：： ThrowError](#throwerror)。

OLE 控制項的 Stock Error 事件的執行會使用 SCODE 值。 如果您的控制項使用此事件，且要用於 Visual Basic 4.0 中，您將會收到錯誤，因為 Visual Basic 不支援 SCODE 值。

若要修正此問題，請手動變更控制項中的 SCODE 參數。ODL 檔案 **`long`** 。 此外，任何使用 SCODE 參數的自訂事件、方法或屬性也會造成相同的問題。

## <a name="colecontrolfireevent"></a><a name="fireevent"></a> COleControl：： FireEvent

從您的控制項引發使用者定義的事件，其中包含任意數目的選擇性引數。

```cpp
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>參數

*dispid*<br/>
要引發之事件的分派識別碼。

*pbParams*<br/>
事件之參數類型的描述項。

### <a name="remarks"></a>備註

通常不應該直接呼叫此函數。 相反地，您會在控制項類別宣告的事件對應區段中呼叫事件引發函式。

*PbParams*引數是**VTS_** 的空格分隔清單。 其中的一或多個值 (以空格分隔，而非逗號) 會指定函式的參數清單。 可能值如下所示：

|符號|參數類型|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE *|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> 已針對所有 variant 型別定義了其他變異常數，但 VTS_FONT 和 VTS_PICTURE 例外，提供 variant 資料常數的指標。 這些常數會使用 VTS_P 慣例來命名 \<CONSTANT-NAME> 。 例如，VTS_PCOLOR 是 VTS_COLOR 常數的指標。

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a> COleControl：： FireKeyDown

當控制項為 UI 作用中，且按下按鍵時由架構呼叫。

```cpp
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>參數

*pnChar*<br/>
已按下之按鍵的虛擬金鑰代碼值指標。 如需標準虛擬金鑰程式碼的清單，請參閱 Winuser。h

*nShiftState*<br/>
包含下列旗標的組合：

- SHIFT_MASK 動作期間按下 SHIFT 鍵的動作。

- CTRL_MASK 在動作期間按下 CTRL 鍵。

- ALT_MASK 在動作期間按下 ALT 鍵。

### <a name="remarks"></a>備註

如果這個事件定義為自訂事件，您就會判斷事件的引發時間。

若要自動引發 KeyDown 事件，控制項的事件對應必須定義股票 KeyDown 事件。

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a> COleControl：： FireKeyPress

當自訂控制項在容器內使用 UI 時，由架構呼叫。

```cpp
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>參數

*pnChar*<br/>
按鍵的字元值指標。

### <a name="remarks"></a>備註

如果這個事件定義為自訂事件，您就會判斷事件的引發時間。

事件的收件者可能會修改 *pnChar*，例如，將所有小寫字元轉換成大寫字元。 如果您想要檢查修改過的字元，請覆寫 `OnKeyPressEvent` 。

若要自動引發 KeyPress 事件，控制項的事件對應必須定義 stock 按鍵事件。

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a> COleControl：： FireKeyUp

當自訂控制項在容器內使用 UI 時，由架構呼叫。

```cpp
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>參數

*pnChar*<br/>
已發行之索引鍵的虛擬金鑰代碼值指標。 如需標準虛擬金鑰程式碼的清單，請參閱 Winuser。h

*nShiftState*<br/>
包含下列旗標的組合：

- SHIFT_MASK 動作期間按下 SHIFT 鍵的動作。

- CTRL_MASK 在動作期間按下 CTRL 鍵。

- ALT_MASK 在動作期間按下 ALT 鍵。

### <a name="remarks"></a>備註

如果這個事件定義為自訂事件，您就會判斷事件的引發時間。

若要自動引發發生的 KeyUp 事件，控制項的事件對應必須定義 stock KeyUp 事件。

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a> COleControl：： FireMouseDown

在使用中的自訂控制項上按下滑鼠按鍵時，由架構呼叫。

```cpp
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>參數

*nButton*<br/>
按下滑鼠按鍵的數位值。 它可以包含下列其中一個值：

- LEFT_BUTTON 按下滑鼠左鍵。

- MIDDLE_BUTTON 按下滑鼠左鍵。

- RIGHT_BUTTON 按下滑鼠右鍵。

*nShiftState*<br/>
包含下列旗標的組合：

- SHIFT_MASK 動作期間按下 SHIFT 鍵的動作。

- CTRL_MASK 在動作期間按下 CTRL 鍵。

- ALT_MASK 在動作期間按下 ALT 鍵。

*x*<br/>
按下滑鼠按鍵時游標的 x 座標。 座標相對於控制項視窗的左上角。

*y*<br/>
按下滑鼠按鍵時游標的 y 座標。 座標相對於控制項視窗的左上角。

### <a name="remarks"></a>備註

如果這個事件定義為自訂事件，您就會判斷事件的引發時間。

若要自動引發 MouseDown 事件發生，控制項的事件對應必須定義 stock MouseDown 事件。

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a> COleControl：： FireMouseMove

當游標移至使用中的自訂控制項上時，由架構呼叫。

```cpp
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>參數

*nButton*<br/>
按下滑鼠按鍵的數位值。 包含下列值的組合：

- LEFT_BUTTON 在動作期間按下滑鼠左鍵。

- MIDDLE_BUTTON 在動作期間按下滑鼠左鍵。

- RIGHT_BUTTON 在動作期間按下滑鼠右鍵。

*nShiftState*<br/>
包含下列旗標的組合：

- SHIFT_MASK 動作期間按下 SHIFT 鍵的動作。

- CTRL_MASK 在動作期間按下 CTRL 鍵。

- ALT_MASK 在動作期間按下 ALT 鍵。

*x*<br/>
資料指標的 x 座標。 座標相對於控制項視窗的左上角。

*y*<br/>
資料指標的 y 座標。 座標相對於控制項視窗的左上角。

### <a name="remarks"></a>備註

如果這個事件定義為自訂事件，您就會判斷事件的引發時間。

若要自動引發 MouseMove 事件，控制項的事件對應必須定義 stock MouseMove 事件。

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a> COleControl：： FireMouseUp

在使用中的自訂控制項上放開滑鼠按鍵時，由架構呼叫。

```cpp
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>參數

*nButton*<br/>
放開滑鼠按鍵的數值。 其值可以是下列其中一個值：

- LEFT_BUTTON 放開滑鼠左鍵。

- MIDDLE_BUTTON 已放開滑鼠中間的按鍵。

- RIGHT_BUTTON 已放開滑鼠右鍵。

*nShiftState*<br/>
包含下列旗標的組合：

- SHIFT_MASK 動作期間按下 SHIFT 鍵的動作。

- CTRL_MASK 在動作期間按下 CTRL 鍵。

- ALT_MASK 在動作期間按下 ALT 鍵。

*x*<br/>
放開滑鼠按鍵時游標的 x 座標。 座標相對於控制項視窗的左上角。

*y*<br/>
當放開滑鼠按鍵時，游標的 y 座標。 座標相對於控制項視窗的左上角。

### <a name="remarks"></a>備註

如果這個事件定義為自訂事件，您就會判斷事件的引發時間。

若要讓 MouseUp 事件發生自動引發，控制項的事件對應必須定義 stock MouseUp 事件。

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a> COleControl：： FireReadyStateChange

使用控制項的就緒狀態目前值來引發事件。

```cpp
void FireReadyStateChange();
```

### <a name="remarks"></a>備註

就緒狀態可以是下列其中一個值：

|名稱|描述|
|-|-|
|READYSTATE_UNINITIALIZED|預設初始化狀態|
|READYSTATE_LOADING|控制項目前正在載入其屬性|
|READYSTATE_LOADED|控制項已初始化|
|READYSTATE_INTERACTIVE|控制項有足夠的資料可進行互動，但尚未載入所有非同步資料|
|READYSTATE_COMPLETE|控制項具有其所有資料|

使用 [GetReadyState](#getreadystate) 來判斷控制項目前的就緒程度。

[InternalSetReadyState](#internalsetreadystate) 會將就緒狀態變更為所提供的值，然後呼叫 `FireReadyStateChange` 。

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a> COleControl：： GetActivationPolicy

改變支援介面之控制項的預設啟用行為 `IPointerInactive` 。

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>傳回值

POINTERINACTIVE 列舉中的旗標組合。 可能的旗標為：

|名稱|描述|
|-|-|
|POINTERINACTIVE_ACTI加值稅EONENTRY|當滑鼠在滑鼠移動作業期間輸入物件時，該物件應該會就地啟用。|
|POINTERINACTIVE_DEACTI加值稅EONLEAVE|在滑鼠移動作業期間，當滑鼠離開物件時，應該停用物件。|
|POINTERINACTIVE_ACTI加值稅EONDRAG|在拖放作業期間，將滑鼠拖曳至該物件時，該物件應就地啟用。|

### <a name="remarks"></a>備註

`IPointerInactive`啟用介面之後，容器會委派 WM_SETCURSOR，並 WM_MOUSEMOVE 訊息傳送給它。 `COleControl`此介面的執行會在適當調整滑鼠座標之後，透過您控制項的訊息對應來分派這些訊息。

每當容器收到 WM_SETCURSOR 或 WM_MOUSEMOVE 訊息時，將滑鼠指標放在支援的非使用中物件上時 `IPointerInactive` ，它應該會 `GetActivationPolicy` 在介面上呼叫，並從 POINTERINACTIVE 列舉傳回旗標。

您可以藉由將對應的專案加入至訊息對應，來處理這些訊息，就像一般的視窗訊息一樣。 在您的處理常式中，請避免使用 `m_hWnd` 成員變數 (或任何使用它) 的成員函式，而不需要先檢查其值是否為非 Null。

任何想要做的物件，都是設定滑鼠游標和/或引發滑鼠移動事件（例如提供特殊的視覺效果意見反應），應傳回 POINTERINACTIVE_ACTI加值稅EONENTRY 旗標，並只在使用中時才繪製意見反應。 如果物件傳回此旗標，容器應該會立即啟用它，然後將它轉送至觸發呼叫的相同訊息 `GetActivationPolicy` 。

如果同時傳回 POINTERINACTIVE_ACTI加值稅EONENTRY 和 POINTERINACTIVE_DEACTI加值稅EONLEAVE 旗標，則只有在滑鼠停留在物件上時，才會啟用物件。 如果只傳回 POINTERINACTIVE_ACTI加值稅EONENTRY 旗標，則只有在滑鼠第一次進入物件時，才會啟用物件。

您也可能想要讓非使用中控制項成為 OLE 拖放作業的目標。 這需要在使用者將物件拖曳到控制項上時啟用控制項，以便將控制項的視窗註冊為放置目標。 若要在拖曳期間引發啟用，請傳回 POINTERINACTIVE_ACTI加值稅EONDRAG 旗標：

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

由所傳達的資訊 `GetActivationPolicy` 不應該由容器快取。 相反地，每次滑鼠進入非使用中的物件時，都應該呼叫這個方法。

如果非作用中的物件不會在滑鼠進入時要求就地啟用，則只要滑鼠指標停留在物件上，它的容器就應該藉由呼叫 [OnInactiveSetCursor](#oninactivesetcursor) ，將後續的 WM_SETCURSOR 訊息分派給這個物件。

啟用 `IPointerInactive` 介面通常表示您希望控制項隨時都能處理滑鼠訊息。 若要在不支援介面的容器中取得這種行為 `IPointerInactive` ，您必須在可見時一律啟用控制項，這表示控制項在其其他旗標之間應該有 OLEMISC_ACTI加值稅EWHENVISIBLE 旗標。 不過，若要防止此旗標在支援的容器中生效 `IPointerInactive` ，您也可以指定 OLEMISC_IGNOREACTI加值稅EWHENVISIBLE 旗標：

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a> COleControl：： GetAmbientProperty

取得容器的環境屬性值。

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>參數

*dwDispid*<br/>
所需環境屬性的分派識別碼。

*vtProp*<br/>
Variant 類型標記，指定要在 *pvProp*中傳回的數值型別。

*pvProp*<br/>
將接收屬性值或傳回值之變數的位址指標。 這個指標的實際型別必須符合 *vtProp*所指定的型別。

|vtProp|PvProp 的類型|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>傳回值

如果支援環境屬性，則為非零。否則為0。

### <a name="remarks"></a>備註

如果您使用 `GetAmbientProperty` 來取出環境 DisplayName 和 ScaleUnits 屬性，請將 *vtProp* 設定為 VT_BSTR，並將 *pvProp* 設定為 `CString*` 。 如果您正在抓取環境字型屬性，請將 *vtProp* 設定為 VT_FONT，並將 *PVPROP* 設定為 LPFONTDISP *。

請注意，已提供通用環境屬性的函式，例如 [AmbientBackColor](#ambientbackcolor) 和 [AmbientFont](#ambientfont)。

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a> COleControl：： GetAppearance

實作為控制項之內建外觀屬性的 Get 函式。

```
short GetAppearance ();
```

### <a name="return-value"></a>傳回值

如果成功，傳回值會將目前的外觀設定指定為 **`short`** (VT_I2) 值。 如果控制項的外觀是平面的，則此值為零，如果控制項的外觀為3D，則為1。

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a> COleControl：： GetBackColor

實作為控制項的庫存背景色彩屬性的 Get 函式。

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>傳回值

如果成功，傳回值會將目前的背景色彩指定為 OLE_COLOR 值。 您可以呼叫，將這個值轉譯為 COLORRE光圈值 `TranslateColor` 。

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a> COleControl：： GetBorderStyle

實作為您控制項之 stock BorderStyle 屬性的 Get 函式。

```
short GetBorderStyle();
```

### <a name="return-value"></a>傳回值

如果控制項具有一般框線，則為1。如果控制項沒有框線，則為0。

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a> COleControl：： GetCapture

判斷物件是否 `COleControl` 具有滑鼠捕捉。

```
CWnd* GetCapture();
```

### <a name="return-value"></a>傳回值

如果控制項已啟動且無視窗，則會傳回 **`this`** 控制項目前是否有滑鼠捕捉 (（由控制項的容器) 決定）; 如果沒有該控制項，則會傳回 Null。

否則，會傳回 `CWnd` 具有滑鼠捕捉 (與) 相同的物件 `CWnd::GetCapture` 。

### <a name="remarks"></a>備註

當呼叫 [SetCapture](#setcapture) 時，啟用的無視窗控制項會收到滑鼠捕捉。

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a> COleControl：： GetClassID

由架構呼叫以取得控制項的 OLE 類別識別碼。

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>參數

*pclsid*<br/>
類別識別碼位置的指標。

### <a name="return-value"></a>傳回值

如果呼叫失敗，則為非零;否則為0。

### <a name="remarks"></a>備註

通常由 [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)所執行。

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a> COleControl：： GetClientOffset

抓取控制項矩形區域左上角和其用戶端區域左上角之間的差異。

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>參數

*pdxOffset*<br/>
OLE 控制項工作區水準位移的指標。

*pdyOffset*<br/>
OLE 控制項工作區之垂直位移的指標。

### <a name="remarks"></a>備註

OLE 控制項在其容器內有一個矩形區域。 控制項的工作區是不含框線和捲軸的控制區。 抓取的位移 `GetClientOffset` 是控制項矩形區域左上角和其工作區左上角之間的差異。 如果您的控制項具有標準框線和捲軸以外的非用戶端元素，請覆寫此成員函式以指定位移。

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a> COleControl：： GetClientRect

抓取控制項工作區的大小。

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*lpRect*<br/>
結構的指標， `RECT` 其中包含無視窗控制項工作區的維度，也就是控制項的大小減去視窗框線、框架、捲軸等等。 *LpRect*參數會指出控制項的用戶端矩形大小，而不是它的位置。

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a> COleControl：： GetClientSite

查詢物件，以取得其容器內其目前用戶端網站的指標。

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>傳回值

控制項在其容器中的目前用戶端網站指標。

### <a name="remarks"></a>備註

傳回的指標會指向的實例 `IOleClientSite` 。 `IOleClientSite`容器所執行的介面是物件的內容視圖：它在檔中錨定的位置，它會取得其儲存空間、使用者介面和其他資源。

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a> COleControl：： GetControlFlags

抓取控制項旗標設定。

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>傳回值

ControlFlags 列舉中的旗標 Or 運算組合：

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>備註

根據預設，`GetControlFlags` 會傳回 `fastBeginPaint | clipPaintDC`。

|名稱|描述|
|-|-|
|`fastBeginPaint`|如果設定，則會使用專為 OLE 控制項量身打造的開始繪製函式，而不是預設的 [BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) API (設定) 。|
|`clipPaintDC`|如果未設定，則會停用對進行的呼叫， `IntersectClipRect` `COleControl` 並獲得較小的速度優勢。 如果您使用無視窗啟用，旗標沒有任何作用。|
|`pointerInactive`|如果設定，則在您的控制項處於非使用中狀態時， `COleControl` 會啟用 `IPointerInactive` 介面（預設為停用），以提供滑鼠互動。|
|`noFlickerActivate`|如果設定，則會排除額外的繪圖作業和伴隨的視覺效果閃爍。 當您的控制項在非作用中和作用中狀態中以相同的方式繪製時使用。 如果您使用無視窗啟用，旗標沒有任何作用。|
|`windowlessActivate`|如果設定，表示您的控制項使用無視窗啟用。|
|`canOptimizeDraw`|如果設定，表示如果容器支援，控制項將會執行優化的繪圖。|

如需 `GetControlFlags` OLE 控制項之和其他優化的詳細資訊，請參閱 [ActiveX 控制項：優化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a> COleControl：： GetControlSize

抓取 OLE 控制項視窗的大小。

```cpp
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>參數

*pcx*<br/>
指定控制項的寬度（以圖元為單位）。

*pcy*<br/>
指定控制項的高度（以圖元為單位）。

### <a name="remarks"></a>備註

請注意，控制項視窗的所有座標都是相對於控制項的左上角。

## <a name="colecontrolgetdc"></a><a name="getdc"></a> COleControl：： GetDC

提供無視窗物件，以從其容器取得螢幕 (或相容的) 裝置內容。

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>參數

*lprcRect*<br/>
在控制項的用戶端座標中，無視窗控制項要重繪的矩形指標。 Null 表示完整物件的範圍。

*dwFlags*<br/>
繪製裝置內容的屬性。 選項包括：

- OLEDC_NODRAW 表示物件不會使用裝置內容來執行任何繪製，而只是取得顯示裝置的相關資訊。 容器應直接傳遞視窗的 DC，而不需要進一步處理。

- OLEDC_PAINTBKGND 要求容器在傳回 DC 之前繪製背景。 如果物件要求 DC 以透明背景重繪區域，則應該使用此旗標。

- OLEDC_OFFSCREEN 會通知容器：物件想要轉譯成螢幕點陣圖，然後複製到螢幕上。 當要執行的繪圖作業產生大量閃爍時，物件應該使用此旗標。 容器可自由接受此要求。 但是，如果未設定此旗標，容器就必須將螢幕上的 DC 取回。 這可讓物件執行直接畫面作業，例如透過 **XOR** 作業) 顯示選取 (。

### <a name="return-value"></a>傳回值

如果成功，則為容器用戶端區域的顯示裝置內容指標 `CWnd` ; 否則，傳回值為 Null。 顯示裝置內容可以用在後續的 GDI 函式中，以在容器視窗的工作區中繪製。

### <a name="remarks"></a>備註

您必須呼叫 [ReleaseDC](#releasedc) 成員函式，以在繪製之後釋放內容。 呼叫時 `GetDC` ，物件會以自己的用戶端座標，將想要繪製的矩形傳遞給它們。 `GetDC` 將這些轉譯成容器工作區的座標。 物件不應要求大於其專屬用戶端區域矩形的所需繪圖矩形，可使用 [GetClientRect](#getclientrect)抓取的大小。 這可防止物件不慎在不應該的地方繪製。

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a> COleControl：： GetEnabled

執行控制項的已啟用庫存屬性的 Get 函數。

```
BOOL GetEnabled();
```

### <a name="return-value"></a>傳回值

如果已啟用控制項，則為非零;否則為0。

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a> COleControl：： GetExtendedControl

取得容器所維護物件的指標，該物件代表具有一組延伸屬性的控制項。

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>傳回值

容器擴充控制項物件的指標。 如果沒有可用的物件，則值為 Null。

這個物件可透過其介面操作 `IDispatch` 。 您也可以使用 `QueryInterface` 來取得物件所提供的其他可用介面。 但是，不需要物件來支援一組特定的介面。 請注意，依賴容器擴充控制物件的特定功能，會限制您的控制項可以移植到其他任意的容器。

### <a name="remarks"></a>備註

呼叫此函式的函式會在完成物件時，負責釋放指標。 請注意，不需要容器來支援此物件。

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a> COleControl：： GetFocus

判斷物件是否 `COleControl` 具有焦點。

```
CWnd* GetFocus();
```

### <a name="return-value"></a>傳回值

如果控制項已啟動且無視窗，則會傳回 **`this`** 控制項目前是否有鍵盤焦點 (由控制項的容器) 決定，如果沒有焦點，則會傳回 Null。

否則，會傳回 `CWnd` 焦點 (與) 相同的物件 `CWnd::GetFocus` 。

### <a name="remarks"></a>備註

當呼叫 [SetFocus](#setfocus) 時，已啟用的無視窗控制項會收到焦點。

## <a name="colecontrolgetfont"></a><a name="getfont"></a> COleControl：： GetFont

實作為 stock 字型屬性的 Get 函式。

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>傳回值

控制項之股票字型屬性的字型分派介面指標。

### <a name="remarks"></a>備註

請注意，呼叫端必須在完成時釋放物件。 在控制項的執行範圍內，使用 `InternalGetFont` 存取控制項的 Stock 字型物件。 如需在控制項中使用字型的詳細資訊，請參閱 [activex 控制項文章：在 Activex 控制項中使用](../../mfc/mfc-activex-controls-using-fonts.md)字型。

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a> COleControl：： GetFontTextMetrics

測量控制項所擁有之任何物件的文字度量 `CFontHolder` 。

```cpp
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>參數

*lptm*<br/>
[TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw)結構的指標。

*fontHolder*<br/>
[CFontHolder](../../mfc/reference/cfontholder-class.md)物件的參考。

### <a name="remarks"></a>備註

您可以使用 [COleControl：： SelectFontObject](#selectfontobject) 函數來選取這類字型。 `GetFontTextMetrics` 會初始化 `TEXTMETRIC` *lptm* 所指向的結構，並在成功時使用與字型相關的有效計量資訊 `fontHolder` ，或以零來填滿結構（如果沒有成功）。 當您繪製控制項時，您應該使用這個函式，而不是 [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) ，因為控制項（例如任何內嵌的 OLE 物件）可能需要將本身轉譯為中繼檔。

`TEXTMETRIC`呼叫[SelectFontObject](#selectfontobject)函數時，會重新整理預設字型的結構。 您應該 `GetFontTextMetrics` 只在選取 [內建字型] 屬性之後呼叫，以確保它所提供的資訊有效。

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a> COleControl：： GetForeColor

實行內建前景屬性的 Get 函數。

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>傳回值

如果成功，傳回值會指定目前的前景色彩做為 OLE_COLOR 值。 您可以呼叫，將這個值轉譯為 [COLORREF](/windows/win32/gdi/colorref) 值 `TranslateColor` 。

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a> COleControl：： GetHwnd

實作為 stock hWnd 屬性的 Get 函式。

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>傳回值

OLE 控制項的視窗控制碼（如果有的話）;否則為 Null。

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a> COleControl：： GetMessageString

由架構呼叫，以取得描述 *nID*所識別之功能表項目用途的簡短字串。

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
功能表項目識別碼。

*rMessage*<br/>
將傳回字串之 [CString](../../atl-mfc-shared/reference/cstringt-class.md) 物件的參考。

### <a name="remarks"></a>備註

這可以用來取得訊息，以便在功能表項目醒目提示時顯示在狀態列中。 預設的執行會嘗試載入由 *nID*識別的字串資源。

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a> COleControl：： GetNotSupported

防止使用者存取控制項的屬性值。

```cpp
void GetNotSupported();
```

### <a name="remarks"></a>備註

呼叫此函式來取代任何屬性的 Get 函式，而不支援控制項使用者的屬性抓取。 其中一個範例是僅寫入的屬性。

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a> COleControl：： GetReadyState

傳回控制項的就緒狀態。

```
long GetReadyState();
```

### <a name="return-value"></a>傳回值

控制項的就緒狀態，下列其中一個值：

|名稱|描述|
|-|-|
|READYSTATE_UNINITIALIZED|預設初始化狀態|
|READYSTATE_LOADING|控制項目前正在載入其屬性|
|READYSTATE_LOADED|控制項已初始化|
|READYSTATE_INTERACTIVE|控制項有足夠的資料可進行互動，但尚未載入所有非同步資料|
|READYSTATE_COMPLETE|控制項具有其所有資料|

### <a name="remarks"></a>備註

大部分的簡單控制項都不需要區分已載入的和互動式。 不過，支援資料路徑屬性的控制項可能尚未準備好進行互動，直到至少以非同步方式接收部分資料為止。 控制項應該會儘快嘗試成為互動式。

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a> COleControl：： GetRectInContainer

取得控制項的矩形相對於容器的座標，以裝置單位表示。

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
矩形結構的指標，該指標會將控制項的座標複製到其中。

### <a name="return-value"></a>傳回值

如果控制項是就地使用，則為非零;否則為0。

### <a name="remarks"></a>備註

只有在控制項為就地使用中時，矩形才有效。

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a> COleControl：： GetStockTextMetrics

測量控制項之內建字型屬性的文字度量（可使用 [SelectStockFont](#selectstockfont) 函式來選取）。

```cpp
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>參數

*lptm*<br/>
[TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw)結構的指標。

### <a name="remarks"></a>備註

`GetStockTextMetrics`如果成功，函式將會初始化 `TEXTMETRIC` *lptm*所指向的結構，如果成功，則以零來填滿結構。 繪製控制項時，請使用此函式，而不是 [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) ，因為控制項（例如任何內嵌的 OLE 物件）可能需要將本身轉譯為中繼檔。

`TEXTMETRIC`呼叫函數時，會重新整理預設字型的結構 `SelectStockFont` 。 只有在選取股票字型之後，才應該呼叫此函式，以確保它所提供的資訊有效。

## <a name="colecontrolgettext"></a><a name="gettext"></a> COleControl：： GetText

實行 stock Text 或 Caption 屬性的 Get 函數。

```
BSTR GetText();
```

### <a name="return-value"></a>傳回值

控制項文字字串的目前值，如果沒有字串，則為零長度的字串。

> [!NOTE]
> 如需 BSTR 資料類型的詳細資訊，請參閱宏和全域區段中的 [資料類型](../../mfc/reference/data-types-mfc.md) 。

### <a name="remarks"></a>備註

請注意，此函式的呼叫端必須 `SysFreeString` 在傳回的字串上呼叫，才能釋放資源。 在控制項的執行範圍內，使用 `InternalGetText` 存取控制項的 Stock Text 或 Caption 屬性。

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a> COleControl：： GetWindowlessDropTarget

`GetWindowlessDropTarget`當您想要讓無視窗控制項成為 OLE 拖放作業的目標時，請覆寫。

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>傳回值

物件之介面的指標 `IDropTarget` 。 由於沒有視窗，無視窗物件無法註冊 `IDropTarget` 介面。 不過，若要參與拖放，無視窗的物件仍可執行介面，並將其傳回 `GetWindowlessDropTarget` 。

### <a name="remarks"></a>備註

通常這會需要將控制項的視窗登錄為置放目標。 但是由於控制項沒有自己的視窗，因此容器會使用它自己的視窗做為放置目標。 控制項只需要提供介面的實作為 `IDropTarget` 容器可在適當時間委派呼叫的介面。 例如：

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a> COleControl：： InitializeIIDs

通知控制項將使用的 Iid 基類。

```cpp
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>參數

*piidPrimary*<br/>
控制項主要分派介面介面識別碼的指標。

*piidEvents*<br/>
控制項之事件介面的介面識別碼指標。

### <a name="remarks"></a>備註

在控制項的函式中呼叫此函式，以通知您的控制項將使用之介面識別碼的基類。

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a> COleControl：： InternalGetFont

存取您控制項的 stock 字型屬性

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>傳回值

包含 stock 字型物件之 [CFontHolder](../../mfc/reference/cfontholder-class.md) 物件的參考。

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a> COleControl：： InternalGetText

存取控制項的 stock Text 或 Caption 屬性。

```
const CString& InternalGetText();
```

### <a name="return-value"></a>傳回值

控制項文字字串的參考。

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a> COleControl：： InternalSetReadyState

設定控制項的就緒狀態。

```cpp
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>參數

*lNewReadyState*<br/>
要為控制項設定的就緒狀態，下列其中一個值：

|名稱|描述|
|-|-|
|READYSTATE_UNINITIALIZED|預設初始化狀態|
|READYSTATE_LOADING|控制項目前正在載入其屬性|
|READYSTATE_LOADED|控制項已初始化|
|READYSTATE_INTERACTIVE|控制項有足夠的資料可進行互動，但尚未載入所有非同步資料|
|READYSTATE_COMPLETE|控制項具有其所有資料|

### <a name="remarks"></a>備註

大部分的簡單控制項都不需要區分已載入的和互動式。 不過，支援資料路徑屬性的控制項可能尚未準備好進行互動，直到至少以非同步方式接收部分資料為止。 控制項應該會儘快嘗試成為互動式。

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a> COleControl：： InvalidateControl

強制控制項自行重繪。

```cpp
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
要使其失效之控制項的區域指標。

*bErase*<br/>
指定在處理更新區域時，是否要清除更新區域內的背景。

### <a name="remarks"></a>備註

如果 *lpRect* 有 Null 值，則會重新繪製整個控制項。 如果 *lpRect* 不是 Null，這表示控制項的矩形部分會失效。 如果控制項沒有視窗，或目前不在使用中，則會忽略矩形，並對用戶端網站的 [IAdviseSink：： OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) 成員函式進行呼叫。 請使用此函式，而不是 `CWnd::InvalidateRect` 或 `InvalidateRect` 。

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a> COleControl：： InvalidateRgn

使容器視窗在指定區域內的工作區失效。

```cpp
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>參數

*pRgn*<br/>
[CRgn](../../mfc/reference/crgn-class.md)物件的指標，該物件會識別要讓 OLE 物件的顯示區域失效（在包含視窗的用戶端座標中）。 如果這個參數是 Null，則範圍是整個物件。

*bErase*<br/>
指定是否要清除失效區域內的背景。 若為 TRUE，則會清除背景。 如果為 FALSE，則背景會維持不變。

### <a name="remarks"></a>備註

這可以用來重繪容器內的無視窗控制項。 傳送下一個 [WM_PAINT](/windows/win32/gdi/wm-paint) 訊息時，會將不正確區域和更新區域中的所有其他區域標記為進行繪製。

如果更新區域的任何部分的 *bErase* 為 TRUE，則會清除整個區域中的背景（而不只是指定的部分）。

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a> COleControl：： IsConvertingVBX

允許 OLE 控制項的特殊載入。

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>傳回值

如果正在轉換控制項，則為非零;否則為0。

### <a name="remarks"></a>備註

將使用 VBX 控制項的表單轉換成一個使用 OLE 控制項的表單時，可能需要 OLE 控制項的特殊載入程式碼。 例如，如果您要載入 OLE 控制項的實例，您可能會呼叫中的 [PX_Font](persistence-of-ole-controls.md#px_font) `DoPropExchange` ：

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

不過，VBX 控制項沒有字型物件;每個字型屬性都是個別儲存的。 在此情況下，您會使用 `IsConvertingVBX` 來區別這兩種情況：

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

另一種情況是，如果您的 VBX 控制項會將專屬的二進位資料 (儲存在其 VBM_SAVEPROPERTY 的訊息處理) 程式中，而您的 OLE 控制項會以不同的格式儲存二進位資料。 如果您想要讓您的 OLE 控制項與 VBX 控制項回溯相容，您可以藉 `IsConvertingVBX` 由區分 VBX 控制項或 OLE 控制項是否正在載入，來使用函式來讀取舊的和新的格式。

在控制項的函式中 `DoPropExchange` ，您可以檢查這個條件，如果是 true，請執行此轉換的特定載入程式碼 (例如先前的範例) 。 如果控制項未轉換，您可以執行一般的載入程式碼。 這項功能僅適用于從 VBX 對應專案轉換的控制項。

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a> COleControl：： IsInvokeAllowed

啟用 automation 方法調用。

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>傳回值

如果控制項已初始化，則為非零;否則為0。

### <a name="remarks"></a>備註

架構的 `IDispatch::Invoke` 呼叫執行 `IsInvokeAllowed` ，以判斷是否可以叫用) 識別的特定函式 (`dispid` 。 OLE 控制項的預設行為是只允許在控制項已初始化時才叫用 automation 方法;不過， `IsInvokeAllowed` 是虛擬函式，而且可以在必要時加以覆寫 (例如，當控制項當做 automation 伺服器) 使用時。

## <a name="colecontrolismodified"></a><a name="ismodified"></a> COleControl：： IsModified

判斷控制項的狀態是否已修改。

```
BOOL IsModified();
```

### <a name="return-value"></a>傳回值

如果控制項的狀態自上次儲存後已經過修改，則為非零。否則為0。

### <a name="remarks"></a>備註

當屬性變更值時，會修改控制項的狀態。

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a> COleControl：： IsOptimizedDraw

判斷容器是否支援目前繪圖作業的優化繪圖。

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>傳回值

如果容器支援目前繪圖作業的優化繪圖，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

如果支援優化繪圖，則在繪製完成時，控制項不需要選取舊物件 (畫筆、筆刷、字型等 ) 至裝置內容。

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a> COleControl：： IsSubclassedControl

由架構呼叫以判斷控制項是否子類別化 Windows 控制項。

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>傳回值

如果控制項是子類別，則為非零。否則為0。

### <a name="remarks"></a>備註

如果您的 OLE 控制項子類別化 Windows 控制項，您必須覆寫這個函式並傳回 TRUE。

## <a name="colecontrolload"></a><a name="load"></a> COleControl：： Load

重設任何先前載入的資料，並起始控制項非同步屬性的新載入。

```cpp
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>參數

*strNewPath*<br/>
字串的指標，其中包含參考非同步控制項屬性之絕對位置的路徑。

*支柱*<br/>
執行非同步控制項屬性的 [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) 物件。

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a> COleControl：： LockInPlaceActive

防止容器停用您的控制項。

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>參數

*塊*<br/>
如果要鎖定控制項的就地作用中狀態，則為 TRUE;如果要解除鎖定，則為 FALSE。

### <a name="return-value"></a>傳回值

如果鎖定成功，則為非零;否則為0。

### <a name="remarks"></a>備註

請注意，在完成時，控制項的每個鎖定都必須與控制項的解除鎖定配對。 您應該只在短時間內鎖定您的控制項，例如在引發事件時。

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a> COleControl：： OnAmbientPropertyChange

當容器的環境屬性變更值時，由架構呼叫。

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>參數

*dispID*<br/>
變更之環境屬性的分派識別碼，如果多個屬性已變更，則為 DISPID_UNKNOWN。

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a> COleControl：： OnAppearanceChanged

當 stock 外觀屬性值變更時，由架構呼叫。

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>備註

如果您想要在此屬性變更之後發出通知，請覆寫此函式。 預設的執行呼叫 `InvalidateControl` 。

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a> COleControl：： OnBackColorChanged

當庫存背景顏色屬性值變更時，由架構呼叫。

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>備註

如果您想要在此屬性變更之後發出通知，請覆寫此函式。 預設的執行呼叫 `InvalidateControl` 。

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a> COleControl：： OnBorderStyleChanged

當 stock BorderStyle 屬性值變更時，由架構呼叫。

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>備註

預設的執行呼叫 `InvalidateControl` 。

如果您想要在此屬性變更之後發出通知，請覆寫此函式。

## <a name="colecontrolonclick"></a><a name="onclick"></a> COleControl：： OnClick

在按下滑鼠按鍵或叫用 DoClick stock 方法時由架構呼叫。

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>參數

*iButton*<br/>
滑鼠按鍵的索引。 可以具有下列其中一個值：

- LEFT_BUTTON 按下滑鼠左鍵。

- MIDDLE_BUTTON 按一下滑鼠左鍵。

- RIGHT_BUTTON 按一下滑鼠右鍵。

### <a name="remarks"></a>備註

預設的執行呼叫 `COleControl::FireClick` 。

覆寫這個成員函式，以修改或擴充預設處理。

## <a name="colecontrolonclose"></a><a name="onclose"></a> COleControl：： OnClose

當容器呼叫控制項的函式時，由架構呼叫 `IOleControl::Close` 。

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>參數

*dwSaveOption*<br/>
指出是否應該在載入前儲存物件的旗標。 有效值為：

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>備註

依預設，會儲存 `OnClose` 控制項物件（如果已修改），且 *dwSaveOption* 為 OLECLOSE_SAVEIFDIRTY 或 OLECLOSE_PROMPTSAVE。

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a> COleControl：： OnDoVerb

當容器呼叫成員函式時，由架構呼叫 `IOleObject::DoVerb` 。

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*iVerb*<br/>
要叫用之控制項動詞的索引。

*lpMsg*<br/>
造成叫用動詞命令的 Windows 訊息指標。

*hWndParent*<br/>
控制項之父視窗的控制碼。 如果執行指令動詞 (或 windows) 建立視窗，則應該使用 *hWndParent* 做為父系。

*lpRect*<br/>
矩形結構的指標，此結構會複製控制項相對於容器的座標。

### <a name="return-value"></a>傳回值

如果呼叫成功，則為非零;否則為0。

### <a name="remarks"></a>備註

預設的執行會使用 ON_OLEVERB 並 ON_STDOLEVERB 訊息對應專案來判斷要叫用的適當函式。

覆寫此函數以變更動詞的預設處理。

## <a name="colecontrolondraw"></a><a name="ondraw"></a> COleControl：： OnDraw

由架構呼叫，以使用指定的裝置內容在指定的周框中繪製 OLE 控制項。

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>參數

*Pdc*<br/>
發生繪圖的裝置內容。

*rcBounds*<br/>
控制項的矩形區域，包括框線。

*rcInvalid*<br/>
無效之控制項的矩形區域。

### <a name="remarks"></a>備註

`OnDraw` 通常會針對螢幕顯示進行呼叫，並將螢幕裝置內容傳遞為 *pDC*。 *RcBounds*參數會識別目標裝置內容中的矩形 (相對於其目前的對應模式) 。 *RcInvalid*參數是不正確實際矩形。 在某些情況下，這會是比 *rcBounds*還小的區域。

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a> COleControl：： OnDrawMetafile

由架構呼叫，以使用指定的中繼檔裝置內容，在指定的周框中繪製 OLE 控制項。

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>參數

*Pdc*<br/>
發生繪圖的裝置內容。

*rcBounds*<br/>
控制項的矩形區域，包括框線。

### <a name="remarks"></a>備註

預設的實值會呼叫 [OnDraw](#ondraw) 函數。

## <a name="colecontrolonedit"></a><a name="onedit"></a> COleControl：： OnEdit

使控制項成為 UI 啟用。

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*lpMsg*<br/>
叫用動詞命令之 Windows 訊息的指標。

*hWndParent*<br/>
控制項之父視窗的控制碼。

*lpRect*<br/>
容器中控制項所使用的矩形指標。

### <a name="return-value"></a>傳回值

如果呼叫成功，則為非零;否則為0。

### <a name="remarks"></a>備註

這與叫用控制項的 OLEIVERB_UIACTI加值稅E 動詞效果相同。

此函數通常用來做為 ON_OLEVERB 訊息對應專案的處理函式。 這會讓控制項的 [物件] 功能表上有 [編輯] 動詞。 例如：

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a> COleControl：： OnEnabledChanged

當啟用庫存屬性值變更時，由架構呼叫。

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>備註

如果您想要在此屬性變更之後發出通知，請覆寫此函式。 預設的執行會呼叫 [InvalidateControl](#invalidatecontrol)。

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a> COleControl：： OnEnumVerbs

當容器呼叫成員函式時，由架構呼叫 `IOleObject::EnumVerbs` 。

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>參數

*ppenumOleVerb*<br/>
`IEnumOLEVERB`列舉控制項動詞的物件指標。

### <a name="return-value"></a>傳回值

如果有可用的動詞，則為非零。否則為0。

### <a name="remarks"></a>備註

預設的實值會列舉訊息對應中的 ON_OLEVERB 專案。

覆寫這個函式以變更列舉動詞命令的預設方式。

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a> COleControl：： OnEventAdvise

當事件處理常式與 OLE 控制項連接或中斷連接時，由架構呼叫。

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>參數

*bAdvise*<br/>
TRUE 表示事件處理常式已連接到控制項。 FALSE 表示事件處理常式已從控制項中斷連接。

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a> COleControl：： OnFontChanged

當 stock 字型屬性值變更時，由架構呼叫。

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>備註

預設的執行呼叫 `COleControl::InvalidateControl` 。 如果控制項將 Windows 控制項子類別化，則預設的執行也會將 WM_SETFONT 訊息傳送至控制項的視窗。

如果您想要在此屬性變更之後發出通知，請覆寫此函式。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a> COleControl：： OnForeColorChanged

當 stock 前景屬性值變更時，由架構呼叫。

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>備註

預設的執行呼叫 `InvalidateControl` 。

如果您想要在此屬性變更之後發出通知，請覆寫此函式。

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a> COleControl：： OnFreezeEvents

由架構在容器呼叫之後呼叫 `IOleControl::FreezeEvents` 。

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>參數

*bFreeze*<br/>
如果控制項的事件處理已凍結，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

預設實作不做任何動作。

如果您想要在事件處理凍結或解除凍結時需要其他行為，請覆寫這個函式。

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a> COleControl：： OnGetColorSet

當容器呼叫成員函式時，由架構呼叫 `IViewObject::GetColorSet` 。

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>參數

*ptd*<br/>
指向應該呈現圖片的目標裝置。 如果這個值是 Null，則應該針對預設目標裝置（通常是顯示裝置）呈現圖片。

*hicTargetDev*<br/>
指定 *ptd*所表示之目標裝置上的資訊內容。 此參數可以是裝置內容，但不一定如此。 如果 *ptd* 為 null，則 *hicTargetDev* 也應為 null。

*ppColorSet*<br/>
要將使用的色彩集合複製到其中的位置指標。 如果函式未傳回色彩集，則會傳回 Null。

### <a name="return-value"></a>傳回值

如果傳回有效的色彩集合，則為非零;否則為0。

### <a name="remarks"></a>備註

容器會呼叫這個函式，以取得繪製 OLE 控制項所需的所有色彩。 容器可以使用與設定整體色彩選擇區所需的色彩一起取得的色彩集合。 預設的實值會傳回 FALSE。

覆寫此函式以進行此要求的任何特殊處理。

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a> COleControl：： OnGetControlInfo

當控制項的容器要求有關控制項的資訊時，由架構呼叫。

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>參數

*pControlInfo*<br/>
要填入之 [CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo) 結構的指標。

### <a name="remarks"></a>備註

這項資訊主要包含控制項的助憶鍵的描述。 預設的執行會以預設資訊填滿 *pControlInfo* 。

如果您的控制項需要處理助憶鍵索引鍵，請覆寫此函式。

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a> COleControl：： OnGetDisplayString

由架構呼叫以取得字串，表示 *dispid*所識別之屬性的目前值。

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項屬性的分派識別碼。

*strValue*<br/>
將傳回字串之 [CString](../../atl-mfc-shared/reference/cstringt-class.md) 物件的參考。

### <a name="return-value"></a>傳回值

如果已在 StrValue 中傳回字串，則為非零 *，否則為* 0。

### <a name="remarks"></a>備註

如果您的控制項具有屬性，其值不能直接轉換成字串，而您想要在容器提供的屬性瀏覽器中顯示內容的值，請覆寫這個函式。

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a> COleControl：： OnGetInPlaceMenu

當控制項啟用 UI 時由架構呼叫，以取得要合併到容器現有功能表的功能表。

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>傳回值

控制項功能表的控制碼; 如果控制項沒有任何控制碼，則為 Null。 預設的實值會傳回 Null。

### <a name="remarks"></a>備註

如需有關合併 OLE 資源的詳細資訊，請參閱 [ (OLE) 的文章功能表和資源 ](../../mfc/menus-and-resources-ole.md)。

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a> COleControl：： OnGetNaturalExtent

由架構呼叫以回應容器的 `IViewObjectEx::GetNaturalExtent` 要求。

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
指定物件要進行表示的方式。 標記法包括內容、圖示、縮圖或列印檔案。 有效的值取自列舉 [>dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 或 DVASPECT2。

*lindex*<br/>
感興趣的物件部分。 目前只有-1 是有效的。

*ptd*<br/>
指向 [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) 結構，此結構定義應傳回物件大小的目標裝置。

*hicTargetDev*<br/>
指定 *ptd* 參數所指定之目標裝置的資訊內容，物件可從中解壓縮裝置計量並測試裝置的功能。 如果 *ptd* 為 Null，則物件應忽略 *hicTargetDev* 參數中的值。

*pExtentInfo*<br/>
指向指定重設 `DVEXTENTINFO` 大小資料的結構。 `DVEXTENTINFO`結構如下：

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

結構成員 `dwExtentMode` 可以採用下列兩個值的其中一個：

- DVEXTENT_CONTENT Inquire 控制項的大小，完全符合內容 (的貼齊大小) 

- 調整規模時 DVEXTENT_INTEGRAL，將建議的大小傳遞給控制項

*psizel*<br/>
指向控制項所傳回的調整大小資料大小。 針對任何未調整的維度，傳回的調整大小資料會設定為-1。

### <a name="return-value"></a>傳回值

如果成功傳回或調整大小，則為非零。否則為0。

### <a name="remarks"></a>備註

覆寫此函式，以傳回最接近結構中所建議大小和範圍模式的物件顯示大小 `DVEXTENTINFO` 。 預設的實值會傳回 FALSE，而不會調整大小。

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a> COleControl：： OnGetPredefinedStrings

由架構呼叫，以取得一組預先定義的字串，代表屬性的可能值。

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項屬性的分派識別碼。

*pStringArray*<br/>
要填入傳回值的字串陣列。

*pCookieArray*<br/>
要填入傳回值的 DWORD 陣列。

### <a name="return-value"></a>傳回值

如果專案已加入至 *pStringArray* 和 *pCookieArray*，則為非零。

### <a name="remarks"></a>備註

如果您的控制項具有具有可由字串表示之可能值集的屬性，則覆寫此函式。 針對新增至 *pStringArray*的每個元素，您應該將對應的 "cookie" 元素加入至 *pCookieArray。* 這些「cookie」值稍後可能會由架構傳遞給函式 `COleControl::OnGetPredefinedValue` 。

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a> COleControl：： OnGetPredefinedValue

由架構呼叫，以取得對應至先前由覆寫所傳回之其中一個預先定義字串的值 `COleControl::OnGetPredefinedStrings` 。

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項屬性的分派識別碼。

*dwCookie*<br/>
覆寫先前所傳回的 cookie 值 `COleControl::OnGetPredefinedStrings` 。

*lpvarOut*<br/>
`VARIANT`將傳回屬性值之結構的指標。

### <a name="return-value"></a>傳回值

如果已在 *lpvarOut*中傳回值，則為非零;否則為0。

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a> COleControl：： OnGetViewExtent

由架構呼叫以回應容器的 [IViewObject2：： GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) 要求。

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>參數

*dwDrawAspect*<br/>
DWORD，描述要顯示物件的表單或外觀。 有效的值取自列舉 [>dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 或 DVASPECT2。

*lindex*<br/>
感興趣的物件部分。 目前只有-1 是有效的。

*ptd*<br/>
指向 [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) 結構，此結構定義應傳回物件大小的目標裝置。

*lpsizel*<br/>
指向傳回物件大小的位置。

### <a name="return-value"></a>傳回值

如果成功傳回範圍資訊，則為非零;否則為0。

### <a name="remarks"></a>備註

如果您的控制項使用雙向繪圖，且其不透明和透明的部分具有不同的維度，則覆寫此函式。

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a> COleControl：： OnGetViewRect

由架構呼叫以回應容器的 `IViewObjectEx::GetRect` 要求。

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
DWORD，描述要顯示物件的表單或外觀。 有效的值取自列舉 [>dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 或 DVASPECT2：

- 整個物件的 DVASPECT_CONTENT 周框。 位於物件原點的左上角，大小等於所傳回的範圍 `GetViewExtent` *。*

- 具有矩形不透明區域的 DVASPECT_OPAQUE 物件會傳回該矩形。 其他失敗。

- 涵蓋所有透明或不規則部分的 DVASPECT_TRANSPARENT 矩形。

*pRect*<br/>
指向 [RECTL](/windows/win32/api/windef/ns-windef-rectl) 結構，指定要在其中繪製物件的矩形。 此參數控制物件的位置和延展。

### <a name="return-value"></a>傳回值

如果成功傳回物件大小的矩形，則為非零;否則為0。

### <a name="remarks"></a>備註

物件的大小會 `OnGetViewRect` 從特定位置開始轉換為矩形 (預設值為顯示) 的左上角。 如果您的控制項使用雙向繪圖，且其不透明和透明的部分具有不同的維度，則覆寫此函式。

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a> COleControl：： OnGetViewStatus

由架構呼叫以回應容器的 `IViewObjectEx::GetViewStatus` 要求。

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>傳回值

如果成功，則為 VIEWSTATUS 列舉的其中一個值;否則為0。 可能的值是下列各項的任意組合：

|名稱|描述|
|-|-|
|VIEWSTATUS_OPAQUE|物件完全不透明。 如果未設定此位，則物件包含透明部分。 這位只適用于內容相關的層面，而不會 DVASPECT_ICON 或 DVASPECT_DOCPRINT。|
|VIEWSTATUS_SOLIDBKGND|物件具有純色背景 (以純色（而非筆刷模式) ）來組成。 只有在設定 VIEWSTATUS_OPAQUE，且僅適用于內容相關的部分，而不是 DVASPECT_ICON 或 DVASPECT_DOCPRINT 時，此位才有意義。|
|VIEWSTATUS_DVASPECTOPAQUE|物件支援 DVASPECT_OPAQUE。 所有採用繪圖外觀做為參數的 IViewObjectEx 方法，都可以使用這個層面來呼叫。|
|VIEWSTATUS_DVASPECTTRANSPARENT|物件支援 DVASPECT_TRANSPARENT。 所有 `IViewObjectEx` 採用繪圖外觀做為參數的方法，都可以使用這個層面來呼叫。|

### <a name="remarks"></a>備註

如果您的控制項使用雙向繪圖，請覆寫此函數。 預設的實值會傳回 VIEWSTATUS_OPAQUE。

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a> COleControl：： OnHideToolBars

當控制項已停用時，由架構呼叫。

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>備註

執行應該會隱藏所顯示的所有工具列 `OnShowToolbars` 。

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a> COleControl：： OnInactiveMouseMove

由容器針對在收到 WM_MOUSEMOVE 訊息時，滑鼠指標下的非使用中物件呼叫。

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
物件周框矩形，在包含視窗的用戶端座標中。 當收到 WM_MOUSEMOVE 訊息時，告知物件其在畫面上的確切位置和大小。

*x*<br/>
在包含視窗的用戶端座標中，滑鼠位置的 x 座標。

*y*<br/>
在包含視窗的用戶端座標中，滑鼠位置的 y 座標。

*dwKeyState*<br/>
識別鍵盤上鍵盤輔助按鍵的目前狀態。 有效的值可以是任何旗標 MK_CONTROL、MK_SHIFT、MK_ALT、MK_BUTTON、MK_LBUTTON、MK_MBUTTON 和 MK_RBUTTON 的組合。

### <a name="remarks"></a>備註

請注意，視窗用戶端座標 (圖元) 用來傳遞滑鼠游標位置。 您也可以在相同的座標系統中傳遞物件的周框，來達成這個目的。

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a> COleControl：： OnInactiveSetCursor

由容器針對在收到 WM_SETCURSOR 訊息時，滑鼠指標下的非使用中物件呼叫。

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
物件周框矩形，在包含視窗的用戶端座標中。 當收到 WM_SETCURSOR 訊息時，告知物件其在畫面上的確切位置和大小。

*x*<br/>
在包含視窗的用戶端座標中，滑鼠位置的 x 座標。

*y*<br/>
在包含視窗的用戶端座標中，滑鼠位置的 y 座標。

*dwMouseMsg*<br/>
發生 WM_SETCURSOR 之滑鼠訊息的識別碼。

*bSetAlways*<br/>
指定物件是否必須設定資料指標。 若為 TRUE，則物件必須設定資料指標;如果為 FALSE，則表示資料指標不是設定資料指標的義務，而且應該在該情況下傳回 S_FALSE。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

請注意，視窗用戶端座標 (圖元) 用來傳遞滑鼠游標位置。 您也可以在相同的座標系統中傳遞物件的周框，來達成這個目的。

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a> COleControl：： OnKeyDownEvent

在處理股票 KeyDown 事件之後，由架構呼叫。

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>參數

*nChar*<br/>
已按下之按鍵的虛擬金鑰代碼值。 如需標準虛擬金鑰程式碼的清單，請參閱 Winuser。h

*nShiftState*<br/>
包含下列旗標的組合：

- SHIFT_MASK 動作期間按下 SHIFT 鍵的動作。

- CTRL_MASK 在動作期間按下 CTRL 鍵。

- ALT_MASK 在動作期間按下 ALT 鍵。

### <a name="remarks"></a>備註

如果您的控制項在引發事件之後需要存取金鑰資訊，請覆寫此函式。

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a> COleControl：： OnKeyPressEvent

在引發 stock KeyPress 事件之後，由架構呼叫。

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>參數

*nChar*<br/>
包含已按下之索引鍵的虛擬機器碼值。 如需標準虛擬金鑰程式碼的清單，請參閱 Winuser。h

### <a name="remarks"></a>備註

請注意，此容器可能已修改 *nChar* 值。

如果您想要在此事件發生之後發出通知，請覆寫此函式。

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a> COleControl：： OnKeyUpEvent

在處理股票 KeyDown 事件之後，由架構呼叫。

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>參數

*nChar*<br/>
已按下之按鍵的虛擬金鑰代碼值。 如需標準虛擬金鑰程式碼的清單，請參閱 Winuser。h

*nShiftState*<br/>
包含下列旗標的組合：

- SHIFT_MASK 動作期間按下 SHIFT 鍵的動作。

- CTRL_MASK 在動作期間按下 CTRL 鍵。

- ALT_MASK 在動作期間按下 ALT 鍵。

### <a name="remarks"></a>備註

如果您的控制項在引發事件之後需要存取金鑰資訊，請覆寫此函式。

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a> COleControl：： OnMapPropertyToPage

由架構呼叫，以取得可執行所指定屬性之編輯之屬性頁的類別識別碼。

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項屬性的分派識別碼。

*lpclsid*<br/>
`CLSID`將傳回類別識別碼之結構的指標。

*pbPageOptional*<br/>
傳回指標，指出是否使用指定的屬性頁為選擇性。

### <a name="return-value"></a>傳回值

如果已在 *lpclsid*中傳回類別識別碼，則為非零;否則為0。

### <a name="remarks"></a>備註

覆寫此函式，以提供從容器的屬性瀏覽器叫用控制項屬性頁的方法。

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a> COleControl：： OnMnemonic

在容器偵測到已按下 OLE 控制項的助憶鍵時，由架構呼叫。

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>參數

*pMsg*<br/>
助憶鍵 (Mnemonic) 按鍵所產生之 Windows 訊息的指標。

## <a name="colecontrolonproperties"></a><a name="onproperties"></a> COleControl：： OnProperties

當容器叫用控制項的屬性動詞時，由架構呼叫。

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*lpMsg*<br/>
叫用動詞命令之 Windows 訊息的指標。

*hWndParent*<br/>
控制項之父視窗的控制碼。

*lpRect*<br/>
容器中控制項所使用的矩形指標。

### <a name="return-value"></a>傳回值

如果呼叫成功，則為非零;否則為0。

### <a name="remarks"></a>備註

預設的執行會顯示模式屬性對話方塊。

您也可以使用此函式來顯示控制項的屬性頁。 對函式進行呼叫 `OnProperties` ，並在 *hWndParent* 參數中傳遞您控制項父系的控制碼。 在此情況下，會忽略 *lpMsg* 和 *lpRect* 參數的值。

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a> COleControl：： OnQueryHitPoint

由架構呼叫以回應容器的 `IViewObjectEx::QueryHitPoint` 要求。

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
指定物件的表示方式。 有效的值取自列舉 [>dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 或 DVASPECT2。

*pRectBounds*<br/>
結構的指標， `RECT` 指定 OLE 控制項工作區的周框。

*ptlLoc*<br/>
結構的指標， `POINT` 指定要檢查點擊的點。 此點是在 OLE 工作區座標中指定。

*lCloseHint*<br/>
將「關閉」定義為已檢查點擊的點距離。

*pHitResult*<br/>
點擊查詢結果的指標。 下列其中一個值：

- HITRESULT_OUTSIDE *ptlLoc* 不在 OLE 物件外部，且不會關閉。

- HITRESULT_TRANSPARENT *ptlLoc* 在 OLE 物件的界限內，但不在接近影像的範圍內。 例如，可以 HITRESULT_TRANSPARENT 透明圓圈中間的某個點。

- HITRESULT_CLOSE *ptlLoc* 是在 OLE 物件內部或外部，但接近要在內部考慮的物件。 小型、精簡或詳細的物件可能會使用此值。 即使某個點超出物件的周框，仍可能會關閉 (這對) 的小型物件而言是必要的。

- HITRESULT_HIT *ptlLoc* 位於物件的影像內。

### <a name="return-value"></a>傳回值

如果成功傳回點擊結果，則為非零;否則為0。 點擊會與 OLE 控制項顯示區域重迭。

### <a name="remarks"></a>備註

查詢物件的顯示矩形是否與給定的點重迭， (觸及點) 。 `QueryHitPoint` 可以覆寫以測試非矩形物件的點擊。

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a> COleControl：： OnQueryHitRect

由架構呼叫以回應容器的 `IViewObjectEx::QueryHitRect` 要求。

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
指定物件要進行表示的方式。 有效的值取自列舉 [>dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 或 DVASPECT2。

*pRectBounds*<br/>
結構的指標， `RECT` 指定 OLE 控制項工作區的周框。

*prcLoc*<br/>
結構的指標， `RECT` 指定要檢查點擊 (是否與物件矩形) 重迭（相對於物件的左上角）。

*lCloseHint*<br/>
未使用。

*pHitResult*<br/>
點擊查詢結果的指標。 下列其中一個值：

- HITRESULT_OUTSIDE OLE 物件未點擊矩形中的任何點。

- HITRESULT_HIT 矩形中至少有一個點會在物件上叫用。

### <a name="return-value"></a>傳回值

如果成功傳回點擊結果，則為非零;否則為0。

### <a name="remarks"></a>備註

查詢物件的顯示矩形是否與給定矩形中的任何點重迭， (點擊矩形) 。 `QueryHitRect` 可以覆寫以測試非矩形物件的點擊。

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a> COleControl：： OnRenderData

由架構呼叫以取得指定格式的資料。

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指向 [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 結構，以指定要求資訊的格式。

*lpStgMedium*<br/>
指向要傳回資料的 [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

指定的格式是先前使用 [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) 或 [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) 成員函式進行延遲轉譯的控制項物件中所放置的格式。 `OnRenderFileData` `OnRenderGlobalData` 如果提供的儲存媒體是檔案或記憶體，此函式的預設執行會分別呼叫或。 如果要求的格式是 CF_METAFILEPICT 或持續性屬性集格式，則預設的執行會轉譯適當的資料，並傳回非零值。 否則，它會傳回0，而且不會執行任何動作。

如果 TYMED_Null *lpStgMedium >的 tymed* ，則應該依照 *lpFormatEtc->tymed*的指定配置和填妥 STGMEDIUM。 如果未 TYMED_Null，就應該將 STGMEDIUM 填入資料。

覆寫此函式，以要求的格式和中的資料提供您的資料。 根據您的資料而定，您可能會想要覆寫此函式的其中一個其他版本。 如果您的資料很小且固定大小，請覆寫 `OnRenderGlobalData` 。 如果您的資料是在檔案中，或屬於變數大小，則覆寫 `OnRenderFileData` 。

如需詳細資訊，請 `FORMATETC` 參閱 `STGMEDIUM` Windows SDK 中的和結構。

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a> COleControl：： OnRenderFileData

當儲存媒體為檔案時，由架構呼叫以取得指定格式的資料。

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指向 [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 結構，以指定要求資訊的格式。

*.Pfile*<br/>
指向要呈現資料的 [CFile](../../mfc/reference/cfile-class.md) 物件。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

先前使用 [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) 成員函式，將指定的格式放在控制項物件中，以進行延遲轉譯。 此函式的預設實作為只會傳回 FALSE。

覆寫此函式，以要求的格式和中的資料提供您的資料。 根據您的資料而定，您可能會想要覆寫此函式的其中一個其他版本。 如果您想要處理多個儲存媒體，請覆寫 `OnRenderData` 。 如果您的資料是在檔案中，或屬於變數大小，則覆寫 `OnRenderFileData` 。

如需詳細資訊，請參閱 `FORMATETC` Windows SDK 中的結構。

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a> COleControl：： OnRenderGlobalData

當指定的儲存媒體為全域記憶體時，由架構呼叫以取得指定格式的資料。

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指向 [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 結構，以指定要求資訊的格式。

*phGlobal*<br/>
指向要傳回資料的全域記憶體控制碼。 如果未配置任何記憶體，這個參數可以是 Null。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

先前使用 [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) 成員函式，將指定的格式放在控制項物件中，以進行延遲轉譯。 此函式的預設實作為只會傳回 FALSE。

如果 *phGlobal* 為 Null，則應該在 *phGlobal*中配置並傳回新的 HGLOBAL。 否則， *phGlobal* 所指定的 HGLOBAL 應該會填入資料。 放在 HGLOBAL 中的資料量不能超過記憶體區塊的目前大小。 此外，區塊無法重新配置為較大的大小。

覆寫此函式，以要求的格式和中的資料提供您的資料。 根據您的資料而定，您可能會想要覆寫此函式的其中一個其他版本。 如果您想要處理多個儲存媒體，請覆寫 `OnRenderData` 。 如果您的資料是在檔案中，或屬於變數大小，則覆寫 `OnRenderFileData` 。

如需詳細資訊，請參閱 `FORMATETC` Windows SDK 中的結構。

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a> COleControl：： OnResetState

當控制項的屬性應該設定為預設值時，由架構呼叫。

```
virtual void OnResetState();
```

### <a name="remarks"></a>備註

預設的實值會呼叫 [DoPropExchange](#dopropexchange)，並傳遞 `CPropExchange` 導致屬性設定為其預設值的物件。

控制項寫入器可以在這個可覆寫的中插入 OLE 控制項的初始化程式碼。 這個函式會在 [IPersistStream：： load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) 或 [IPersistStorage：： load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) 失敗時呼叫，或 [IPersistStreamInit：： InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) 或 [IPersistStorage：： InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) 呼叫，而不需要先呼叫 `IPersistStream::Load` 或 `IPersistStorage::Load` 。

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a> COleControl：： OnSetClientSite

當容器呼叫控制項的函式時，由架構呼叫 `IOleControl::SetClientSite` 。

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>備註

根據預設， `OnSetClientSite` 會檢查是否已載入資料路徑屬性，如果是，則會呼叫 `DoDataPathPropExchange` 。

覆寫此函式以進行此通知的任何特殊處理。 尤其是，此函式的覆寫應該呼叫基類。

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a> COleControl：： OnSetData

由架構呼叫，以指定的資料取代控制項的資料。

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)結構的指標，指定資料的格式。

*lpStgMedium*<br/>
資料所在之 [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) 結構的指標。

*bRelease*<br/>
如果控制項應該釋放儲存媒體，則為 TRUE;如果控制項不應釋放儲存媒體，則為 FALSE。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果資料是持續性屬性集格式，則預設的執行會據以修改控制項的狀態。 否則，預設的執行不會執行任何動作。 如果 *bRelease* 為 TRUE，則會進行對的呼叫， `ReleaseStgMedium` 否則為。

覆寫此函數，以指定的資料取代控制項的資料。

如需詳細資訊，請 `FORMATETC` 參閱 `STGMEDIUM` Windows SDK 中的和結構。

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a> COleControl：： OnSetExtent

當控制項的範圍因呼叫 [IOleObject：： SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent)而需要變更時，由架構呼叫。

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>參數

*lpSizeL*<br/>
結構的指標，該 `SIZEL` 結構使用長整數來代表控制項的寬度和高度，以 HIMETRIC 單位表示。

### <a name="return-value"></a>傳回值

如果已接受大小變更，則為非零;否則為0。

### <a name="remarks"></a>備註

預設的執行會處理控制項範圍的大小調整。 如果控制項是就地使用中的，則會對容器 `OnPosRectChanged` 進行呼叫。

覆寫這個函式以變更控制項的預設大小。

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a> COleControl：： OnSetObjectRects

由架構呼叫以執行 [IOleInPlaceObject：： SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)的呼叫。

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>參數

*lpRectPos*<br/>
結構的指標 `RECT` ，指出控制項的新位置和相對於容器的大小。

*lpRectClip*<br/>
結構的指標 `RECT` ，指出要裁剪控制項的矩形區域。

### <a name="return-value"></a>傳回值

如果已接受重定位，則為非零。否則為0。

### <a name="remarks"></a>備註

預設的執行會自動處理控制項視窗的重新置放和調整大小，並傳回 TRUE。

覆寫這個函式以改變此函式的預設行為。

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a> COleControl：： OnShowToolBars

在控制項已啟用 UI 時由架構呼叫。

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>備註

預設實作不做任何動作。

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a> COleControl：： OnTextChanged

當股票標題或文字屬性值變更時，由架構呼叫。

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>備註

預設的執行呼叫 `InvalidateControl` 。

如果您想要在此屬性變更之後發出通知，請覆寫此函式。

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a> COleControl：： OnWindowlessMessage

由架構呼叫以回應容器的 `IOleInPlaceObjectWindowless::OnWindowMessage` 要求。

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>參數

*msg*<br/>
Windows 傳遞的訊息識別碼。

*wParam*<br/>
由 Windows 傳遞。 指定其他訊息特定的資訊。 此參數的內容取決於 *msg* 參數的值。

*lParam*<br/>
由 Windows 傳遞。 指定其他訊息特定的資訊。 此參數的內容取決於 *msg* 參數的值。

*plResult*<br/>
Windows 結果碼。 指定訊息處理的結果，並視傳送的訊息而定。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

處理無視窗控制項的視窗訊息。 `COleControl``OnWindowlessMessage`應該用於滑鼠訊息和鍵盤訊息以外的視窗訊息。 `COleControl` 提供 [SetCapture](#setcapture) 和 [SetFocus](#setfocus) ，專門用來取得無視窗 OLE 物件的滑鼠捕捉和鍵盤焦點。

因為無視窗物件沒有視窗，所以需要有一個機制，讓容器將訊息分派給它們。 無視窗的 OLE 物件會從其容器取得訊息， `OnWindowMessage` 方法是透過介面上的方法 `IOleInPlaceObjectWindowless` ([IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) 的延伸模組，以提供無視窗支援) 。 `OnWindowMessage` 不採用 `HWND` 參數。

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a> COleControl：:P arentToClient

將 *pPoint* 的座標轉譯為用戶端座標。

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
容器內 OLE 控制項界限的指標。 不是工作區，而是整個控制項的區域，包括框線和捲軸。

*pPoint*<br/>
父 (容器的指標) 指向要轉譯成控制項工作區座標的位置。

*bHitTest*<br/>
指定是否要在點上進行點擊測試。

### <a name="return-value"></a>傳回值

如果 *bHitTest* 為 FALSE，則會傳回 HTNOWHERE。 如果 *bHitTest* 為 TRUE，則會傳回父 (容器在 OLE 控制項工作區中) 點進入的位置，而這是下列其中一個滑鼠點擊測試值：

- 在沒有調整大小框線的視窗框線中 HTBORDER。

- 在視窗的下方水準框線中 HTBOTTOM。

- HTBOTTOMLEFT 在視窗框線的左下角。

- HTBOTTOMRIGHT 在視窗框線的右下角。

- 在標題列區域中 HTCAPTION。

- 在工作區中 HTCLIENT。

- 在螢幕背景上或 windows (與 HTNOWHERE 之間的分隔線上 HTERROR，不同的是， `DefWndProc` windows 函式會產生系統嗶聲，指出) 錯誤。

- HTGROWBOX 在 [大小] 方塊中。

- 水準捲軸中的 HTHSCROLL。

- 視窗左邊框線中的 HTLEFT。

- 在 [最大化] 按鈕中 HTMAXBUTTON。

- 在功能表區域中 HTMENU。

- 在 [最小化] 按鈕中 HTMINBUTTON。

- HTNOWHERE 螢幕背景或視窗之間的分隔線。

- 在 [最小化] 按鈕中 HTREDUCE。

- 視窗右框線中的 HTRIGHT。

- HTSIZE 在 [大小] 方塊 (與 HTGROWBOX) 相同。

- 在 [控制] 功能表中，或在子視窗的 [關閉] 按鈕中 HTSYSMENU。

- 在視窗的上水準框線中 HTTOP。

- HTTOPLEFT 在視窗框線的左上角。

- HTTOPRIGHT 在視窗框線的右上角。

- HTTRANSPARENT 目前另一個視窗所涵蓋的視窗。

- 垂直捲動條中的 HTVSCROLL。

- 在 [最大化] 按鈕中 HTZOOM。

### <a name="remarks"></a>備註

在 [輸入 *pPoint* ] 上，相對於容器) 左上角的父系 (的原點。 在 [輸出] *pPoint* 上，相對於控制項) 工作區 (左上角的 OLE 控制項工作區原點。

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a> COleControl：:P ostModalDialog

通知容器已關閉強制回應對話方塊。

```cpp
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>參數

*hWndParent*<br/>
強制回應對話方塊之父視窗的控制碼。

### <a name="remarks"></a>備註

在顯示任何強制回應對話方塊之後，呼叫此函式。 您必須呼叫此函式，讓容器可以啟用所停用的任何最上層視窗 `PreModalDialog` 。 此函數應該與的呼叫配對 `PreModalDialog` 。

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a> COleControl：:P reModalDialog

通知容器要顯示模式對話方塊。

```cpp
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>參數

*hWndParent*<br/>
強制回應對話方塊之父視窗的控制碼。

### <a name="remarks"></a>備註

在顯示任何強制回應對話方塊之前，請先呼叫此函式。 您必須呼叫此函式，讓容器可以停用其所有最上層視窗。 在顯示模式對話方塊之後，您必須呼叫 `PostModalDialog` 。

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a> COleControl：： RecreateControlWindow

終結並重新建立控制項的視窗。

```cpp
void RecreateControlWindow();
```

### <a name="remarks"></a>備註

如果您需要變更視窗的樣式位，這可能是必要的。

## <a name="colecontrolrefresh"></a><a name="refresh"></a> COleControl：： Refresh

強制重新繪製 OLE 控制項。

```cpp
void Refresh();
```

### <a name="remarks"></a>備註

基類支援此函式 `COleControl` 作為 stock 方法，稱為 Refresh。 這可讓您的 OLE 控制項的使用者在特定時間重新繪製控制項。 如需此方法的詳細資訊，請參閱 [ActiveX 控制項：方法](../../mfc/mfc-activex-controls-methods.md)。

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a> COleControl：： ReleaseCapture

釋放滑鼠捕捉。

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果控制項目前有滑鼠捕捉，則會釋放 capture。 否則，此函數不會有任何作用。

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a> COleControl：： ReleaseDC

釋出無視窗控制項容器的顯示裝置內容，釋放裝置內容以供其他應用程式使用。

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>參數

*Pdc*<br/>
識別要釋放的容器裝置內容。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

應用程式必須呼叫 `ReleaseDC` [GetDC](#getdc)的每個呼叫。

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a> COleControl：： ReparentControlWindow

設定控制項的父系。

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>參數

*hWndOuter*<br/>
控制項視窗的控點。

*hWndParent*<br/>
新父視窗的控制碼。

### <a name="remarks"></a>備註

呼叫此函式可重設控制項視窗的父系。

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a> COleControl：： ResetStockProps

將股票屬性的狀態初始化 `COleControl` 為其預設值。

```cpp
void ResetStockProps();
```

### <a name="remarks"></a>備註

屬性為：外觀、背景色彩、BorderStyle、標題、已啟用、字型、前景、hWnd 和文字。 如需股票屬性的描述，請參閱 [ActiveX 控制項：加入](../../mfc/mfc-activex-controls-adding-stock-properties.md)內建屬性。

您可以使用和覆寫來改善控制項的二進位初始化效能 `ResetStockProps` `ResetVersion` `COleControl::OnResetState` 。 請參閱下方的範例。 如需優化初始化的詳細資訊，請參閱 [ActiveX 控制項：優化](../../mfc/mfc-activex-controls-optimization.md)。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a> COleControl：： ResetVersion

將版本號碼初始化為指定的值。

```cpp
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>參數

*dwVersionDefault*<br/>
要指派給控制項的版本號碼。

### <a name="remarks"></a>備註

您可以使用和覆寫來改善控制項的二進位初始化效能 `ResetVersion` `ResetStockProps` `COleControl::OnResetState` 。 請參閱 [ResetStockProps](#resetstockprops)的範例。 如需優化初始化的詳細資訊，請參閱 [ActiveX 控制項：優化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a> COleControl：： ScrollWindow

允許無視窗的 OLE 物件在螢幕上的就地活動影像中，將區域滾動。

```cpp
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>參數

*xAmount*<br/>
指定水準滾動的數量（以裝置單位為單位）。 此參數必須是負數值，才能向左移動。

*yAmount*<br/>
指定垂直捲動的數量（以裝置單位為單位）。 此參數必須是負數值，才能向上移動。

*lpRect*<br/>
指向 [CRect](../../atl-mfc-shared/reference/crect-class.md) 物件或 RECT 結構，此結構會指定要滾動的 OLE 物件工作區的部分（在包含視窗的用戶端座標中）。 如果 *lpRect* 為 Null，則會滾動整個 OLE 物件的工作區。

*lpClipRect*<br/>
指向 `CRect` 物件或 `RECT` 結構，以指定要裁剪的矩形。 只會滾動矩形內的圖元。 矩形外的位即使在 *lpRect* 矩形中也不會受到影響。 如果 *lpClipRect* 為 Null，則不會在捲軸矩形上執行裁剪。

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a> COleControl：： SelectFontObject

在裝置內容中選取字型。

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>參數

*Pdc*<br/>
裝置內容物件的指標。

*fontHolder*<br/>
[CFontHolder](../../mfc/reference/cfontholder-class.md)物件的參考，代表要選取的字型。

### <a name="return-value"></a>傳回值

先前選取之字型的指標。 當呼叫端完成所有使用 FontHolder 的繪圖作業時 *，* 應該將先前選取的字型以參數形式傳遞給 [CDC：： SelectObject](../../mfc/reference/cdc-class.md#selectobject)。

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a> COleControl：： SelectStockFont

在裝置內容中選取股票字型屬性。

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>參數

*Pdc*<br/>
將在其中選取字型的裝置內容。

### <a name="return-value"></a>傳回值

先前選取之物件的指標 `CFont` 。 當您完成時，您應該使用 [CDC：： SelectObject](../../mfc/reference/cdc-class.md#selectobject) ，將此字型選取回裝置內容。

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a> COleControl：： SerializeExtent

序列化或初始化配置給控制項之顯示空間的狀態。

```cpp
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>參數

*Ar*<br/>
要 `CArchive` 序列化的物件。

### <a name="remarks"></a>備註

您可以使用 `SerializeExtent` 、 `SerializeStockProps` 和覆 `SerializeVersion` 寫來改善控制項的二進位持續性效能 `COleControl::Serialize` 。 請參閱下方的範例。 如需優化初始化的詳細資訊，請參閱 [ActiveX 控制項：優化](../../mfc/mfc-activex-controls-optimization.md)。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a> COleControl：： SerializeStockProps

序列化或初始化內建屬性的狀態 `COleControl` ：外觀、背景色彩、BorderStyle、標題、已啟用、字型、前景和文字。

```cpp
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>參數

*Ar*<br/>
要 `CArchive` 序列化的物件。

### <a name="remarks"></a>備註

如需股票屬性的描述，請參閱 [ActiveX 控制項：加入](../../mfc/mfc-activex-controls-adding-stock-properties.md)內建屬性。

您可以使用 `SerializeStockProps` 、 `SerializeExtent` 和覆 `SerializeVersion` 寫來改善控制項的二進位持續性效能 `COleControl::Serialize` 。 如需範例，請參閱 [SerializeExtent](#serializeextent)中的程式碼。 如需優化初始化的詳細資訊，請參閱 [ActiveX 控制項：優化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a> COleControl：： SerializeVersion

序列化或初始化控制項版本資訊的狀態。

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>參數

*Ar*<br/>
要 `CArchive` 序列化的物件。

*dwVersionDefault*<br/>
控制項目前的版本號碼。

*bConvert*<br/>
指出持續性資料是否應該在儲存時轉換為最新的格式，或是以載入時所用的相同格式進行維護。

### <a name="return-value"></a>傳回值

控制項的版本號碼。 如果指定的封存正在載入，則會傳回 `SerializeVersion` 從該封存載入的版本。 否則，它會傳回目前載入的版本。

### <a name="remarks"></a>備註

您可以使用 `SerializeVersion` 、 `SerializeExtent` 和覆 `SerializeStockProps` 寫來改善控制項的二進位持續性效能 `COleControl::Serialize` 。 如需範例，請參閱 [SerializeExtent](#serializeextent)中的程式碼。 如需優化初始化的詳細資訊，請參閱 [ActiveX 控制項：優化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a> COleControl：： SetAppearance

設定控制項的存貨外觀屬性值。

```cpp
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>參數

*sAppearance*<br/>
**`short`** 要用於控制面板的 (VT_I2) 值。 值為零會將控制項的外觀設定為平面，值為1會將控制項的外觀設定為3D。

### <a name="remarks"></a>備註

如需股票屬性的詳細資訊，請參閱 [ActiveX 控制項：屬性](../../mfc/mfc-activex-controls-properties.md)。

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a> COleControl：： SetBackColor

設定控制項的庫存背景色彩屬性值。

```cpp
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>參數

*dwBackColor*<br/>
要用於控制項背景繪圖的 OLE_COLOR 值。

### <a name="remarks"></a>備註

如需使用此屬性和其他相關屬性的詳細資訊，請參閱 [ActiveX 控制項：屬性](../../mfc/mfc-activex-controls-properties.md)（property）一文。

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a> COleControl：： SetBorderStyle

設定控制項的 stock BorderStyle 屬性值。

```cpp
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>參數

*sBorderStyle*<br/>
控制項的新框線樣式;0表示沒有框線，1表示標準框線。

### <a name="remarks"></a>備註

然後會重新建立並呼叫控制項視窗 `OnBorderStyleChanged` 。

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a> COleControl：： SetCapture

使控制項的容器視窗代表控制項擁有滑鼠捕捉。

```
CWnd* SetCapture();
```

### <a name="return-value"></a>傳回值

`CWnd`先前收到滑鼠輸入之 window 物件的指標。

### <a name="remarks"></a>備註

如果控制項已啟用且無視窗，此函式會代表控制項的容器視窗擁有滑鼠捕捉。 否則，此函式會讓控制項本身擁有滑鼠捕捉 (與 `CWnd::SetCapture`) 相同。

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a> COleControl：： SetControlSize

設定 OLE 控制項視窗的大小，並通知控制項網站正在變更的容器。

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>參數

*殘雪*<br/>
指定控制項的新寬度（以圖元為單位）。

*cy*<br/>
指定控制項的新高度（以圖元為單位）。

### <a name="return-value"></a>傳回值

如果呼叫成功，則為非零;否則為0。

### <a name="remarks"></a>備註

這個函式不應該用在控制項的函式中。

請注意，控制項視窗的所有座標都是相對於控制項的左上角。

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a> COleControl：： SetEnabled

設定控制項的已啟用庫存屬性值。

```cpp
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>參數

*bEnabled*<br/>
如果要啟用控制項，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

設定這個屬性之後， `OnEnabledChange` 會呼叫。

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a> COleControl：： SetFocus

讓控制項的容器視窗代表控制項擁有輸入焦點。

```
CWnd* SetFocus();
```

### <a name="return-value"></a>傳回值

`CWnd`先前具有輸入焦點之 window 物件的指標，如果沒有這類視窗，則為 Null。

### <a name="remarks"></a>備註

如果控制項已啟動且無視窗，此函式會代表控制項的容器視窗取得輸入焦點。 輸入焦點會將鍵盤輸入導向容器的視窗，而容器會將所有後續的鍵盤訊息分派至呼叫的 OLE 物件 `SetFocus` 。 任何先前具有輸入焦點的視窗都會失去它。

如果控制項不是無視窗，此函式會讓控制項本身擁有輸入焦點 (與 `CWnd::SetFocus`) 相同。

## <a name="colecontrolsetfont"></a><a name="setfont"></a> COleControl：： SetFont

設定控制項的 stock 字型屬性。

```cpp
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>參數

*pFontDisp*<br/>
字型分派介面的指標。

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a> COleControl：： SetForeColor

設定控制項的存貨前景屬性值。

```cpp
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>參數

*dwForeColor*<br/>
要用於控制項前景繪圖的 OLE_COLOR 值。

### <a name="remarks"></a>備註

如需使用此屬性和其他相關屬性的詳細資訊，請參閱 [ActiveX 控制項：屬性](../../mfc/mfc-activex-controls-properties.md)（property）一文。

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a> COleControl：： SetInitialDataFormats

由架構呼叫以初始化控制項所支援的資料格式清單。

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>備註

預設的實值會指定兩種格式： CF_METAFILEPICT 和持續性屬性集。

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a> COleControl：： SetInitialSize

設定在容器中第一次顯示 OLE 控制項時的大小。

```cpp
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>參數

*殘雪*<br/>
OLE 控制項的初始寬度（以圖元為單位）。

*cy*<br/>
OLE 控制項的初始高度（以圖元為單位）。

### <a name="remarks"></a>備註

在您的函式中呼叫此函式，以設定控制項的初始大小。 初始大小是以裝置單位或圖元來測量。 建議您在控制項的函式中進行此呼叫。

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a> COleControl：： SetModifiedFlag

變更控制項的修改狀態。

```cpp
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>參數

*bModified*<br/>
控制項修改旗標的新值。 TRUE 表示控制項的狀態已修改;FALSE 表示控制項的狀態剛剛已儲存。

### <a name="remarks"></a>備註

每當發生會影響控制項持續性狀態的變更時，呼叫此函式。 例如，如果持續性屬性的值變更，請使用 *bModified* **TRUE**來呼叫這個函式。

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a> COleControl：： SetNotPermitted

指出編輯要求已失敗。

```cpp
void SetNotPermitted();
```

### <a name="remarks"></a>備註

在失敗時呼叫此函式 `BoundPropertyRequestEdit` 。 此函式會擲回類型的例外狀況， `COleDispScodeException` 表示不允許設定作業。

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a> COleControl：： SetNotSupported

防止使用者修改控制項的屬性值。

```cpp
void SetNotSupported();
```

### <a name="remarks"></a>備註

呼叫此函式來取代任何屬性的集合函式，而不支援修改控制項使用者的屬性值。 其中一個範例是唯讀的屬性。

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a> COleControl：： SetRectInContainer

設定控制項的矩形相對於容器的座標，以裝置單位表示。

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
矩形的指標，其中包含控制項相對於容器的新座標。

### <a name="return-value"></a>傳回值

如果呼叫成功，則為非零;否則為0。

### <a name="remarks"></a>備註

如果控制項已開啟，則會調整大小;否則會呼叫容器的函式 `OnPosRectChanged` 。

## <a name="colecontrolsettext"></a><a name="settext"></a> COleControl：： SetText

設定您的控制項股票標題或文字屬性的值。

```cpp
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>參數

*pszText*<br/>
字元字串的指標。

### <a name="remarks"></a>備註

請注意，股票標題和文字屬性都對應到相同的值。 這表示對任一個屬性所做的任何變更都會自動變更這兩個屬性。 一般而言，控制項應該支援股票字幕或文字屬性，但不能同時支援兩者。

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a> COleControl：： ThrowError

表示您的控制項發生錯誤。

```cpp
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>參數

*Sc*<br/>
要報告的狀態碼值。 如需可能程式碼的完整清單，請參閱 [ActiveX 控制項： Advanced 主題](../../mfc/mfc-activex-controls-advanced-topics.md)一文。

*nDescriptionID*<br/>
要報告之例外狀況的字串資源識別碼。

*nHelpID*<br/>
要報告之主題的說明識別碼。

*pszDescription*<br/>
字串，其中包含要報告之例外狀況的說明。

### <a name="remarks"></a>備註

這個函式應該只在 OLE 屬性的 Get 或 Set 函式中呼叫，或是在 OLE automation 方法的執行中呼叫。 如果您需要通知發生于其他時間的錯誤，您應該引發 stock Error 事件。

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a> COleControl：： TransformCoords

轉換 HIMETRIC 單位與容器原生單位之間的座標值。

```cpp
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>參數

*lpptlHimetric*<br/>
結構的指標，該 `POINTL` 結構包含 HIMETRIC 單位中的座標。

*lpptfContainer*<br/>
結構的指標， `POINTF` 該結構包含容器單位大小的座標。

*flags*<br/>
下列值的組合：

- XFORMCOORDS_POSITION 容器中的位置。

- XFORMCOORDS_SIZE 容器中的大小。

- XFORMCOORDS_HIMETRICTOCONTAINER 將 HIMETRIC 單位轉換為容器的單位。

- XFORMCOORDS_CONTAINERTOHIMETRIC 將容器的單位轉換成 HIMETRIC 單位。

### <a name="remarks"></a>備註

前兩個旗標（XFORMCOORDS_POSITION 和 XFORMCOORDS_SIZE）指出座標是否應視為位置或大小。 其餘的兩個旗標表示轉換的方向。

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a> COleControl：： TranslateColor

將 OLE_COLOR 資料類型的色彩值轉換成 [COLORREF](/windows/win32/gdi/colorref) 資料類型。

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>參數

*clrColor*<br/>
OLE_COLOR 資料類型。 如需詳細資訊，請參閱 Windows [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor) 函數。

*hpal*<br/>
選用元件的控制碼;可以是 Null。

### <a name="return-value"></a>傳回值

RGB (紅色、綠色、藍色) 32 位色彩值，其定義最接近裝置可代表之 *clrColor* 值的純色。

### <a name="remarks"></a>備註

此函數有助於將股票前景和背景色彩屬性轉譯為 [CDC](../../mfc/reference/cdc-class.md) 成員函式所使用的 COLORREF 類型。

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a> COleControl：： WillAmbientsBeValidDuringLoad

判斷您的控制項是否應該使用環境屬性的值做為預設值（當它之後從其持續性狀態載入時）。

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>傳回值

非零表示環境屬性將有效;否則環境屬性將無效。

### <a name="remarks"></a>備註

在某些容器中，您的控制項在的覆寫初始呼叫期間，可能無法存取其環境屬性 `COleControl::DoPropExchange` 。 如果容器在呼叫[IOleObject：： (SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite)之前呼叫[IPersistStreamInit：： load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load)或[IPersistStorage：： load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) ，就會發生這種情況，也就是如果它不接受 OLEMISC_SETCLIENTSITEFIRST 狀態位) 。

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a> COleControl：： WindowProc

提供物件的 Windows 程式 `COleControl` 。

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>參數

*message*<br/>
指定要處理的 Windows 訊息。

*wParam*<br/>
提供用於處理訊息的其他資訊。 參數值取決於訊息。

*lParam*<br/>
提供用於處理訊息的其他資訊。 參數值取決於訊息。

### <a name="return-value"></a>傳回值

分派之訊息的傳回值。

### <a name="remarks"></a>備註

呼叫此函式可透過控制項的訊息對應分派特定的訊息。

## <a name="see-also"></a>另請參閱

[MFC 範例 CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC 範例 TESTHELP](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage 類別](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd 類別](../../mfc/reference/cwnd-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder 類別](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder 類別](../../mfc/reference/cpictureholder-class.md)<br/>
