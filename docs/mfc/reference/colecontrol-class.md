---
title: COleControl 類別
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: c49e71a3e43f74e0e68228c313d3198d0abd4f91
ms.sourcegitcommit: f2a135d69a2a8ef1777da60c53d58fe06980c997
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/03/2020
ms.locfileid: "87520690"
---
# <a name="colecontrol-class"></a>COleControl 類別

開發 OLE 控制項的強大基底類別。

## <a name="syntax"></a>Syntax

```
class COleControl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|Name|說明|
|----------|-----------------|
|[COleControl：： COleControl](#colecontrol)|建立 `COleControl` 物件。|

### <a name="public-methods"></a>公用方法

|Name|說明|
|----------|-----------------|
|[COleControl：： AmbientAppearance](#ambientappearance)|抓取控制項目前的外觀。|
|[COleControl：： AmbientBackColor](#ambientbackcolor)|傳回環境背景色彩屬性的值。|
|[COleControl：： AmbientDisplayName](#ambientdisplayname)|傳回容器所指定的控制項名稱。|
|[COleControl：： AmbientFont](#ambientfont)|傳回環境字型屬性的值。|
|[COleControl：： AmbientForeColor](#ambientforecolor)|傳回環境前景屬性的值。|
|[COleControl：： AmbientLocaleID](#ambientlocaleid)|傳回容器的地區設定識別碼。|
|[COleControl：： AmbientScaleUnits](#ambientscaleunits)|傳回容器所使用的單位類型。|
|[COleControl：： AmbientShowGrabHandles](#ambientshowgrabhandles)|決定是否應該顯示抓取控點。|
|[COleControl：： AmbientShowHatching](#ambientshowhatching)|決定是否應該顯示影線。|
|[COleControl：： AmbientTextAlign](#ambienttextalign)|傳回容器所指定的文字對齊類型。|
|[COleControl：： AmbientUIDead](#ambientuidead)|決定控制項是否應回應使用者介面動作。|
|[COleControl：： AmbientUserMode](#ambientusermode)|決定容器的模式。|
|[COleControl：： BoundPropertyChanged](#boundpropertychanged)|通知容器已變更系結屬性。|
|[COleControl：： BoundPropertyRequestEdit](#boundpropertyrequestedit)|要求編輯屬性值的許可權。|
|[COleControl：： ClientToParent](#clienttoparent)|將相對於控制項原點的點轉譯為相對於其容器來源的點。|
|[COleControl：： ClipCaretRect](#clipcaretrect)|如果插入號矩形是由控制項重迭，則調整它。|
|[COleControl：： ControlInfoChanged](#controlinfochanged)|當控制項所處理的助憶鍵集合已變更之後，請呼叫此函式。|
|[COleControl：:D isplayError](#displayerror)|向控制項的使用者顯示 stock 錯誤事件。|
|[COleControl：:D oClick](#doclick)|內建方法的執行 `DoClick` 。|
|[COleControl：:D oPropExchange](#dopropexchange)|序列化物件的屬性 `COleControl` 。|
|[COleControl：:D oSuperclassPaint](#dosuperclasspaint)|重新繪製已從 Windows 控制項子類別化的 OLE 控制項。|
|[COleControl：： EnableSimpleFrame](#enablesimpleframe)|啟用控制項的簡單框架支援。|
|[COleControl：： ExchangeExtent](#exchangeextent)|序列化控制項的寬度和高度。|
|[COleControl：： ExchangeStockProps](#exchangestockprops)|序列化控制項的內建屬性。|
|[COleControl：： ExchangeVersion](#exchangeversion)|序列化控制項的版本號碼。|
|[COleControl：： FireClick](#fireclick)|引發 stock `Click` 事件。|
|[COleControl：： FireDblClick](#firedblclick)|引發 stock `DblClick` 事件。|
|[COleControl：： FireError](#fireerror)|引發 stock `Error` 事件。|
|[COleControl：： FireEvent](#fireevent)|引發自訂事件。|
|[COleControl：： FireKeyDown](#firekeydown)|引發 stock `KeyDown` 事件。|
|[COleControl：： FireKeyPress](#firekeypress)|引發 stock `KeyPress` 事件。|
|[COleControl：： FireKeyUp](#firekeyup)|引發 stock `KeyUp` 事件。|
|[COleControl：： FireMouseDown](#firemousedown)|引發 stock `MouseDown` 事件。|
|[COleControl：： FireMouseMove](#firemousemove)|引發 stock `MouseMove` 事件。|
|[COleControl：： FireMouseUp](#firemouseup)|引發 stock `MouseUp` 事件。|
|[COleControl：： FireReadyStateChange](#firereadystatechange)|當控制項的就緒狀態變更時引發事件。|
|[COleControl：： GetActivationPolicy](#getactivationpolicy)|改變支援介面之控制項的預設啟用行為 `IPointerInactive` 。|
|[COleControl：： GetAmbientProperty](#getambientproperty)|傳回指定之環境屬性的值。|
|[COleControl：： GetAppearance](#getappearance)|傳回 stock 外觀屬性的值。|
|[COleControl：： GetBackColor](#getbackcolor)|傳回庫存背景色彩屬性的值。|
|[COleControl：： GetBorderStyle](#getborderstyle)|傳回 stock BorderStyle 屬性的值。|
|[COleControl：： GetCapture](#getcapture)|判斷無視窗的已啟用控制項物件是否有滑鼠捕捉。|
|[COleControl：： GetClassID](#getclassid)|抓取控制項的 OLE 類別 ID。|
|[COleControl：： GetClientOffset](#getclientoffset)|抓取控制項矩形區域的左上角和其工作區的左上角之間的差異。|
|[COleControl：： GetClientRect](#getclientrect)|抓取控制項工作區的大小。|
|[COleControl：： GetClientSite](#getclientsite)|查詢物件，以取得其容器內其目前用戶端網站的指標。|
|[COleControl：： GetControlFlags](#getcontrolflags)|抓取控制項旗標設定。|
|[COleControl：： GetControlSize](#getcontrolsize)|傳回 OLE 控制項的位置和大小。|
|[COleControl：： GetDC](#getdc)|提供一個方法，讓無視窗控制項從其容器取得裝置內容。|
|[COleControl：： GetEnabled](#getenabled)|傳回已啟用存貨屬性的值。|
|[COleControl：： GetExtendedControl](#getextendedcontrol)|抓取屬於容器的擴充控制項物件指標。|
|[COleControl：： GetFocus](#getfocus)|決定控制項是否具有焦點。|
|[COleControl：： Ivsfontandcolorstorage.getfont](#getfont)|傳回 stock 字型屬性的值。|
|[COleControl：： GetFontTextMetrics](#getfonttextmetrics)|傳回物件的計量 `CFontHolder` 。|
|[COleControl：： GetForeColor](#getforecolor)|傳回 stock 前景屬性的值。|
|[COleControl：： GetHwnd](#gethwnd)|傳回 stock hWnd 屬性的值。|
|[COleControl：： GetMessageString](#getmessagestring)|提供功能表項目的狀態列文字。|
|[COleControl：： GetNotSupported](#getnotsupported)|防止使用者存取控制項的屬性值。|
|[COleControl：： GetReadyState](#getreadystate)|傳回控制項的就緒狀態。|
|[COleControl：： GetRectInContainer](#getrectincontainer)|傳回相對於其容器的控制項矩形。|
|[COleControl：： GetStockTextMetrics](#getstocktextmetrics)|傳回股票字型屬性的計量。|
|[COleControl：： GetText](#gettext)|傳回 stock Text 或 Caption 屬性的值。|
|[COleControl：： GetWindowlessDropTarget](#getwindowlessdroptarget)|覆寫以允許無視窗控制項成為拖放作業的目標。|
|[COleControl：： InitializeIIDs](#initializeiids)|通知控制項將使用之 Iid 的基類。|
|[COleControl：： InternalGetFont](#internalgetfont)|傳回 `CFontHolder` Stock 字型屬性的物件。|
|[COleControl：： InternalGetText](#internalgettext)|抓取 stock 標題或 Text 屬性。|
|[COleControl：： InternalSetReadyState](#internalsetreadystate)|設定控制項的就緒狀態，並引發就緒狀態變更事件。|
|[COleControl：： InvalidateControl](#invalidatecontrol)|使顯示之控制項的區域失效，使其重新繪製。|
|[COleControl：： InvalidateRgn](#invalidatergn)|使容器視窗在指定區域內的工作區失效。 可以用來重繪區域中的無視窗控制項。|
|[COleControl：： IsConvertingVBX](#isconvertingvbx)|允許 OLE 控制項的特殊載入。|
|[COleControl：： IsModified](#ismodified)|判斷控制項狀態是否已變更。|
|[COleControl：： IsOptimizedDraw](#isoptimizeddraw)|指出容器是否支援目前繪圖作業的優化繪製。|
|[COleControl：： IsSubclassedControl](#issubclassedcontrol)|呼叫以判斷控制項是否子類別化 Windows 控制項。|
|[COleControl：： Load](#load)|重設任何先前的非同步資料，並起始控制項非同步屬性的新負載。|
|[COleControl：： LockInPlaceActive](#lockinplaceactive)|決定容器是否可以停用您的控制項。|
|[COleControl：： OnAmbientPropertyChange](#onambientpropertychange)|當環境屬性變更時呼叫。|
|[COleControl：： OnAppearanceChanged](#onappearancechanged)|當庫存外觀屬性變更時呼叫。|
|[COleControl：： OnBackColorChanged](#onbackcolorchanged)|當庫存背景色彩屬性變更時呼叫。|
|[COleControl：： OnBorderStyleChanged](#onborderstylechanged)|當 stock BorderStyle 屬性變更時呼叫。|
|[COleControl：： OnClick](#onclick)|呼叫以引發股票點擊事件。|
|[COleControl：： OnClose](#onclose)|通知控制項已 `IOleControl::Close` 被呼叫。|
|[COleControl：： OnDoVerb](#ondoverb)|在控制項動詞執行之後呼叫。|
|[COleControl：： OnDraw](#ondraw)|當要求控制項重新繪製時呼叫。|
|[COleControl：： OnDrawMetafile](#ondrawmetafile)|當要求控制項使用中繼檔裝置內容來重新繪製時，由容器呼叫。|
|[COleControl：： OnEdit](#onedit)|由容器呼叫 UI 來啟動 OLE 控制項。|
|[COleControl：： OnEnabledChanged](#onenabledchanged)|當庫存啟用屬性變更時呼叫。|
|[COleControl：： OnEnumVerbs](#onenumverbs)|由容器呼叫以列舉控制項的動詞。|
|[COleControl：： OnEventAdvise](#oneventadvise)|當事件處理常式已連接或與控制項中斷連線時呼叫。|
|[COleControl：： OnFontChanged](#onfontchanged)|當 stock 字型屬性變更時呼叫。|
|[COleControl：： OnForeColorChanged](#onforecolorchanged)|當庫存前景屬性變更時呼叫。|
|[COleControl：： OnFreezeEvents](#onfreezeevents)|當控制項的事件已凍結或解除凍結時呼叫。|
|[COleControl：： OnGetColorSet](#ongetcolorset)|通知控制項已 `IOleObject::GetColorSet` 被呼叫。|
|[COleControl：： OnGetControlInfo](#ongetcontrolinfo)|提供助憶鍵資訊給容器。|
|[COleControl：： OnGetDisplayString](#ongetdisplaystring)|呼叫以取得代表屬性值的字串。|
|[COleControl：： OnGetInPlaceMenu](#ongetinplacemenu)|要求將與 [容器] 功能表合併之控制項功能表的控制碼。|
|[COleControl：： OnGetNaturalExtent](#ongetnaturalextent)|覆寫以抓取最接近建議大小和範圍模式的控制項顯示大小。|
|[COleControl：： OnGetPredefinedStrings](#ongetpredefinedstrings)|傳回表示屬性可能值的字串。|
|[COleControl：： OnGetPredefinedValue](#ongetpredefinedvalue)|傳回對應于預先定義之字串的值。|
|[COleControl：： OnGetViewExtent](#ongetviewextent)|覆寫以抓取控制項的顯示區域大小（可以用來啟用兩階段繪製）。|
|[COleControl：： OnGetViewRect](#ongetviewrect)|覆寫以將控制項的大小轉換成從特定位置開始的矩形。|
|[COleControl：： OnGetViewStatus](#ongetviewstatus)|覆寫以取得控制項的檢視狀態。|
|[COleControl：： OnHideToolBars](#onhidetoolbars)|當控制項為 UI 停用時，由容器呼叫。|
|[COleControl：： OnInactiveMouseMove](#oninactivemousemove)|覆寫以在滑鼠指標下將非作用中控制項的容器分派 WM_MOUSEMOVE 訊息傳送至控制項。|
|[COleControl：： OnInactiveSetCursor](#oninactivesetcursor)|覆寫以在滑鼠指標下將非作用中控制項的容器分派 WM_SETCURSOR 訊息傳送至控制項。|
|[COleControl：： OnKeyDownEvent](#onkeydownevent)|在存貨 KeyDown 事件引發後呼叫。|
|[COleControl：： OnKeyPressEvent](#onkeypressevent)|在引發 stock 按鍵事件之後呼叫。|
|[COleControl：： OnKeyUpEvent](#onkeyupevent)|在存貨 KeyUp 事件引發後呼叫。|
|[COleControl：： OnMapPropertyToPage](#onmappropertytopage)|指出要用來編輯屬性的屬性頁。|
|[COleControl：： OnMnemonic](#onmnemonic)|已按下控制項的助憶鍵時呼叫。|
|[COleControl：： OnProperties](#onproperties)|已叫用控制項的 "Properties" 動詞時呼叫。|
|[COleControl：： OnQueryHitPoint](#onqueryhitpoint)|覆寫以查詢控制項的顯示是否與指定的點重迭。|
|[COleControl：： OnQueryHitRect](#onqueryhitrect)|覆寫以查詢控制項的顯示是否與指定矩形中的任何點重迭。|
|[COleControl：： OnRenderData](#onrenderdata)|由架構呼叫，以取得指定格式的資料。|
|[COleControl：： OnRenderFileData](#onrenderfiledata)|由架構呼叫，以指定的格式從檔案抓取資料。|
|[COleControl：： OnRenderGlobalData](#onrenderglobaldata)|由架構呼叫以從指定格式的全域記憶體中取出資料。|
|[COleControl：： OnResetState](#onresetstate)|將控制項的屬性重設為預設值。|
|[COleControl：： OnSetClientSite](#onsetclientsite)|通知控制項已 `IOleControl::SetClientSite` 被呼叫。|
|[COleControl：： OnSetData](#onsetdata)|以另一個值取代控制項的資料。|
|[COleControl：： OnSetExtent](#onsetextent)|在控制項的範圍變更後呼叫。|
|[COleControl：： OnSetObjectRects](#onsetobjectrects)|在控制項的維度變更後呼叫。|
|[COleControl：： OnShowToolBars](#onshowtoolbars)|當控制項已啟用 UI 時呼叫。|
|[COleControl：： OnTextChanged](#ontextchanged)|當 stock Text 或 Caption 屬性變更時呼叫。|
|[COleControl：： OnWindowlessMessage](#onwindowlessmessage)|處理無視窗控制項的視窗訊息（滑鼠和鍵盤訊息除外）。|
|[COleControl：:P arentToClient](#parenttoclient)|將相對於容器原點的點轉譯為相對於控制項來源的點。|
|[COleControl：:P ostModalDialog](#postmodaldialog)|通知容器已關閉強制回應對話方塊。|
|[COleControl：:P reModalDialog](#premodaldialog)|通知容器要顯示的強制回應對話方塊。|
|[COleControl：： RecreateControlWindow](#recreatecontrolwindow)|終結並重新建立控制項的視窗。|
|[COleControl：： Refresh](#refresh)|強制重新繪製控制項的外觀。|
|[COleControl：： ReleaseCapture](#releasecapture)|釋放滑鼠捕捉。|
|[COleControl：： ReleaseDC](#releasedc)|釋放無視窗控制項容器的顯示裝置內容。|
|[COleControl：： ReparentControlWindow](#reparentcontrolwindow)|重設控制項視窗的父系。|
|[COleControl：： ResetStockProps](#resetstockprops)|`COleControl`將庫存屬性初始化為其預設值。|
|[COleControl：： ResetVersion](#resetversion)|將版本號碼初始化為指定的值。|
|[COleControl：： ScrollWindow](#scrollwindow)|允許無視窗控制項在顯示畫面上的就地現用影像中，滾動一個區域。|
|[COleControl：： SelectFontObject](#selectfontobject)|在裝置內容中選取自訂字型屬性。|
|[COleControl：： SelectStockFont](#selectstockfont)|選取 [股票字型] 屬性到裝置內容中。|
|[COleControl：： SerializeExtent](#serializeextent)|序列化或初始化控制項的顯示空間。|
|[COleControl：： SerializeStockProps](#serializestockprops)|序列化或初始化內建 `COleControl` 屬性。|
|[COleControl：： SerializeVersion](#serializeversion)|序列化或初始化控制項的版本資訊。|
|[COleControl：： SetAppearance](#setappearance)|設定 stock 外觀屬性的值。|
|[COleControl：： SetBackColor](#setbackcolor)|設定庫存背景色彩屬性的值。|
|[COleControl：： SetBorderStyle](#setborderstyle)|設定 stock BorderStyle 屬性的值。|
|[COleControl：： SetCapture](#setcapture)|使控制項的 [容器] 視窗代表控制項擁有滑鼠捕捉。|
|[COleControl：： SetControlSize](#setcontrolsize)|設定 OLE 控制項的位置和大小。|
|[COleControl：： SetEnabled](#setenabled)|設定已啟用存貨屬性的值。|
|[COleControl：： SetFocus](#setfocus)|使控制項的 [容器] 視窗擁有代表控制項的輸入焦點。|
|[COleControl：： SetFont](#setfont)|設定 stock 字型屬性的值。|
|[COleControl：： SetForeColor](#setforecolor)|設定存貨前景屬性的值。|
|[COleControl：： SetInitialSize](#setinitialsize)|設定 OLE 控制項第一次顯示在容器中的大小。|
|[COleControl：： SetModifiedFlag](#setmodifiedflag)|變更控制項的修改狀態。|
|[COleControl：： SetNotPermitted](#setnotpermitted)|指出編輯要求已失敗。|
|[COleControl：： SetNotSupported](#setnotsupported)|防止使用者修改控制項的屬性值。|
|[COleControl：： SetRectInContainer](#setrectincontainer)|設定控制項相對於其容器的矩形。|
|[COleControl：： SetText](#settext)|設定 stock Text 或 Caption 屬性的值。|
|[COleControl：： ThrowError](#throwerror)|表示 OLE 控制項發生錯誤。|
|[COleControl：： TransformCoords](#transformcoords)|轉換容器和控制項之間的座標值。|
|[COleControl：： TranslateColor](#translatecolor)|將 OLE_COLOR 值轉換為 COLORRE光圈值。|
|[COleControl：： WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|決定下一次載入控制項時，環境屬性是否可供使用。|
|[COleControl：： WindowProc](#windowproc)|提供物件的 Windows 程式 `COleControl` 。|

### <a name="protected-methods"></a>保護方法

|Name|說明|
|----------|-----------------|
|[COleControl：:D rawContent](#drawcontent)|當控制項的外觀需要更新時，由架構呼叫。|
|[COleControl：:D rawMetafile](#drawmetafile)|當使用中繼檔裝置內容時，由架構呼叫。|
|[COleControl：： IsInvokeAllowed](#isinvokeallowed)|啟用自動化方法調用。|
|[COleControl：： SetInitialDataFormats](#setinitialdataformats)|由架構呼叫以初始化控制項支援的資料格式清單。|

## <a name="remarks"></a>備註

衍生自 `CWnd` ，這個類別會繼承 Windows 視窗物件的所有功能，以及 OLE 特有的其他功能，例如事件引發和支援方法和屬性的功能。

OLE 控制項可以插入 OLE 容器應用程式中，並使用事件引發的雙向系統和對容器公開方法和屬性的方式，與容器通訊。 請注意，標準 OLE 容器僅支援 OLE 控制項的基本功能。 它們無法支援 OLE 控制項的擴充功能。 當事件因控制項中發生特定動作而傳送至容器時，就會引發事件。 然後，容器會使用一組公開的方法和屬性（類似于 c + + 類別的成員函式和資料成員）來與控制項通訊。 這種方法可讓開發人員控制控制項的外觀，並在發生特定動作時通知容器。

## <a name="windowless-controls"></a>無視窗控制項

在沒有視窗的情況下，OLE 控制項可以就地使用。 無視窗控制項具有顯著的優點：

- 無視窗控制項可以是透明和非矩形

- 無視窗控制項減少實例大小和物件的建立時間

控制項不需要視窗。 視窗提供的服務可以透過單一共用視窗（通常是容器的）和一些分派程式碼輕鬆地提供。 讓視窗在物件上大部分是不必要的複雜問題。

使用無視窗啟用時，容器（有視窗）負責提供控制項自己的視窗所提供的服務。 例如，如果您的控制項需要查詢鍵盤焦點、查詢滑鼠捕捉，或取得裝置內容，則這些作業會由容器管理。 `COleControl`無視窗-作業成員函式會在容器上叫用這些作業。

啟用無視窗啟動時，容器會將輸入訊息委派給控制項的 `IOleInPlaceObjectWindowless` 介面（ [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject)的延伸模組，以提供無視窗的支援）。 `COleControl`執行此介面時，會在適當調整滑鼠座標後，透過您的控制項訊息對應來分派這些訊息。 您可以藉由將對應的專案加入至訊息對應，來處理這些訊息，例如一般視窗訊息。

在無視窗控制項中，您應該一律使用成員函式， `COleControl` 而不是對應的成員函式 `CWnd` 或其相關的 Windows API 函式。

OLE 控制項物件也可以在作用中時建立視窗，但是非作用中的轉換所需的工作量會上升，而轉換的速度也會下降。 在某些情況下，這是問題所在：例如，假設有一個文字方塊的方格。 在資料行向上和向下 cursoring 時，每個控制項都必須就地啟用並停用。 非使用中/主動轉換的速度會直接影響捲動速度。

如需開發 OLE 控制項架構的詳細資訊，請參閱[Mfc Activex 控制項](../../mfc/mfc-activex-controls.md)和[總覽：建立 Mfc activex 控制項程式](../../mfc/reference/mfc-activex-control-wizard.md)文章。 如需優化 OLE 控制項的相關資訊，包括無視窗和不閃爍的控制項，請參閱[MFC ActiveX 控制項：優化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>需求

**標頭：** afxctl.h。h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a>COleControl：： AmbientBackColor

傳回環境背景色彩屬性的值。

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>傳回值

容器的環境背景色彩屬性的目前值（如果有的話）。 如果不支援此屬性，則此函式會傳回系統定義的 Windows 背景色彩。

### <a name="remarks"></a>備註

環境背景色彩屬性可供所有控制項使用，而且是由容器所定義。 請注意，不需要容器就能支援此屬性。

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a>COleControl：： AmbientDisplayName

容器指派給控制項的名稱可以用在向使用者顯示的錯誤訊息中。

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>傳回值

OLE 控制項的名稱。 預設為零長度字串。

### <a name="remarks"></a>備註

請注意，不需要容器就能支援此屬性。

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a>COleControl：： AmbientFont

傳回環境字型屬性的值。

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>傳回值

容器之環境字型分派介面的指標。 預設值是 NULL。 如果傳回的不等於 Null，您會負責呼叫其[IUnknown：： Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)成員函式來釋放字型。

### <a name="remarks"></a>備註

環境字型屬性是由容器所定義，而且可供所有控制項使用。請注意，不需要容器就能支援此屬性。

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a>COleControl：： AmbientForeColor

傳回環境前景屬性的值。

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>傳回值

容器環境前景屬性的目前值（如果有的話）。 如果不支援，則此函式會傳回系統定義的 Windows 文字色彩。

### <a name="remarks"></a>備註

環境前景屬性可供所有控制項使用，而且是由容器所定義。 請注意，不需要容器就能支援此屬性。

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a>COleControl：： AmbientLocaleID

傳回容器的地區設定識別碼。

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>傳回值

容器的 LocaleID 屬性值（如果有的話）。 如果不支援此屬性，則此函式會傳回0。

### <a name="remarks"></a>備註

控制項可以使用 LocaleID 來針對特定地區設定調整其使用者介面。 請注意，不需要容器就能支援此屬性。

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a>COleControl：： AmbientAppearance

抓取控制項物件的目前外觀設定。

```
short AmbientAppearance();
```

### <a name="return-value"></a>傳回值

控制項的外觀：

- **0**平面外觀

- **1** 3d 外觀

### <a name="remarks"></a>備註

呼叫此函式可取得控制項的 DISPID_AMBIENT_APPEARANCE 屬性目前的值。

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a>COleControl：： AmbientScaleUnits

傳回容器所使用的單位類型。

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>傳回值

包含容器之環境 ScaleUnits 的字串。 如果不支援此屬性，則此函式會傳回長度為零的字串。

### <a name="remarks"></a>備註

容器的環境 ScaleUnits 屬性可以用來顯示位置或維度，並以選擇的單位（例如緹或釐米）標示。 請注意，不需要容器就能支援此屬性。

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a>COleControl：： AmbientShowGrabHandles

決定容器是否允許控制項在使用中時顯示其本身的抓取控點。

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>傳回值

如果應該顯示抓取控制碼，則為非零值;否則為0。 如果不支援此屬性，則此函式會傳回非零值。

### <a name="remarks"></a>備註

請注意，不需要容器就能支援此屬性。

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a>COleControl：： AmbientShowHatching

決定當 UI 作用中時，容器是否允許控制項以影線圖樣顯示其本身。

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>傳回值

如果應該顯示陰影圖樣，則為非零值;否則為0。 如果不支援此屬性，則此函式會傳回非零值。

### <a name="remarks"></a>備註

請注意，不需要容器就能支援此屬性。

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a>COleControl：： AmbientTextAlign

決定控制項容器慣用的環境文字對齊方式。

```
short AmbientTextAlign();
```

### <a name="return-value"></a>傳回值

容器的環境對齊屬性的狀態。 如果不支援此屬性，則此函式會傳回0。

以下是有效傳回值的清單：

|傳回值|意義|
|------------------|-------------|
|0|一般對齊（數位到右邊，文字到左邊）。|
|1|靠左對齊|
|2|Center|
|3|靠右對齊|

### <a name="remarks"></a>備註

這個屬性可供所有內嵌的控制項使用，而且是由容器所定義。 請注意，不需要容器就能支援此屬性。

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a>COleControl：： AmbientUIDead

判斷容器是否想要讓控制項回應使用者介面動作。

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>傳回值

如果控制項應該回應使用者介面動作，則為非零。否則為0。 如果不支援此屬性，則此函式會傳回0。

### <a name="remarks"></a>備註

例如，在設計模式中，容器可能會將此設定為 TRUE。

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a>COleControl：： AmbientUserMode

判斷容器處於設計模式或使用者模式。

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>傳回值

如果容器處於使用者模式，則為非零值;否則為0（在設計模式中）。 如果不支援此屬性，則此函式會傳回 TRUE。

### <a name="remarks"></a>備註

例如，在設計模式中，容器可能會將此設定為 FALSE。

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a>COleControl：： BoundPropertyChanged

通知系結屬性值已變更。

```cpp
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項之系結屬性的分派識別碼。

### <a name="remarks"></a>備註

這必須在每次屬性的值變更時呼叫，即使不是透過屬性 Set 方法進行變更也是如此。 特別留意對應至成員變數的系結屬性。 任何時候，都必須呼叫這類成員變數變更 `BoundPropertyChanged` 。

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a>COleControl：： BoundPropertyRequestEdit

要求介面的許可權 `IPropertyNotifySink` ，以變更控制項所提供的系結屬性值。

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項之系結屬性的分派識別碼。

### <a name="return-value"></a>傳回值

如果允許變更，則為非零值;否則為0。 預設值為非零。

### <a name="remarks"></a>備註

如果許可權遭到拒絕，控制項不得讓屬性的值變更。 這可以透過忽略或失敗嘗試變更屬性值的動作來完成。

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a>COleControl：： ClientToParent

將*pPoint*的座標轉譯成父座標。

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
容器內 OLE 控制項界限的指標。 不是工作區，而是整個控制項的區域，包括框線和捲軸。

*pPoint*<br/>
要轉譯成父系（容器）座標之 OLE 用戶端區域點的指標。

### <a name="remarks"></a>備註

在 [輸入*pPoint* ] 上，相對於 OLE 控制項工作區的原點（控制項工作區的左上角）。 [輸出] *pPoint*上的相對於父系的原點（容器的左上角）。

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a>COleControl：： ClipCaretRect

如果插入號矩形完全或部分涵蓋了重迭的不透明物件，則會調整它。

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
在輸入時，是包含要調整之插入號區域之[矩形](/windows/win32/api/windef/ns-windef-rect)結構的指標。 [輸出]、[已調整] 插入號區域，或 [Null] （如果已完全涵蓋插入號矩形）。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

插入號是閃爍的行、區塊或點陣圖，通常會指出文字或圖形的插入位置。

無視窗物件無法安全地顯示插入號，而不需要先檢查插入號是否為部分或完全由重迭的物件隱藏。 若要這麼做，物件可以使用 `ClipCaretRect` 來取得已調整的插入號（減少），以確保它符合裁剪區域。

建立插入號的物件應該將插入號矩形提交至 `ClipCaretRect` ，並使用已調整的矩形做為插入號。 如果插入號完全隱藏，這個方法會傳回 FALSE，而且在此情況下，不應該顯示插入號。

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a>COleControl：： COleControl

建構 `COleControl` 物件。

```
COleControl();
```

### <a name="remarks"></a>備註

通常不會直接呼叫此函式。 相反地，OLE 控制項通常是由其 Class Factory 所建立。

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a>COleControl：： ControlInfoChanged

當控制項所支援的助憶鍵集合已變更時，請呼叫此函式。

```cpp
void ControlInfoChanged();
```

### <a name="remarks"></a>備註

收到此通知時，控制項的容器會呼叫[IOleControl：： GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)來取得一組新的助憶鍵。 請注意，容器不需要回應此通知。

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a>COleControl：:D isplayError

在處理內建錯誤事件之後，由架構呼叫（除非事件處理常式已抑制錯誤的顯示）。

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>參數

*scode*<br/>
要報告的狀態碼值。 如需可能程式碼的完整清單，請參閱[ActiveX 控制項： Advanced 主題](../../mfc/mfc-activex-controls-advanced-topics.md)文章。

*lpszDescription*<br/>
所報告之錯誤的描述。

*lpszSource*<br/>
產生錯誤之模組的名稱（通常是 OLE 控制項模組的名稱）。

*lpszHelpFile*<br/>
包含錯誤描述之說明檔的名稱。

*nHelpID*<br/>
所報告之錯誤的說明內容識別碼。

### <a name="remarks"></a>備註

預設行為會顯示訊息方塊，其中包含包含在*lpszDescription*中的錯誤描述。

覆寫此函式以自訂錯誤的顯示方式。

## <a name="colecontroldoclick"></a><a name="doclick"></a>COleControl：:D oClick

模擬控制項上的滑鼠按一下動作。

```cpp
void DoClick();
```

### <a name="remarks"></a>備註

將會呼叫可覆寫的成員函式 `COleControl::OnClick` ，而且如果控制項支援，就會引發內建 Click 事件。

基類支援此函式 `COleControl` 做為內建方法，稱為 DoClick。 如需詳細資訊，請參閱[ActiveX 控制項：方法](../../mfc/mfc-activex-controls-methods.md)一文。

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a>COleControl：:D oPropExchange

從持續性儲存標記法（例如資料流程或屬性集）載入或儲存控制項時，由架構呼叫。

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>參數

*pPX*<br/>
`CPropExchange` 物件的指標。 架構會提供此物件來建立屬性交換的內容，包括其方向。

### <a name="remarks"></a>備註

此函式通常會呼叫**PX_** 系列的函式，以載入或儲存 OLE 控制項的特定使用者定義屬性。

如果已使用 Control Wizard 來建立 OLE 控制項專案，這個函式的覆寫版本將會將支援的內建屬性序列化為 `COleControl` 呼叫基類函數 `COleControl::DoPropExchange` 。 當您將使用者定義的屬性新增至您的 OLE 控制項時，您必須修改此函式以序列化新的屬性。 如需序列化的詳細資訊，請參閱[ActiveX 控制項：](../../mfc/mfc-activex-controls-serializing.md)序列化一文。

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a>COleControl：:D oSuperclassPaint

重新繪製已從 Windows 控制項子類別化的 OLE 控制項。

```cpp
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>參數

*pDC*<br/>
控制項容器之裝置內容的指標。

*rcBounds*<br/>
要在其中繪製控制項的區域。

### <a name="remarks"></a>備註

呼叫此函式可適當地處理非作用中 OLE 控制項的繪製。 只有當 OLE 控制項子類別化 Windows 控制項，而且應該在控制項的函式中呼叫時，才應該使用這個函式 `OnDraw` 。

如需此函式和子類別化 Windows 控制項的詳細資訊，請參閱[ActiveX 控制項：子類別化 Windows 控制項一](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)文。

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a>COleControl：:D rawContent

當控制項的外觀需要更新時，由架構呼叫。

```cpp
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>參數

*pDC*<br/>
裝置內容的指標。

*rc*<br/>
要在其中繪製的矩形區域。

### <a name="remarks"></a>備註

此函式會直接呼叫可覆寫的函式 `OnDraw` 。

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a>COleControl：:D rawMetafile

當使用中繼檔裝置內容時，由架構呼叫。

```cpp
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>參數

*pDC*<br/>
中繼檔裝置內容的指標。

*rc*<br/>
要在其中繪製的矩形區域。

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a>COleControl：： EnableSimpleFrame

啟用 OLE 控制項的簡單框架特性。

```cpp
void EnableSimpleFrame();
```

### <a name="remarks"></a>備註

這個特性可讓控制項支援其他控制項的視覺內含專案，但不支援真正的 OLE 內含專案。 其中一個範例是在內有數個控制項的群組方塊。 這些控制項不包含 OLE，但它們位於相同的群組方塊中。

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a>COleControl：： ExchangeExtent

序列化或初始化控制項範圍的狀態（其在 HIMETRIC 單位中的維度）。

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>參數

*pPX*<br/>
[CPropExchange](../../mfc/reference/cpropexchange-class.md)物件的指標。 架構會提供此物件來建立屬性交換的內容，包括其方向。

### <a name="return-value"></a>傳回值

如果函式成功，則為非零;否則為0。

### <a name="remarks"></a>備註

此函式通常是由的預設執行所呼叫 `COleControl::DoPropExchange` 。

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a>COleControl：： ExchangeStockProps

序列化或初始化控制項的內建屬性狀態。

```cpp
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>參數

*pPX*<br/>
[CPropExchange](../../mfc/reference/cpropexchange-class.md)物件的指標。 架構會提供此物件來建立屬性交換的內容，包括其方向。

### <a name="remarks"></a>備註

此函式通常是由的預設執行所呼叫 `COleControl::DoPropExchange` 。

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a>COleControl：： ExchangeVersion

序列化或初始化控制項版本資訊的狀態。

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>參數

*pPX*<br/>
`CPropExchange` 物件的指標。 架構會提供此物件來建立屬性交換的內容，包括其方向。

*dwVersionDefault*<br/>
控制項的目前版本號碼。

*bConvert*<br/>
指出保存的資料是否應該在儲存時轉換成最新的格式，或以載入的相同格式進行維護。

### <a name="return-value"></a>傳回值

函式的非零值成功;否則為0。

### <a name="remarks"></a>備註

一般而言，這會是由控制項的覆寫所呼叫的第一個函式 `COleControl::DoPropExchange` 。 載入時，此函式會讀取持續性資料的版本號碼，並據此設定[CPropExchange](../../mfc/reference/cpropexchange-class.md)物件的 version 屬性。 儲存時，此函式會寫入持續性資料的版本號碼。

如需持續性和版本控制的詳細資訊，請參閱[ActiveX 控制項：](../../mfc/mfc-activex-controls-serializing.md)序列化一文。

## <a name="colecontrolfireclick"></a><a name="fireclick"></a>COleControl：： FireClick

當滑鼠按一下作用中控制項時，由架構呼叫。

```cpp
void FireClick();
```

### <a name="remarks"></a>備註

如果這個事件是定義為自訂事件，您可以判斷事件何時引發。

若要自動引發 Click 事件，控制項的事件對應表必須定義 [內建的 Click] 事件。

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a>COleControl：： FireDblClick

當滑鼠按兩下作用中控制項時，由架構呼叫。

```cpp
void FireDblClick();
```

### <a name="remarks"></a>備註

如果這個事件是定義為自訂事件，您可以判斷事件何時引發。

若要自動引發 DblClick 事件，控制項的事件對應表必須定義「內建的 DblClick」事件。

## <a name="colecontrolfireerror"></a><a name="fireerror"></a>COleControl：： FireError

引發 stock 錯誤事件。

```cpp
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>參數

*scode*<br/>
要報告的狀態碼值。 如需可能程式碼的完整清單，請參閱[ActiveX 控制項： Advanced 主題](../../mfc/mfc-activex-controls-advanced-topics.md)文章。

*lpszDescription*<br/>
所報告之錯誤的描述。

*nHelpID*<br/>
所報告之錯誤的說明識別碼。

### <a name="remarks"></a>備註

這個事件會在您的程式碼中的適當位置提供一種方法，讓您的控制項中發生錯誤。 不同于其他內建事件（例如按一下或 MouseMove），架構永遠不會引發錯誤。

若要報告在屬性取得函式、屬性集函數或 automation 方法期間發生的錯誤，請呼叫[COleControl：： ThrowError](#throwerror)。

OLE 控制項的 Stock 錯誤事件的執行會使用 SCODE 值。 如果您的控制項使用此事件，而且打算在 Visual Basic 4.0 中使用，您會收到錯誤，因為 Visual Basic 不支援 SCODE 值。

若要修正此問題，請手動變更控制項中的 SCODE 參數。將檔案 ODL 至 **`long`** 。 此外，任何使用 SCODE 參數的自訂事件、方法或屬性也會造成相同的問題。

## <a name="colecontrolfireevent"></a><a name="fireevent"></a>COleControl：： FireEvent

從您的控制項引發使用者自訂事件，其中包含任意數目的選擇性引數。

```cpp
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>參數

*dispid*<br/>
要引發之事件的分派識別碼。

*pbParams*<br/>
事件之參數類型的描述元。

### <a name="remarks"></a>備註

通常不應直接呼叫此函式。 相反地，您會在控制項的類別宣告的 [事件對應] 區段中呼叫事件引發函式。

*PbParams*引數是以空格分隔的**VTS_** 清單。 其中的一或多個值 (以空格分隔，而非逗號) 會指定函式的參數清單。 可能值如下所示：

|符號|參數類型|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE *|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> 已定義所有 variant 類型的其他變異常數，但 VTS_FONT 和 VTS_PICTURE 除外，可提供 variant 資料常數的指標。 這些常數會使用 VTS_P 慣例來命名 \<CONSTANT-NAME> 。 例如，VTS_PCOLOR 是 VTS_COLOR 常數的指標。

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a>COleControl：： FireKeyDown

當控制項是 UI 作用中，按下按鍵時由架構呼叫。

```cpp
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>參數

*pnChar*<br/>
已按下按鍵之虛擬索引鍵代碼值的指標。 如需標準虛擬按鍵代碼的清單，請參閱 Winuser。

*nShiftState*<br/>
包含下列旗標的組合：

- SHIFT_MASK 動作期間按下 SHIFT 鍵。

- CTRL_MASK 動作期間按下 CTRL 鍵。

- ALT_MASK 在動作期間按下 ALT 鍵。

### <a name="remarks"></a>備註

如果這個事件是定義為自訂事件，您可以判斷事件何時引發。

若要自動引發 KeyDown 事件，控制項的事件對應必須定義股票的 KeyDown 事件。

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a>COleControl：： FireKeyPress

在自訂控制項為容器內的 UI 作用中時，當按下並釋放按鍵時由架構呼叫。

```cpp
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>參數

*pnChar*<br/>
已按下之按鍵的字元值指標。

### <a name="remarks"></a>備註

如果這個事件是定義為自訂事件，您可以判斷事件何時引發。

事件的收件者可能會修改*pnChar*，例如，將所有小寫字元轉換成大寫。 如果您想要檢查修改過的字元，請覆寫 `OnKeyPressEvent` 。

若要自動引發 KeyPress 事件，控制項的事件對應表必須定義「內建按鍵」事件。

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a>COleControl：： FireKeyUp

當自訂控制項為容器內的 UI 作用中，而釋放按鍵時由架構呼叫。

```cpp
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>參數

*pnChar*<br/>
已釋放索引鍵之虛擬索引鍵代碼值的指標。 如需標準虛擬按鍵代碼的清單，請參閱 Winuser。

*nShiftState*<br/>
包含下列旗標的組合：

- SHIFT_MASK 動作期間按下 SHIFT 鍵。

- CTRL_MASK 動作期間按下 CTRL 鍵。

- ALT_MASK 在動作期間按下 ALT 鍵。

### <a name="remarks"></a>備註

如果這個事件是定義為自訂事件，您可以判斷事件何時引發。

若要自動引發 KeyUp 事件，控制項的事件對應必須定義 stock KeyUp 事件。

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a>COleControl：： FireMouseDown

在使用中的自訂控制項上按下滑鼠按鍵時由架構呼叫。

```cpp
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>參數

*nButton*<br/>
已按下滑鼠按鍵的數值。 它可以包含下列其中一個值：

- LEFT_BUTTON 按下滑鼠左鍵。

- MIDDLE_BUTTON 按下滑鼠左鍵。

- RIGHT_BUTTON 按下滑鼠右鍵。

*nShiftState*<br/>
包含下列旗標的組合：

- SHIFT_MASK 動作期間按下 SHIFT 鍵。

- CTRL_MASK 動作期間按下 CTRL 鍵。

- ALT_MASK 在動作期間按下 ALT 鍵。

*x*<br/>
按下滑鼠按鍵時游標的 x 座標。 座標相對於控制項視窗的左上角。

*y*<br/>
按下滑鼠按鍵時游標的 y 座標。 座標相對於控制項視窗的左上角。

### <a name="remarks"></a>備註

如果這個事件是定義為自訂事件，您可以判斷事件何時引發。

若要自動引發 MouseDown 事件，控制項的事件對應必須定義「內建的 MouseDown」事件。

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a>COleControl：： FireMouseMove

當游標移到作用中的自訂控制項上時，由架構呼叫。

```cpp
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>參數

*nButton*<br/>
已按下滑鼠按鍵的數值。 包含下列值的組合：

- LEFT_BUTTON 在動作期間按下滑鼠左鍵。

- MIDDLE_BUTTON 在動作期間按下滑鼠中間按鈕。

- RIGHT_BUTTON 在動作期間按下滑鼠右鍵。

*nShiftState*<br/>
包含下列旗標的組合：

- SHIFT_MASK 動作期間按下 SHIFT 鍵。

- CTRL_MASK 動作期間按下 CTRL 鍵。

- ALT_MASK 在動作期間按下 ALT 鍵。

*x*<br/>
游標的 x 座標。 座標相對於控制項視窗的左上角。

*y*<br/>
游標的 y 座標。 座標相對於控制項視窗的左上角。

### <a name="remarks"></a>備註

如果這個事件是定義為自訂事件，您可以判斷事件何時引發。

若要自動引發 MouseMove 事件，控制項的事件對應必須定義了 stock MouseMove 事件。

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a>COleControl：： FireMouseUp

在使用中的自訂控制項上放開滑鼠按鍵時由架構呼叫。

```cpp
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>參數

*nButton*<br/>
已釋放的滑鼠按鍵數值。 其值可以是下列其中一個值：

- 已釋放滑鼠左鍵 LEFT_BUTTON。

- 已釋放滑鼠中間按鈕 MIDDLE_BUTTON。

- 已釋放滑鼠右鍵 RIGHT_BUTTON。

*nShiftState*<br/>
包含下列旗標的組合：

- SHIFT_MASK 動作期間按下 SHIFT 鍵。

- CTRL_MASK 動作期間按下 CTRL 鍵。

- ALT_MASK 在動作期間按下 ALT 鍵。

*x*<br/>
放開滑鼠按鍵時游標的 x 座標。 座標相對於控制項視窗的左上角。

*y*<br/>
放開滑鼠按鍵時游標的 y 座標。 座標相對於控制項視窗的左上角。

### <a name="remarks"></a>備註

如果這個事件是定義為自訂事件，您可以判斷事件何時引發。

若要自動引發 MouseUp 事件，控制項的事件對應必須定義「內建的 MouseUp」事件。

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a>COleControl：： FireReadyStateChange

引發具有控制項之 [就緒] 狀態之目前值的事件。

```cpp
void FireReadyStateChange();
```

### <a name="remarks"></a>備註

[就緒] 狀態可以是下列其中一個值：

|||
|-|-|
|READYSTATE_UNINITIALIZED|預設初始化狀態|
|READYSTATE_LOADING|控制項目前正在載入其屬性|
|READYSTATE_LOADED|控制項已初始化|
|READYSTATE_INTERACTIVE|控制項有足夠的資料可進行互動，但尚未載入所有非同步資料|
|READYSTATE_COMPLETE|控制項擁有其所有資料|

使用[GetReadyState](#getreadystate)來判斷控制項目前的就緒程度。

[InternalSetReadyState](#internalsetreadystate)會將就緒狀態變更為提供的值，然後呼叫 `FireReadyStateChange` 。

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a>COleControl：： GetActivationPolicy

改變支援介面之控制項的預設啟用行為 `IPointerInactive` 。

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>傳回值

來自 POINTERINACTIVE 列舉的旗標組合。 可能的旗標如下：

|||
|-|-|
|POINTERINACTIVE_ACTI加值稅EONENTRY|當滑鼠在滑鼠移動作業期間輸入物件時，該物件應該是就地啟用的。|
|POINTERINACTIVE_DEACTI加值稅EONLEAVE|在滑鼠移動作業期間，當滑鼠離開物件時，應該停用物件。|
|POINTERINACTIVE_ACTI加值稅EONDRAG|在拖放作業期間將滑鼠拖曳到物件上時，應該會就地啟用該物件。|

### <a name="remarks"></a>備註

`IPointerInactive`啟用介面時，容器會委派 WM_SETCURSOR 並 WM_MOUSEMOVE 訊息。 `COleControl`執行此介面時，會在適當調整滑鼠座標後，透過您的控制項訊息對應來分派這些訊息。

每當容器收到 WM_SETCURSOR 或 WM_MOUSEMOVE 訊息，並將滑鼠指標放在支援的非作用中物件上方時 `IPointerInactive` ，就應該 `GetActivationPolicy` 在介面上呼叫，並從 POINTERINACTIVE 列舉傳回旗標。

您可以藉由將對應的專案加入至訊息對應，來處理這些訊息，就像一般視窗訊息一樣。 在您的處理常式中，請避免使用 `m_hWnd` 成員變數（或使用它的任何成員函式），而不需要先檢查其值是否為非 Null。

要做的任何物件都不會設定滑鼠游標及/或引發滑鼠移動事件（例如提供特別的視覺回饋），應該只傳回 POINTERINACTIVE_ACTI加值稅EONENTRY 旗標，並只在使用中時才繪製意見反應。 如果物件傳回此旗標，容器應立即啟用它，然後將它轉送至觸發呼叫的相同訊息 `GetActivationPolicy` 。

如果同時傳回 POINTERINACTIVE_ACTI加值稅EONENTRY 和 POINTERINACTIVE_DEACTI加值稅EONLEAVE 旗標，則只有在滑鼠停留在物件上時，才會啟用物件。 如果只傳回 POINTERINACTIVE_ACTI加值稅EONENTRY 旗標，則當滑鼠第一次進入物件時，物件只會啟動一次。

您也可能想要讓非作用中的控制項成為 OLE 拖放作業的目標。 這需要在使用者拖曳物件時啟動控制項，讓控制項的視窗可以註冊為放置目標。 若要在拖曳期間讓啟用發生，請傳回 POINTERINACTIVE_ACTI加值稅EONDRAG 旗標：

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

由所傳達的資訊 `GetActivationPolicy` 不應由容器快取。 相反地，每次滑鼠進入非作用中物件時，都應該呼叫這個方法。

如果非作用中物件不會要求在滑鼠進入時就地啟用，則只要滑鼠指標停留在物件上，其容器應該會藉由呼叫[OnInactiveSetCursor](#oninactivesetcursor) ，將後續的 WM_SETCURSOR 訊息分派至此物件。

啟用 `IPointerInactive` 介面通常表示您希望控制項隨時都能夠處理滑鼠訊息。 若要在不支援介面的容器中取得此行為 `IPointerInactive` ，您必須在可見時一律啟用控制項，這表示控制項在其其他旗標中應該有 OLEMISC_ACTI加值稅EWHENVISIBLE 旗標。 不過，若要防止此旗標在支援的容器中生效 `IPointerInactive` ，您也可以指定 OLEMISC_IGNOREACTI加值稅EWHENVISIBLE 旗標：

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a>COleControl：： GetAmbientProperty

取得容器的環境屬性值。

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>參數

*dwDispid*<br/>
所需環境屬性的分派識別碼。

*vtProp*<br/>
Variant 類型標記，指定要在*pvProp*中傳回的數值型別。

*pvProp*<br/>
將接收屬性值或傳回值之變數位址的指標。 這個指標的實際類型必須符合*vtProp*所指定的類型。

|vtProp|PvProp 的類型|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>傳回值

如果支援環境屬性，則為非零。否則為0。

### <a name="remarks"></a>備註

如果您使用 `GetAmbientProperty` 來取出環境 DisplayName 和 ScaleUnits 屬性，請將*vtProp*設定為 VT_BSTR，並將*pvProp*為 `CString*` 。 如果您正在抓取環境字型屬性，請將*vtProp*設定為 VT_FONT，並將*PVPROP*設為 LPFONTDISP *。

請注意，已針對一般環境屬性（例如[AmbientBackColor](#ambientbackcolor)和[AmbientFont](#ambientfont)）提供函式。

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a>COleControl：： GetAppearance

實作用控制項的內建外觀屬性的 Get 函式。

```
short GetAppearance ();
```

### <a name="return-value"></a>傳回值

如果成功，傳回值會將目前的外觀設定指定為 **`short`** （VT_I2）值。 如果控制項的外觀為平面，此值為零，如果控制項的外觀為3D，則為1。

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a>COleControl：： GetBackColor

執行控制項的庫存背景色彩屬性的 Get 函式。

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>傳回值

如果成功，傳回值會將目前的背景色彩指定為 OLE_COLOR 值。 這個值可以使用的呼叫轉譯成 COLORRE光圈值 `TranslateColor` 。

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a>COleControl：： GetBorderStyle

實作用中控制項的股票 BorderStyle 屬性的 Get 函式。

```
short GetBorderStyle();
```

### <a name="return-value"></a>傳回值

如果控制項具有一般框線，則為 1;如果控制項沒有框線，則為0。

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a>COleControl：： GetCapture

判斷物件是否 `COleControl` 具有滑鼠捕捉。

```
CWnd* GetCapture();
```

### <a name="return-value"></a>傳回值

如果控制項已啟動且無視窗，則 **`this`** 會在控制項目前是否有滑鼠捕捉（由控制項的容器決定）時傳回，如果沒有此捕捉則傳回 Null。

否則，會傳回 `CWnd` 具有滑鼠捕捉的物件（與相同 `CWnd::GetCapture` ）。

### <a name="remarks"></a>備註

當呼叫[SetCapture](#setcapture)時，啟動的無視窗控制項會收到滑鼠捕捉。

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a>COleControl：： GetClassID

由架構呼叫以取得控制項的 OLE 類別 ID。

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>參數

*pclsid*<br/>
類別識別碼位置的指標。

### <a name="return-value"></a>傳回值

如果呼叫不成功，則為非零;否則為0。

### <a name="remarks"></a>備註

通常由[IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)來執行。

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a>COleControl：： GetClientOffset

抓取控制項矩形區域的左上角和其工作區的左上角之間的差異。

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>參數

*pdxOffset*<br/>
OLE 控制項的工作區之水準位移的指標。

*pdyOffset*<br/>
OLE 控制項的工作區之垂直位移的指標。

### <a name="remarks"></a>備註

OLE 控制項在其容器內有一個矩形區域。 控制項的工作區是框線和捲軸以外的控制項區域。 所抓取的位移 `GetClientOffset` 是控制項矩形區域的左上角和其工作區的左上角之間的差異。 如果您的控制項具有標準框線和捲軸以外的非用戶端元素，請覆寫此成員函式以指定位移。

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a>COleControl：： GetClientRect

抓取控制項工作區的大小。

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*lpRect*<br/>
結構的指標， `RECT` 包含無視窗控制項工作區的維度; 也就是說，控制項的大小減去視窗框線、框架、捲軸等等。 *LpRect*參數會指出控制項的用戶端矩形大小，而不是其位置。

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a>COleControl：： GetClientSite

查詢物件，以取得其容器內其目前用戶端網站的指標。

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>傳回值

控制項在其容器中的目前用戶端網站的指標。

### <a name="remarks"></a>備註

傳回的指標指向的實例 `IOleClientSite` 。 `IOleClientSite`由容器所執行的介面是物件的內容視圖：它錨定在檔中，它會在其中取得其儲存體、使用者介面和其他資源。

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a>COleControl：： GetControlFlags

抓取控制項旗標設定。

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>傳回值

ControlFlags 列舉中旗標的 ORed 組合：

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>備註

根據預設，`GetControlFlags` 會傳回 `fastBeginPaint | clipPaintDC`。

|||
|-|-|
|`fastBeginPaint`|如果設定，會使用針對 OLE 控制項量身打造的開始繪製函式，而不是[BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) API （預設設定）。|
|`clipPaintDC`|如果未設定，則會停 `IntersectClipRect` 用對所進行的呼叫 `COleControl` ，並獲得較小的速度優勢。 如果您使用無視窗啟用，旗標不會有任何作用。|
|`pointerInactive`|如果設定，則會藉由啟用 `COleControl` 介面的執行 `IPointerInactive` （預設為停用），在控制項非使用中時提供滑鼠互動。|
|`noFlickerActivate`|如果設定，則會排除額外的繪圖作業和伴隨的視覺效果閃爍。 當您的控制項在非作用中和作用中狀態中以相同方式繪製時，請使用。 如果您使用無視窗啟用，旗標不會有任何作用。|
|`windowlessActivate`|如果設定，表示您的控制項使用無視窗啟用。|
|`canOptimizeDraw`|如果設定，表示控制項將會執行優化的繪圖（如果容器支援的話）。|

如需 `GetControlFlags` OLE 控制項的詳細資訊和其他優化，請參閱[ActiveX 控制項：優化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a>COleControl：： GetControlSize

抓取 OLE 控制項視窗的大小。

```cpp
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>參數

*pcx*<br/>
指定控制項的寬度（以圖元為單位）。

*pcy*<br/>
指定控制項的高度（以圖元為單位）。

### <a name="remarks"></a>備註

請注意，控制項視窗的所有座標都會相對於控制項的左上角。

## <a name="colecontrolgetdc"></a><a name="getdc"></a>COleControl：： GetDC

提供給無視窗物件，以從其容器取得螢幕（或相容的）裝置內容。

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>參數

*lprcRect*<br/>
無視窗控制項想要重繪之矩形的指標，以控制項的用戶端座標為單位。 Null 表示完整物件的範圍。

*dwFlags*<br/>
繪製裝置內容的屬性。 選擇包括：

- OLEDC_NODRAW 表示物件不會使用裝置內容來執行任何繪圖，而只是取得顯示裝置的相關資訊。 容器應該只傳遞視窗的 DC，而不需要進一步處理。

- OLEDC_PAINTBKGND 要求容器在傳回 DC 之前繪製背景。 如果物件要求 DC 來重繪具有透明背景的區域，就應該使用這個旗標。

- OLEDC_OFFSCREEN 會通知容器，物件想要轉譯成非螢幕點陣圖，然後複製到螢幕上。 當物件要執行的繪圖作業產生許多閃爍時，應該使用這個旗標。 容器可以免費接受此要求。 不過，如果未設定此旗標，容器就必須取回螢幕上的 DC。 這可讓物件執行直接畫面作業，例如顯示選取專案（透過**XOR**運算）。

### <a name="return-value"></a>傳回值

如果成功，則為容器工作區的顯示裝置內容的指標 `CWnd` ; 否則傳回值為 Null。 顯示裝置內容可用於後續的 GDI 函式，以在容器視窗的工作區中繪製。

### <a name="remarks"></a>備註

在繪製之後，必須呼叫[ReleaseDC](#releasedc)成員函式以釋放內容。 呼叫時 `GetDC` ，物件會以自己的用戶端座標，將他們想要繪製的矩形傳遞至。 `GetDC`將這些轉譯成容器工作區的座標。 物件不應要求大於自己的工作區矩形的所需繪圖矩形，其大小可使用[GetClientRect](#getclientrect)抓取。 這可避免物件不小心地在不應的位置繪製。

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a>COleControl：： GetEnabled

執行控制項的已啟用庫存屬性的 Get 函式。

```
BOOL GetEnabled();
```

### <a name="return-value"></a>傳回值

如果已啟用控制項，則為非零。否則為0。

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a>COleControl：： GetExtendedControl

取得容器所維護之物件的指標，其代表具有一組擴充屬性的控制項。

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>傳回值

容器的擴充控制項物件的指標。 如果沒有可用的物件，則值為 Null。

這個物件可以透過其介面來操作 `IDispatch` 。 您也可以使用 `QueryInterface` 來取得物件所提供的其他可用介面。 不過，不需要物件來支援一組特定的介面。 請注意，依賴容器擴充控制物件的特定功能，會將控制項的可攜性限制為其他任意容器。

### <a name="remarks"></a>備註

呼叫這個函式的函式會在完成物件時，負責釋放指標。 請注意，不需要容器即可支援此物件。

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a>COleControl：： GetFocus

判斷物件是否 `COleControl` 有焦點。

```
CWnd* GetFocus();
```

### <a name="return-value"></a>傳回值

如果控制項已啟用且無視窗，則 **`this`** 會在控制項目前是否有鍵盤焦點（由控制項的容器決定）時傳回; 如果沒有焦點，則傳回 Null。

否則，會傳回 `CWnd` 具有焦點的物件（與相同 `CWnd::GetFocus` ）。

### <a name="remarks"></a>備註

當呼叫[SetFocus](#setfocus)時，啟動的無視窗控制項會收到焦點。

## <a name="colecontrolgetfont"></a><a name="getfont"></a>COleControl：： Ivsfontandcolorstorage.getfont

執行 stock 字型屬性的 Get 函式。

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>傳回值

控制項的內建字型屬性之字型分派介面的指標。

### <a name="remarks"></a>備註

請注意，呼叫端必須在完成時釋放物件。 在控制項的執行中，使用 `InternalGetFont` 來存取控制項的股票字型物件。 如需在控制項中使用字型的詳細資訊，請參閱[Activex 控制項：在 Activex 控制項中使用字型一](../../mfc/mfc-activex-controls-using-fonts.md)文。

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a>COleControl：： GetFontTextMetrics

測量控制項所擁有之任何物件的文字度量 `CFontHolder` 。

```cpp
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>參數

*lptm*<br/>
[TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw)結構的指標。

*fontHolder*<br/>
[CFontHolder](../../mfc/reference/cfontholder-class.md)物件的參考。

### <a name="remarks"></a>備註

您可以使用[COleControl：： SelectFontObject](#selectfontobject)函數來選取這種字型。 `GetFontTextMetrics`會初始化 `TEXTMETRIC` *lptm*所指向的結構，並在成功時使用關於字型的有效計量資訊 `fontHolder` ，或在不成功的情況下，以零填滿結構。 繪製控制項時，您應該使用此函式，而不是[GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) ，因為控制項（例如任何內嵌的 OLE 物件）可能需要將自己轉譯為中繼檔。

`TEXTMETRIC`呼叫[SelectFontObject](#selectfontobject)函數時，會重新整理預設字型的結構。 `GetFontTextMetrics`只有在選取 [內建字型] 屬性，以確保它所提供的資訊有效時，才應該呼叫。

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a>COleControl：： GetForeColor

執行股票前景屬性的 Get 函式。

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>傳回值

傳回值會指定目前的前景色彩做為 OLE_COLOR 值（如果成功）。 這個值可以使用的呼叫轉譯成[COLORREF](/windows/win32/gdi/colorref)值 `TranslateColor` 。

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a>COleControl：： GetHwnd

執行 stock hWnd 屬性的 Get 函式。

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>傳回值

OLE 控制項的視窗控制碼（如果有的話）。否則為 Null。

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a>COleControl：： GetMessageString

由架構呼叫，以取得描述由*nID*所識別之功能表項目用途的簡短字串。

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
功能表項目識別碼。

*rMessage*<br/>
將傳回字串之[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件的參考。

### <a name="remarks"></a>備註

這可用來取得在反白顯示功能表項目時，顯示在狀態列中的訊息。 預設的執行會嘗試載入由*nID*識別的字串資源。

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a>COleControl：： GetNotSupported

防止使用者存取控制項的屬性值。

```cpp
void GetNotSupported();
```

### <a name="remarks"></a>備註

呼叫此函式來取代任何屬性的 Get 函式，此函式不支援由控制項的使用者抓取屬性。 其中一個範例是僅限寫入的屬性。

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a>COleControl：： GetReadyState

傳回控制項的就緒狀態。

```
long GetReadyState();
```

### <a name="return-value"></a>傳回值

控制項的就緒狀態，也就是下列其中一個值：

|||
|-|-|
|READYSTATE_UNINITIALIZED|預設初始化狀態|
|READYSTATE_LOADING|控制項目前正在載入其屬性|
|READYSTATE_LOADED|控制項已初始化|
|READYSTATE_INTERACTIVE|控制項有足夠的資料可進行互動，但尚未載入所有非同步資料|
|READYSTATE_COMPLETE|控制項擁有其所有資料|

### <a name="remarks"></a>備註

大部分的簡單控制項都不需要區分已載入和互動式的。 不過，支援資料路徑屬性的控制項可能尚未準備好進行互動，直到至少以非同步方式接收部分資料為止。 控制項應該會儘快嘗試互動。

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a>COleControl：： GetRectInContainer

取得相對於容器的控制項矩形座標（以裝置單位表示）。

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
矩形結構的指標，將會在其中複製控制項的座標。

### <a name="return-value"></a>傳回值

如果控制項為就地啟用，則為非零。否則為0。

### <a name="remarks"></a>備註

只有當控制項為就地作用中時，矩形才有效。

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a>COleControl：： GetStockTextMetrics

測量控制項的內建字型屬性的文字度量，可以使用[SelectStockFont](#selectstockfont)函式來選取。

```cpp
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>參數

*lptm*<br/>
[TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw)結構的指標。

### <a name="remarks"></a>備註

`GetStockTextMetrics`如果成功，函式會將 lptm 所指向的結構初始化為 `TEXTMETRIC` 有效的計量資訊，或在不成功的情況下，以零填滿結構。 *lptm* 繪製控制項時，請使用此函式，而不是[GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) ，因為控制項（例如任何內嵌的 OLE 物件）可能需要將自己轉譯為中繼檔。

呼叫函式時，會重新整理 `TEXTMETRIC` 預設字型的結構 `SelectStockFont` 。 只有在選取股票字型之後，才應該呼叫此函式，以確保其所提供的資訊有效。

## <a name="colecontrolgettext"></a><a name="gettext"></a>COleControl：： GetText

執行 stock Text 或 Caption 屬性的 Get 函數。

```
BSTR GetText();
```

### <a name="return-value"></a>傳回值

控制項文字字串的目前值，如果不存在任何字串，則為零長度字串。

> [!NOTE]
> 如需 BSTR 資料類型的詳細資訊，請參閱宏和全域區段中的[資料類型](../../mfc/reference/data-types-mfc.md)。

### <a name="remarks"></a>備註

請注意，此函式的呼叫端必須 `SysFreeString` 在傳回的字串上呼叫，才能釋放資源。 在控制項的執行中，使用 `InternalGetText` 來存取控制項的內建文字或 Caption 屬性。

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a>COleControl：： GetWindowlessDropTarget

`GetWindowlessDropTarget`當您想要讓無視窗控制項成為 OLE 拖放作業的目標時，請覆寫。

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>傳回值

物件介面的指標 `IDropTarget` 。 因為沒有視窗，所以無視窗物件無法註冊 `IDropTarget` 介面。 不過，若要參與拖放，無視窗物件仍然可以執行介面，並將其傳回 `GetWindowlessDropTarget` 。

### <a name="remarks"></a>備註

通常這會需要將控制項的視窗登錄為置放目標。 但由於控制項沒有自己的視窗，因此容器會使用它自己的視窗做為放置目標。 控制項只需要提供介面的執行， `IDropTarget` 容器就可以在適當時間委派呼叫。 例如：

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a>COleControl：： InitializeIIDs

通知控制項將使用之 Iid 的基類。

```cpp
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>參數

*piidPrimary*<br/>
控制項主要分派介面的介面識別碼指標。

*piidEvents*<br/>
控制項之事件介面的介面識別碼指標。

### <a name="remarks"></a>備註

在控制項的函式中呼叫此函式，以通知基類您的控制項將使用的介面識別碼。

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a>COleControl：： InternalGetFont

存取控制項的內建字型屬性

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>傳回值

包含股票字型物件之[CFontHolder](../../mfc/reference/cfontholder-class.md)物件的參考。

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a>COleControl：： InternalGetText

存取控制項的 [內文文字] 或 [標題] 屬性。

```
const CString& InternalGetText();
```

### <a name="return-value"></a>傳回值

控制項文字字串的參考。

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a>COleControl：： InternalSetReadyState

設定控制項的就緒狀態。

```cpp
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>參數

*lNewReadyState*<br/>
要為控制項設定的就緒狀態，也就是下列其中一個值：

|||
|-|-|
|READYSTATE_UNINITIALIZED|預設初始化狀態|
|READYSTATE_LOADING|控制項目前正在載入其屬性|
|READYSTATE_LOADED|控制項已初始化|
|READYSTATE_INTERACTIVE|控制項有足夠的資料可進行互動，但尚未載入所有非同步資料|
|READYSTATE_COMPLETE|控制項擁有其所有資料|

### <a name="remarks"></a>備註

大部分的簡單控制項都不需要區分已載入和互動式的。 不過，支援資料路徑屬性的控制項可能尚未準備好進行互動，直到至少以非同步方式接收部分資料為止。 控制項應該會儘快嘗試互動。

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a>COleControl：： InvalidateControl

強制控制項自行重繪。

```cpp
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
要失效之控制項區域的指標。

*bErase*<br/>
指定在處理更新區域時，是否要清除更新區域內的背景。

### <a name="remarks"></a>備註

如果*lpRect*具有 Null 值，則會重新繪製整個控制項。 如果*lpRect*不是 Null，這就表示控制項的矩形部分將失效。 如果控制項沒有視窗，或目前不在使用中，則會忽略該矩形，並對用戶端網站的[IAdviseSink：： OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange)成員函式進行呼叫。 請使用此函式，而不是 `CWnd::InvalidateRect` 或 `InvalidateRect` 。

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a>COleControl：： InvalidateRgn

使容器視窗在指定區域內的工作區失效。

```cpp
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>參數

*pRgn*<br/>
[CRgn](../../mfc/reference/crgn-class.md)物件的指標，識別要使其失效之 OLE 物件的顯示區域（以包含視窗的工作區座標表示）。 如果此參數為 Null，範圍就是整個物件。

*bErase*<br/>
指定是否要清除無效區域內的背景。 若為 TRUE，則會清除背景。 如果為 FALSE，則背景會保持不變。

### <a name="remarks"></a>備註

這可以用來重繪容器內的無視窗控制項。 當下一個[WM_PAINT](/windows/win32/gdi/wm-paint)訊息傳送時，不正確區域以及更新區域中的其他所有區域，都會標示為進行繪製。

如果更新區域的任何部分*bErase*為 TRUE，則會清除整個區域中的背景，而不只是在指定的部分。

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a>COleControl：： IsConvertingVBX

允許 OLE 控制項的特殊載入。

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>傳回值

如果正在轉換控制項，則為非零。否則為0。

### <a name="remarks"></a>備註

當您將使用 VBX 控制項的表單轉換為使用 OLE 控制項的格式時，可能需要 OLE 控制項的特殊載入程式碼。 例如，如果您要載入 OLE 控制項的實例，您可能會呼叫中的[PX_Font](persistence-of-ole-controls.md#px_font) `DoPropExchange` ：

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

不過，VBX 控制項沒有字型物件;每個字型屬性都會個別儲存。 在此情況下，您會使用 `IsConvertingVBX` 來區別這兩種情況：

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

另一種情況是，如果您的 VBX 控制項儲存了專屬的二進位資料（在它的 VBM_SAVEPROPERTY 訊息處理常式中），而您的 OLE 控制項以不同的格式來儲存其二進位資料。 如果您想要讓 OLE 控制項與 VBX 控制項回溯相容，您可以使用函式來讀取舊的和新的格式， `IsConvertingVBX` 方法是區分是否載入 VBX 控制項或 OLE 控制項。

在控制項的函式中 `DoPropExchange` ，您可以檢查此條件，如果為 true，則執行此轉換特定的載入程式碼（例如先前的範例）。 如果控制項未進行轉換，您可以執行一般的載入程式碼。 這項功能僅適用于從 VBX 對應專案轉換的控制項。

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a>COleControl：： IsInvokeAllowed

啟用自動化方法調用。

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>傳回值

如果控制項已初始化，則為非零。否則為0。

### <a name="remarks"></a>備註

架構的呼叫的執行 `IDispatch::Invoke` `IsInvokeAllowed` ，可決定是否可以叫用指定的函式（由識別 `dispid` ）。 OLE 控制項的預設行為是只允許在控制項已初始化時才叫用 automation 方法;不過， `IsInvokeAllowed` 是虛擬函式，而且可能會在必要時加以覆寫（例如，當控制項當做 automation 伺服器使用時）。

## <a name="colecontrolismodified"></a><a name="ismodified"></a>COleControl：： IsModified

判斷控制項的狀態是否已修改。

```
BOOL IsModified();
```

### <a name="return-value"></a>傳回值

如果控制項的狀態自上次儲存後已修改，則為非零值;否則為0。

### <a name="remarks"></a>備註

當屬性變更值時，就會修改控制項的狀態。

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a>COleControl：： IsOptimizedDraw

判斷容器是否支援目前繪圖作業的優化繪製。

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>傳回值

如果容器支援目前繪製作業的優化繪製，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

如果支援優化繪製，則當繪製完成時，控制項不需要在裝置內容中選取舊物件（畫筆、筆刷、字型等等）。

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a>COleControl：： IsSubclassedControl

由架構呼叫以判斷控制項是否子類別化 Windows 控制項。

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>傳回值

如果控制項已子類別化，則為非零。否則為0。

### <a name="remarks"></a>備註

您必須覆寫這個函式，如果您的 OLE 控制項子類別化 Windows 控制項，則傳回 TRUE。

## <a name="colecontrolload"></a><a name="load"></a>COleControl：： Load

重設任何先前載入的資料，並起始控制項非同步屬性的新載入。

```cpp
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>參數

*strNewPath*<br/>
字串的指標，其中包含參考非同步控制項屬性絕對位置的路徑。

*prop*<br/>
執行非同步控制項屬性的[CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md)物件。

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a>COleControl：： LockInPlaceActive

防止容器停用您的控制項。

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>參數

*總匯*<br/>
如果要鎖定控制項的就地現用狀態，則為 TRUE;如果要解除鎖定，則為 FALSE。

### <a name="return-value"></a>傳回值

如果鎖定成功，則為非零;否則為0。

### <a name="remarks"></a>備註

請注意，在完成時，控制項的每個鎖定都必須與控制項的解除鎖定配對。 您應該只在短時間內鎖定您的控制項，例如在引發事件時。

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a>COleControl：： OnAmbientPropertyChange

當容器的環境屬性變更值時，由架構呼叫。

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>參數

*dispID*<br/>
已變更之環境屬性的分派識別碼，如果多個屬性已變更，則為 DISPID_UNKNOWN。

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a>COleControl：： OnAppearanceChanged

當 stock 外觀屬性值變更時由架構呼叫。

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>備註

如果您想要在此屬性變更之後發出通知，請覆寫此函數。 預設的執行會呼叫 `InvalidateControl` 。

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a>COleControl：： OnBackColorChanged

當 stock 背景色彩屬性值變更時由架構呼叫。

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>備註

如果您想要在此屬性變更之後發出通知，請覆寫此函數。 預設的執行會呼叫 `InvalidateControl` 。

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a>COleControl：： OnBorderStyleChanged

當 stock BorderStyle 屬性值變更時由架構呼叫。

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>備註

預設的執行會呼叫 `InvalidateControl` 。

如果您想要在此屬性變更之後發出通知，請覆寫此函數。

## <a name="colecontrolonclick"></a><a name="onclick"></a>COleControl：： OnClick

已按下滑鼠按鍵或已叫用 DoClick stock 方法時，由架構呼叫。

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>參數

*iButton*<br/>
滑鼠按鍵的索引。 可以具有下列其中一個值：

- LEFT_BUTTON 按一下滑鼠左鍵。

- 已按下滑鼠左鍵 MIDDLE_BUTTON。

- RIGHT_BUTTON 按一下滑鼠右鍵。

### <a name="remarks"></a>備註

預設的執行會呼叫 `COleControl::FireClick` 。

覆寫此成員函式以修改或擴充預設處理。

## <a name="colecontrolonclose"></a><a name="onclose"></a>COleControl：： OnClose

當容器已呼叫控制項的函式時，由架構呼叫 `IOleControl::Close` 。

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>參數

*dwSaveOption*<br/>
表示是否應該在載入前儲存物件的旗標。 有效值為：

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>備註

根據預設， `OnClose` 會儲存控制項物件（如果已修改），而且*dwSaveOption*是 OLECLOSE_SAVEIFDIRTY 或 OLECLOSE_PROMPTSAVE。

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a>COleControl：： OnDoVerb

當容器呼叫成員函式時，由架構呼叫 `IOleObject::DoVerb` 。

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*iVerb*<br/>
要叫用之控制項動詞的索引。

*lpMsg*<br/>
導致叫用動詞的 Windows 訊息指標。

*hWndParent*<br/>
控制項父視窗的控制碼。 如果執行動詞建立視窗（或 windows），則應該使用*hWndParent*做為父代。

*lpRect*<br/>
矩形結構的指標，相對於容器，將會複製控制項的座標。

### <a name="return-value"></a>傳回值

如果呼叫成功，則為非零值;否則為0。

### <a name="remarks"></a>備註

預設的實作用會使用 ON_OLEVERB 並 ON_STDOLEVERB 訊息對應專案，來判斷要叫用的適當函式。

覆寫此函式以變更動詞的預設處理。

## <a name="colecontrolondraw"></a><a name="ondraw"></a>COleControl：： OnDraw

由架構呼叫，使用指定的裝置內容在指定的周框中繪製 OLE 控制項。

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>參數

*pDC*<br/>
繪製發生所在的裝置內容。

*rcBounds*<br/>
控制項的矩形區域，包括框線。

*rcInvalid*<br/>
無效之控制項的矩形區域。

### <a name="remarks"></a>備註

`OnDraw`通常會針對螢幕顯示呼叫，以*pDC*的形式傳遞螢幕裝置內容。 *RcBounds*參數會識別目標裝置內容中的矩形（相對於其目前的對應模式）。 *RcInvalid*參數是不正確實際矩形。 在某些情況下，這會是比*rcBounds*更小的區域。

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a>COleControl：： OnDrawMetafile

由架構呼叫，使用指定的中繼檔裝置內容在指定的周框中繪製 OLE 控制項。

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>參數

*pDC*<br/>
繪製發生所在的裝置內容。

*rcBounds*<br/>
控制項的矩形區域，包括框線。

### <a name="remarks"></a>備註

預設的實值會呼叫[OnDraw](#ondraw)函數。

## <a name="colecontrolonedit"></a><a name="onedit"></a>COleControl：： OnEdit

導致控制項啟動 UI。

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*lpMsg*<br/>
叫用動詞命令之 Windows 訊息的指標。

*hWndParent*<br/>
控制項父視窗的控制碼。

*lpRect*<br/>
容器中的控制項所使用之矩形的指標。

### <a name="return-value"></a>傳回值

如果呼叫成功，則為非零;否則為0。

### <a name="remarks"></a>備註

這與叫用控制項的 OLEIVERB_UIACTI加值稅E 動詞效果相同。

此函式通常用來做為 ON_OLEVERB 訊息對應專案的處理常式函數。 這會讓控制項的 [物件] 功能表上有 [編輯] 動詞。 例如：

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a>COleControl：： OnEnabledChanged

當啟用庫存屬性值變更時由架構呼叫。

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>備註

如果您想要在此屬性變更之後發出通知，請覆寫此函數。 預設的實值會呼叫[InvalidateControl](#invalidatecontrol)。

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a>COleControl：： OnEnumVerbs

當容器呼叫成員函式時，由架構呼叫 `IOleObject::EnumVerbs` 。

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>參數

*ppenumOleVerb*<br/>
`IEnumOLEVERB`列舉控制項動詞之物件的指標。

### <a name="return-value"></a>傳回值

如果有動詞，則為非零值;否則為0。

### <a name="remarks"></a>備註

預設的實值會列舉訊息對應中的 ON_OLEVERB 專案。

覆寫此函式以變更列舉動詞命令的預設方式。

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a>COleControl：： OnEventAdvise

當事件處理常式連接到 OLE 控制項或與其中斷連線時，由架構呼叫。

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>參數

*bAdvise*<br/>
TRUE 表示事件處理常式已連接到控制項。 FALSE 表示事件處理常式已與控制項中斷連接。

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a>COleControl：： OnFontChanged

當 stock 字型屬性值變更時由架構呼叫。

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>備註

預設的執行會呼叫 `COleControl::InvalidateControl` 。 如果控制項是子類別化 Windows 控制項，則預設的執行也會將 WM_SETFONT 訊息傳送至控制項的視窗。

如果您想要在此屬性變更之後發出通知，請覆寫此函數。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a>COleControl：： OnForeColorChanged

當 stock 前景屬性值變更時由架構呼叫。

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>備註

預設的執行會呼叫 `InvalidateControl` 。

如果您想要在此屬性變更之後發出通知，請覆寫此函數。

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a>COleControl：： OnFreezeEvents

在容器呼叫之後由架構呼叫 `IOleControl::FreezeEvents` 。

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>參數

*bFreeze*<br/>
如果控制項的事件處理已凍結，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

預設實作不做任何動作。

如果您想要在事件處理已凍結或解除凍結時有額外的行為，請覆寫此函數。

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a>COleControl：： OnGetColorSet

當容器呼叫成員函式時，由架構呼叫 `IViewObject::GetColorSet` 。

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>參數

*ptd*<br/>
指向應該呈現圖片的目標裝置。 如果此值為 Null，則應該呈現預設目標裝置的圖片，通常是顯示裝置。

*hicTargetDev*<br/>
在*ptd*所指示的目標裝置上指定資訊內容。 這個參數可以是裝置內容，但不一定要有。 如果*ptd*為 null，則*hicTargetDev*也應該是 null。

*ppColorSet*<br/>
要在其中複製所要使用之色彩集的位置指標。 如果函式未傳回色彩集，則會傳回 Null。

### <a name="return-value"></a>傳回值

如果傳回有效的色彩集，則為非零值;否則為0。

### <a name="remarks"></a>備註

容器會呼叫這個函式，以取得繪製 OLE 控制項所需的所有色彩。 容器可以使用所取得的色彩集，搭配其設定整體色調色板所需的色彩。 預設的實值會傳回 FALSE。

覆寫此函式以執行此要求的任何特殊處理。

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a>COleControl：： OnGetControlInfo

當控制項的容器要求控制項的相關資訊時，由架構呼叫。

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>參數

*pControlInfo*<br/>
要填入之[CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo)結構的指標。

### <a name="remarks"></a>備註

這項資訊主要是由控制項的助憶鍵描述所組成。 預設的執行會以預設資訊填滿*pControlInfo* 。

如果您的控制項需要處理助憶鍵，請覆寫此函式。

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a>COleControl：： OnGetDisplayString

由架構呼叫以取得字串，表示*dispid*所識別之屬性的目前值。

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項屬性的分派識別碼。

*strValue*<br/>
將傳回字串之[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件的參考。

### <a name="return-value"></a>傳回值

如果 StrValue 中已傳回字串 *，* 則為非零，否則為0。

### <a name="remarks"></a>備註

如果您的控制項具有屬性，其值無法直接轉換成字串，而您想要在容器提供的屬性瀏覽器中顯示內容的值，請覆寫這個函式。

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a>COleControl：： OnGetInPlaceMenu

當控制項已啟動時由架構呼叫，以取得要合併到容器現有功能表的功能表。

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>傳回值

控制項功能表的控制碼，如果控制項沒有任何值，則為 Null。 預設的實值會傳回 Null。

### <a name="remarks"></a>備註

如需有關合併 OLE 資源的詳細資訊，請參閱文章[功能表和資源（OLE）](../../mfc/menus-and-resources-ole.md)。

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a>COleControl：： OnGetNaturalExtent

由架構呼叫以回應容器的 `IViewObjectEx::GetNaturalExtent` 要求。

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
指定物件要進行表示的方式。 標記法包含內容、圖示、縮圖或列印檔案。 有效的值取自列舉[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)或 DVASPECT2。

*lindex*<br/>
相關物件的部分。 目前只有-1 是有效的。

*ptd*<br/>
指向[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)結構，其定義應傳回物件大小的目標裝置。

*hicTargetDev*<br/>
指定*ptd*參數所指示之目標裝置的資訊內容，物件可以從該參數中解壓縮裝置計量並測試裝置的功能。 如果*ptd*為 Null，則物件應忽略*hicTargetDev*參數中的值。

*pExtentInfo*<br/>
指向 `DVEXTENTINFO` 指定大小資料的結構。 `DVEXTENTINFO`結構為：

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

結構成員 `dwExtentMode` 可以接受兩個值的其中一個：

- DVEXTENT_CONTENT 詢問控制項是否能完全符合內容（貼齊大小）

- DVEXTENT_INTEGRAL 調整大小時，將提議的大小傳遞給控制項

*psizel*<br/>
指向控制項所傳回的調整大小資料。 針對未調整的任何維度，傳回的調整大小資料會設定為-1。

### <a name="return-value"></a>傳回值

如果成功傳回或調整大小，則為非零值;否則為0。

### <a name="remarks"></a>備註

覆寫這個函式，以傳回最接近結構中建議大小和範圍模式的物件顯示大小 `DVEXTENTINFO` 。 預設的實值會傳回 FALSE，且不會調整大小。

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a>COleControl：： OnGetPredefinedStrings

由架構呼叫以取得一組預先定義的字串，代表屬性的可能值。

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項屬性的分派識別碼。

*pStringArray*<br/>
要填入傳回值的字串陣列。

*pCookieArray*<br/>
要填入傳回值的 DWORD 陣列。

### <a name="return-value"></a>傳回值

如果元素已加入至*pStringArray*和*pCookieArray*，則為非零值。

### <a name="remarks"></a>備註

如果您的控制項具有具有一組可由字串表示之可能值的屬性，請覆寫此函式。 針對新增至*pStringArray*的每個元素，您應該將對應的 "cookie" 元素新增至*pCookieArray。* 這些「cookie」值稍後可以由架構傳遞至函式 `COleControl::OnGetPredefinedValue` 。

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a>COleControl：： OnGetPredefinedValue

由架構呼叫，以取得對應至先前由覆寫所傳回之其中一個預先定義字串的值 `COleControl::OnGetPredefinedStrings` 。

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項屬性的分派識別碼。

*dwCookie*<br/>
的覆寫先前傳回的 cookie 值 `COleControl::OnGetPredefinedStrings` 。

*lpvarOut*<br/>
`VARIANT`將傳回屬性值之結構的指標。

### <a name="return-value"></a>傳回值

如果已在*lpvarOut*中傳回值，則為非零。否則為0。

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a>COleControl：： OnGetViewExtent

由架構呼叫以回應容器的[IViewObject2：： GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent)要求。

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>參數

*dwDrawAspect*<br/>
DWORD，描述要顯示的物件表單或外觀。 有效的值取自列舉[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)或 DVASPECT2。

*lindex*<br/>
相關物件的部分。 目前只有-1 是有效的。

*ptd*<br/>
指向[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)結構，其定義應傳回物件大小的目標裝置。

*lpsizel*<br/>
指向傳回物件大小的位置。

### <a name="return-value"></a>傳回值

如果成功傳回範圍資訊，則為非零值;否則為0。

### <a name="remarks"></a>備註

如果您的控制項使用兩個階段的繪圖，而且其不透明且透明的部分具有不同的維度，則覆寫這個函式。

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a>COleControl：： OnGetViewRect

由架構呼叫以回應容器的 `IViewObjectEx::GetRect` 要求。

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
DWORD，描述要顯示的物件表單或外觀。 有效的值取自列舉[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)或 DVASPECT2：

- 整個物件的 DVASPECT_CONTENT 周框。 物件原始來源的左上角，大小等於所傳回的範圍 `GetViewExtent` *。*

- 具有矩形不透明區域的 DVASPECT_OPAQUE 物件會傳回該矩形。 其他則失敗。

- 涵蓋所有透明或不規則部分的 DVASPECT_TRANSPARENT 矩形。

*pRect*<br/>
指向[RECTL](/windows/win32/api/windef/ns-windef-rectl)結構，指定應在其中繪製物件的矩形。 這個參數會控制物件的定位和延展。

### <a name="return-value"></a>傳回值

如果成功傳回大小為物件的矩形，則為非零值;否則為0。

### <a name="remarks"></a>備註

物件的大小會由轉換 `OnGetViewRect` 成從特定位置開始的矩形（預設值是顯示的左上角）。 如果您的控制項使用兩個階段的繪圖，而且其不透明且透明的部分具有不同的維度，則覆寫這個函式。

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a>COleControl：： OnGetViewStatus

由架構呼叫以回應容器的 `IViewObjectEx::GetViewStatus` 要求。

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>傳回值

如果成功，則為 VIEWSTATUS 列舉的其中一個值;否則為0。 可能的值為下列各項的任意組合：

|||
|-|-|
|VIEWSTATUS_OPAQUE|物件完全不透明。 如果未設定此位，物件會包含透明部分。 此位僅適用于內容相關的層面，而不會 DVASPECT_ICON 或 DVASPECT_DOCPRINT。|
|VIEWSTATUS_SOLIDBKGND|物件具有純色背景（由純色組成，而不是筆刷模式）。 只有在設定 VIEWSTATUS_OPAQUE，而且僅適用于內容相關的層面，而不是 DVASPECT_ICON 或 DVASPECT_DOCPRINT 時，這個位才有意義。|
|VIEWSTATUS_DVASPECTOPAQUE|物件支援 DVASPECT_OPAQUE。 所有採用繪圖外觀做為參數的 IViewObjectEx 方法，都可以使用這個層面來呼叫。|
|VIEWSTATUS_DVASPECTTRANSPARENT|物件支援 DVASPECT_TRANSPARENT。 所有 `IViewObjectEx` 採用繪圖外觀做為參數的方法，都可以使用這個層面來呼叫。|

### <a name="remarks"></a>備註

如果您的控制項使用兩個階段的繪圖，請覆寫此函式。 預設的實值會傳回 VIEWSTATUS_OPAQUE。

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a>COleControl：： OnHideToolBars

當控制項為 UI 停用時，由架構呼叫。

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>備註

此實作為應該隱藏所有顯示的工具列 `OnShowToolbars` 。

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a>COleControl：： OnInactiveMouseMove

在收到 WM_MOUSEMOVE 訊息時，滑鼠指標下的非作用中物件的容器所呼叫。

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
物件周框矩形，在包含視窗的工作區座標中。 當收到 WM_MOUSEMOVE 訊息時，告知物件其在畫面上的確切位置和大小。

*x*<br/>
滑鼠位置在包含視窗的工作區座標中的 x 座標。

*y*<br/>
滑鼠位置在包含視窗的工作區座標中的 y 座標。

*dwKeyState*<br/>
識別鍵盤上鍵盤輔助按鍵的目前狀態。 有效值可以是任何旗標 MK_CONTROL、MK_SHIFT、MK_ALT、MK_BUTTON、MK_LBUTTON、MK_MBUTTON 和 MK_RBUTTON 的組合。

### <a name="remarks"></a>備註

請注意，視窗用戶端座標（圖元）是用來傳遞滑鼠游標位置。 您也可以在相同的座標系統中傳遞物件的周框矩形來達成此目的。

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a>COleControl：： OnInactiveSetCursor

在收到 WM_SETCURSOR 訊息時，滑鼠指標下的非作用中物件的容器所呼叫。

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
物件周框矩形，在包含視窗的工作區座標中。 當收到 WM_SETCURSOR 訊息時，告知物件其在畫面上的確切位置和大小。

*x*<br/>
滑鼠位置在包含視窗的工作區座標中的 x 座標。

*y*<br/>
滑鼠位置在包含視窗的工作區座標中的 y 座標。

*dwMouseMsg*<br/>
發生 WM_SETCURSOR 之滑鼠訊息的識別碼。

*bSetAlways*<br/>
指定物件是否必須設定資料指標。 如果為 TRUE，則物件必須設定資料指標;如果為 FALSE，則表示資料指標並非設定資料指標的義務，而且應該在此情況下傳回 S_FALSE。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

請注意，視窗用戶端座標（圖元）是用來傳遞滑鼠游標位置。 您也可以在相同的座標系統中傳遞物件的周框矩形來達成此目的。

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a>COleControl：： OnKeyDownEvent

在處理股票的 KeyDown 事件之後，由架構呼叫。

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>參數

*nChar*<br/>
已按下按鍵的虛擬索引鍵代碼值。 如需標準虛擬按鍵代碼的清單，請參閱 Winuser。

*nShiftState*<br/>
包含下列旗標的組合：

- SHIFT_MASK 動作期間按下 SHIFT 鍵。

- CTRL_MASK 動作期間按下 CTRL 鍵。

- ALT_MASK 在動作期間按下 ALT 鍵。

### <a name="remarks"></a>備註

如果您的控制項需要在引發事件之後存取金鑰資訊，請覆寫這個函式。

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a>COleControl：： OnKeyPressEvent

在引發 stock 按鍵事件之後，由架構呼叫。

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>參數

*nChar*<br/>
包含已按下之按鍵的虛擬索引鍵代碼值。 如需標準虛擬按鍵代碼的清單，請參閱 Winuser。

### <a name="remarks"></a>備註

請注意，容器可能已修改*nChar*值。

如果您想要在發生此事件之後發出通知，請覆寫此函數。

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a>COleControl：： OnKeyUpEvent

在處理股票的 KeyDown 事件之後，由架構呼叫。

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>參數

*nChar*<br/>
已按下按鍵的虛擬索引鍵代碼值。 如需標準虛擬按鍵代碼的清單，請參閱 Winuser。

*nShiftState*<br/>
包含下列旗標的組合：

- SHIFT_MASK 動作期間按下 SHIFT 鍵。

- CTRL_MASK 動作期間按下 CTRL 鍵。

- ALT_MASK 在動作期間按下 ALT 鍵。

### <a name="remarks"></a>備註

如果您的控制項需要在引發事件之後存取金鑰資訊，請覆寫這個函式。

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a>COleControl：： OnMapPropertyToPage

由架構呼叫，以取得執行指定屬性之編輯的屬性頁的類別 ID。

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項屬性的分派識別碼。

*lpclsid*<br/>
`CLSID`將傳回類別識別碼之結構的指標。

*pbPageOptional*<br/>
傳回指標，指出是否使用指定的屬性頁是選擇性的。

### <a name="return-value"></a>傳回值

如果*lpclsid*中已傳回類別識別碼，則為非零。否則為0。

### <a name="remarks"></a>備註

覆寫此函式，以提供方法從容器的屬性瀏覽器叫用控制項的屬性頁。

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a>COleControl：： OnMnemonic

當容器偵測到已按下 OLE 控制項的助憶鍵時，由架構呼叫。

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>參數

*pMsg*<br/>
助憶鍵 (Mnemonic) 按鍵所產生之 Windows 訊息的指標。

## <a name="colecontrolonproperties"></a><a name="onproperties"></a>COleControl：： OnProperties

當容器叫用控制項的屬性動詞時，由架構呼叫。

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*lpMsg*<br/>
叫用動詞命令之 Windows 訊息的指標。

*hWndParent*<br/>
控制項父視窗的控制碼。

*lpRect*<br/>
容器中的控制項所使用之矩形的指標。

### <a name="return-value"></a>傳回值

如果呼叫成功，則為非零;否則為0。

### <a name="remarks"></a>備註

預設的執行會顯示 [模式屬性] 對話方塊。

您也可以使用此函式，讓控制項的屬性頁顯示。 對函式進行呼叫 `OnProperties` ，並在*hWndParent*參數中傳遞控制項父系的控制碼。 在此情況下，會忽略*lpMsg*和*lpRect*參數的值。

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a>COleControl：： OnQueryHitPoint

由架構呼叫以回應容器的 `IViewObjectEx::QueryHitPoint` 要求。

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
指定物件的表示方式。 有效的值取自列舉[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)或 DVASPECT2。

*pRectBounds*<br/>
結構的指標， `RECT` 指定 OLE 控制項工作區的周框。

*ptlLoc*<br/>
結構的指標， `POINT` 指定要檢查的點擊點。 該點是以 OLE 工作區座標指定。

*lCloseHint*<br/>
將「關閉」定義為檢查點擊的點距離。

*pHitResult*<br/>
點擊查詢結果的指標。 下列其中一個值：

- HITRESULT_OUTSIDE *ptlLoc*位於 OLE 物件外部，而不是關閉。

- HITRESULT_TRANSPARENT *ptlLoc*是在 OLE 物件的界限內，而不是接近影像。 例如，可以 HITRESULT_TRANSPARENT 透明圓圈中間的點。

- HITRESULT_CLOSE *ptlLoc*是在 OLE 物件內部或外部，但接近要在內部考慮的物件。 小型、精簡或詳細的物件可能會使用此值。 即使某個點位於物件的周框外，仍然可能會關閉（這是達到小型物件的必要項）。

- HITRESULT_HIT *ptlLoc*位於物件的影像中。

### <a name="return-value"></a>傳回值

如果成功傳回點擊結果，則為非零。否則為0。 點擊次數與 OLE 控制項顯示區域重迭。

### <a name="remarks"></a>備註

查詢物件的顯示矩形是否與指定的點重迭（點擊點）。 `QueryHitPoint`可以覆寫以測試非矩形物件的命中。

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a>COleControl：： OnQueryHitRect

由架構呼叫以回應容器的 `IViewObjectEx::QueryHitRect` 要求。

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
指定物件要進行表示的方式。 有效的值取自列舉[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)或 DVASPECT2。

*pRectBounds*<br/>
結構的指標， `RECT` 指定 OLE 控制項工作區的周框。

*prcLoc*<br/>
結構的指標 `RECT` ，指定要檢查是否有點擊的矩形（與物件矩形重迭），相對於物件的左上角。

*lCloseHint*<br/>
未使用。

*pHitResult*<br/>
點擊查詢結果的指標。 下列其中一個值：

- HITRESULT_OUTSIDE OLE 物件不會碰到矩形中的任何點。

- HITRESULT_HIT 矩形中至少有一個點會在物件上叫用。

### <a name="return-value"></a>傳回值

如果成功傳回點擊結果，則為非零。否則為0。

### <a name="remarks"></a>備註

查詢物件的顯示矩形是否與指定矩形中的任何點重迭（命中矩形）。 `QueryHitRect`可以覆寫以測試非矩形物件的命中。

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a>COleControl：： OnRenderData

由架構呼叫，以取得指定格式的資料。

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)結構，指定要求資訊的格式。

*lpStgMedium*<br/>
指向要傳回資料的[STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1)結構。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

指定的格式是先前使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)或[DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)成員函式進行延遲轉譯的控制項物件。 `OnRenderFileData` `OnRenderGlobalData` 如果所提供的儲存媒體是檔案或記憶體，此函式的預設實作為分別會呼叫或。 如果要求的格式為 CF_METAFILEPICT 或持續性屬性集格式，則預設的執行會轉譯適當的資料，並傳回非零。 否則，它會傳回0，而且不會執行任何操作。

如果 TYMED_Null *lpStgMedium >的 tymed* ，則應該配置 STGMEDIUM，並依*lpFormatEtc->tymed*的指定加以填入。 如果未 TYMED_Null，就應該使用資料來填入 STGMEDIUM。

覆寫此函式，以要求的格式和媒體提供您的資料。 根據您的資料而定，您可能會想要改為覆寫此函式的其中一個其他版本。 如果您的資料大小很小且固定，請覆寫 `OnRenderGlobalData` 。 如果您的資料位於檔案中，或屬於變數大小，請覆寫 `OnRenderFileData` 。

如需詳細資訊，請 `FORMATETC` 參閱 `STGMEDIUM` Windows SDK 中的和結構。

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a>COleControl：： OnRenderFileData

由架構呼叫，以在儲存媒體為檔案時，以指定的格式抓取資料。

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)結構，指定要求資訊的格式。

*pFile*<br/>
指向要在其中呈現資料的[CFile](../../mfc/reference/cfile-class.md)物件。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

指定的格式是先前使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)成員函式來呈現延遲轉譯的控制項物件。 此函式的預設實作用只會傳回 FALSE。

覆寫此函式，以要求的格式和媒體提供您的資料。 根據您的資料而定，您可能會想要改為覆寫此函式的其中一個其他版本。 如果您想要處理多個儲存媒體，請覆寫 `OnRenderData` 。 如果您的資料位於檔案中，或屬於變數大小，請覆寫 `OnRenderFileData` 。

如需詳細資訊，請參閱 `FORMATETC` Windows SDK 中的結構。

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a>COleControl：： OnRenderGlobalData

由架構呼叫，以在指定的儲存媒體為全域記憶體時，以指定的格式抓取資料。

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)結構，指定要求資訊的格式。

*phGlobal*<br/>
指向要傳回資料之全域記憶體的控制碼。 如果未配置記憶體，這個參數可以是 Null。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

指定的格式是先前使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)成員函式來呈現延遲轉譯的控制項物件。 此函式的預設實作用只會傳回 FALSE。

如果*phGlobal*為 Null，則應該在*phGlobal*中配置並傳回新的 HGLOBAL。 否則， *phGlobal*所指定的 HGLOBAL 應該填入資料。 放在 HGLOBAL 中的資料量不得超過記憶體區塊的目前大小。 此外，區塊也無法重新配置為較大的大小。

覆寫此函式，以要求的格式和媒體提供您的資料。 根據您的資料而定，您可能會想要改為覆寫此函式的其中一個其他版本。 如果您想要處理多個儲存媒體，請覆寫 `OnRenderData` 。 如果您的資料位於檔案中，或屬於變數大小，請覆寫 `OnRenderFileData` 。

如需詳細資訊，請參閱 `FORMATETC` Windows SDK 中的結構。

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a>COleControl：： OnResetState

當控制項的屬性應該設定為預設值時，由架構呼叫。

```
virtual void OnResetState();
```

### <a name="remarks"></a>備註

預設的實值會呼叫[DoPropExchange](#dopropexchange)，傳遞 `CPropExchange` 導致屬性設定為預設值的物件。

控制項寫入器可以在這個可覆寫的中插入 OLE 控制項的初始化程式碼。 當[IPersistStream：： Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load)或[IPersistStorage：： load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)失敗，或呼叫[IPersistStreamInit：： InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)或[IPersistStorage：： InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew)時，不需要先呼叫或，就會呼叫這個函式 `IPersistStream::Load` `IPersistStorage::Load` 。

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a>COleControl：： OnSetClientSite

當容器已呼叫控制項的函式時，由架構呼叫 `IOleControl::SetClientSite` 。

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>備註

根據預設， `OnSetClientSite` 會檢查是否已載入資料路徑屬性，如果有，則會呼叫 `DoDataPathPropExchange` 。

覆寫此函式，以對此通知執行任何特殊處理。 特別是，此函式的覆寫應該呼叫基類。

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a>COleControl：： OnSetData

由架構呼叫，以指定的資料取代控制項的資料。

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指定資料格式之[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)結構的指標。

*lpStgMedium*<br/>
資料所在之[STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1)結構的指標。

*bRelease*<br/>
如果控制項應該釋放儲存媒體，則為 TRUE;如果控制項不應釋放儲存媒體，則為 FALSE。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果資料是持續性屬性集格式，則預設的執行會據以修改控制項的狀態。 否則，預設的執行不會執行任何操作。 如果*bRelease*為 TRUE，則會對進行呼叫， `ReleaseStgMedium` 否則不會。

覆寫這個函式，以指定的資料取代控制項的資料。

如需詳細資訊，請 `FORMATETC` 參閱 `STGMEDIUM` Windows SDK 中的和結構。

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a>COleControl：： OnSetExtent

當控制項的範圍因呼叫[IOleObject：： SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent)而需要變更時，由架構呼叫。

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>參數

*lpSizeL*<br/>
結構的指標 `SIZEL` ，使用長整數來表示控制項的寬度和高度（以 HIMETRIC 單位表示）。

### <a name="return-value"></a>傳回值

若已接受大小變更，則為非零值;否則為0。

### <a name="remarks"></a>備註

預設的執行會處理控制項範圍的調整大小。 如果控制項為就地啟用，則會接著呼叫容器的 `OnPosRectChanged` 。

覆寫此函式，以變更控制項的預設大小。

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a>COleControl：： OnSetObjectRects

由架構呼叫來執行[IOleInPlaceObject：： SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)的呼叫。

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>參數

*lpRectPos*<br/>
結構的指標 `RECT` ，表示控制項的新位置和相對於容器的大小。

*lpRectClip*<br/>
結構的指標 `RECT` ，表示要裁剪控制項的矩形區域。

### <a name="return-value"></a>傳回值

如果已接受重新置放，則為非零值;否則為0。

### <a name="remarks"></a>備註

預設的執行會自動處理控制項視窗的重新置放和調整大小，並傳回 TRUE。

覆寫此函式以改變此函式的預設行為。

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a>COleControl：： OnShowToolBars

當控制項已啟用 UI 時，由架構呼叫。

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>備註

預設實作不做任何動作。

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a>COleControl：： OnTextChanged

當 stock 標題或 Text 屬性值變更時由架構呼叫。

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>備註

預設的執行會呼叫 `InvalidateControl` 。

如果您想要在此屬性變更之後發出通知，請覆寫此函數。

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a>COleControl：： OnWindowlessMessage

由架構呼叫以回應容器的 `IOleInPlaceObjectWindowless::OnWindowMessage` 要求。

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>參數

*msg*<br/>
Windows 所傳遞的訊息識別碼。

*wParam*<br/>
由 Windows 傳遞。 指定其他訊息特定資訊。 此參數的內容取決於*msg*參數的值。

*lParam*<br/>
由 Windows 傳遞。 指定其他訊息特定資訊。 此參數的內容取決於*msg*參數的值。

*plResult*<br/>
Windows 結果碼。 指定訊息處理的結果，並根據傳送的訊息而定。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

處理無視窗控制項的視窗訊息。 `COleControl``OnWindowlessMessage`應該用於滑鼠訊息和鍵盤訊息以外的視窗訊息。 `COleControl`提供[SetCapture](#setcapture)和[SetFocus](#setfocus) ，專門用來取得無視窗 OLE 物件的滑鼠捕捉和鍵盤焦點。

因為無視窗物件沒有視窗，所以它們需要一個機制，讓容器分派訊息給它們。 無視窗的 OLE 物件會透過 `OnWindowMessage` 介面上的方法 `IOleInPlaceObjectWindowless` （ [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject)的延伸模組），從其容器取得訊息。 `OnWindowMessage`不接受 `HWND` 參數。

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a>COleControl：:P arentToClient

將*pPoint*的座標轉譯為工作區座標。

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
容器內 OLE 控制項界限的指標。 不是工作區，而是整個控制項的區域，包括框線和捲軸。

*pPoint*<br/>
要轉譯為控制項工作區座標之父系（容器）點的指標。

*bHitTest*<br/>
指定是否要在點上執行點擊測試。

### <a name="return-value"></a>傳回值

如果*bHitTest*為 FALSE，則會傳回 HTNOWHERE。 如果*bHitTest*為 TRUE，則會傳回在 OLE 控制項的工作區中，父（容器）點進入，且為下列其中一個滑鼠點擊測試值的位置：

- 不具有調整大小框線的視窗框線中的 HTBORDER。

- 在視窗的下方水準框線中 HTBOTTOM。

- HTBOTTOMLEFT 在視窗框線的左下角。

- HTBOTTOMRIGHT 在視窗框線的右下角。

- 標題列區域中的 HTCAPTION。

- 在工作區中 HTCLIENT。

- HTERROR 在螢幕背景上，或在視窗之間的分隔線上（與 HTNOWHERE 相同，不同之處在于 `DefWndProc` windows 函式會產生系統嗶聲來表示錯誤）。

- 在 [大小] 方塊中 HTGROWBOX。

- 水準捲軸中的 HTHSCROLL。

- HTLEFT 在視窗的左邊框中。

- 在 [最大化] 按鈕中 HTMAXBUTTON。

- 在功能表區域中 HTMENU。

- 在 [最小化] 按鈕中 HTMINBUTTON。

- HTNOWHERE 在螢幕背景上，或在視窗之間的分隔線上。

- 在 [最小化] 按鈕中 HTREDUCE。

- HTRIGHT 在視窗的右框線中。

- [大小] 方塊中的 HTSIZE （與 HTGROWBOX 相同）。

- 在 [控制] 功能表或子視窗的 [關閉] 按鈕中 HTSYSMENU。

- 在視窗的上方水準框線中 HTTOP。

- HTTOPLEFT 在視窗框線的左上角。

- HTTOPRIGHT 在視窗框線的右上角。

- 在目前由另一個視窗所涵蓋的視窗中 HTTRANSPARENT。

- 垂直捲動條中的 HTVSCROLL。

- 在 [最大化] 按鈕中 HTZOOM。

### <a name="remarks"></a>備註

在輸入*pPoint*上，相對於父系的原點（容器的左上角）。 [輸出] *pPoint*上的相對於 OLE 控制項工作區的原點（控制項工作區的左上角）。

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a>COleControl：:P ostModalDialog

通知容器已關閉強制回應對話方塊。

```cpp
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>參數

*hWndParent*<br/>
強制回應對話方塊之父視窗的控制碼。

### <a name="remarks"></a>備註

在顯示任何強制回應對話方塊之後，呼叫此函式。 您必須呼叫此函式，讓容器可以啟用任何由停用的最上層 windows `PreModalDialog` 。 此函式應該與對的呼叫配對 `PreModalDialog` 。

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a>COleControl：:P reModalDialog

通知容器要顯示的強制回應對話方塊。

```cpp
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>參數

*hWndParent*<br/>
強制回應對話方塊之父視窗的控制碼。

### <a name="remarks"></a>備註

在顯示任何強制回應對話方塊之前呼叫此函式。 您必須呼叫此函式，讓容器可以停用其所有最上層視窗。 在顯示模式對話方塊之後，您必須呼叫 `PostModalDialog` 。

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a>COleControl：： RecreateControlWindow

終結並重新建立控制項的視窗。

```cpp
void RecreateControlWindow();
```

### <a name="remarks"></a>備註

如果您需要變更視窗的樣式位，這可能是必要的。

## <a name="colecontrolrefresh"></a><a name="refresh"></a>COleControl：： Refresh

強制重新繪製 OLE 控制項。

```cpp
void Refresh();
```

### <a name="remarks"></a>備註

基類支援此函式 `COleControl` 作為 stock 方法，稱為 Refresh。 這可讓您的 OLE 控制項的使用者在特定時間重新繪製控制項。 如需這個方法的詳細資訊，請參閱[ActiveX 控制項：方法](../../mfc/mfc-activex-controls-methods.md)一文。

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a>COleControl：： ReleaseCapture

釋放滑鼠捕捉。

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果控制項目前有滑鼠捕捉，則會釋放捕捉。 否則，此函式不會有任何作用。

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a>COleControl：： ReleaseDC

釋放無視窗控制項容器的顯示裝置內容，釋放裝置內容供其他應用程式使用。

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>參數

*pDC*<br/>
識別要釋放的容器裝置內容。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

應用程式必須在 `ReleaseDC` 每次呼叫[GetDC](#getdc)時呼叫。

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a>COleControl：： ReparentControlWindow

設定控制項的父系。

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>參數

*hWndOuter*<br/>
控制項視窗的控制碼。

*hWndParent*<br/>
新父視窗的控制碼。

### <a name="remarks"></a>備註

呼叫這個函式以重設控制項視窗的父系。

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a>COleControl：： ResetStockProps

將 stock 屬性的狀態初始化 `COleControl` 為其預設值。

```cpp
void ResetStockProps();
```

### <a name="remarks"></a>備註

屬性包括：外觀、背景色彩、BorderStyle、標題、已啟用、字型、前景、hWnd 和文字。 如需庫存屬性的說明，請參閱[ActiveX 控制項：加入](../../mfc/mfc-activex-controls-adding-stock-properties.md)內建屬性。

您可以使用和覆寫來改善控制項的二進位初始化效能 `ResetStockProps` `ResetVersion` `COleControl::OnResetState` 。 請參閱下方的範例。 如需優化初始化的進一步資訊，請參閱[ActiveX 控制項：優化](../../mfc/mfc-activex-controls-optimization.md)。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a>COleControl：： ResetVersion

將版本號碼初始化為指定的值。

```cpp
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>參數

*dwVersionDefault*<br/>
要指派給控制項的版本號碼。

### <a name="remarks"></a>備註

您可以使用和覆寫來改善控制項的二進位初始化效能 `ResetVersion` `ResetStockProps` `COleControl::OnResetState` 。 請參閱[ResetStockProps](#resetstockprops)的範例。 如需優化初始化的進一步資訊，請參閱[ActiveX 控制項：優化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a>COleControl：： ScrollWindow

允許無視窗的 OLE 物件在畫面上的就地現用影像中，滾動一個區域。

```cpp
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>參數

*xAmount*<br/>
指定水準滾動的數量（以裝置為單位）。 這個參數必須是負數值，才能向左滾動。

*yAmount*<br/>
指定垂直捲動的數量（以裝置為單位）。 這個參數必須是負數值，才能向上滾動。

*lpRect*<br/>
指向[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或 RECT 結構，指定要滾動之 OLE 物件工作區的部分（以包含視窗的用戶端座標為單位）。 如果*lpRect*為 Null，則會滾動整個 OLE 物件的工作區。

*lpClipRect*<br/>
指向 `CRect` 物件或 `RECT` 結構，指定要裁剪的矩形。 只會滾動矩形內的圖元。 矩形外的位不會受到影響，即使它們位於*lpRect*矩形中也一樣。 如果*lpClipRect*為 Null，則不會在捲軸矩形上執行任何裁剪。

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a>COleControl：： SelectFontObject

選取裝置內容中的字型。

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>參數

*pDC*<br/>
裝置內容物件的指標。

*fontHolder*<br/>
[CFontHolder](../../mfc/reference/cfontholder-class.md)物件的參考，代表要選取的字型。

### <a name="return-value"></a>傳回值

先前選取之字型的指標。 當呼叫端完成所有使用 FontHolder 的繪圖作業時 *，* 它應將先前選取的字型當做參數傳遞給[CDC：： SelectObject](../../mfc/reference/cdc-class.md#selectobject)。

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a>COleControl：： SelectStockFont

選取 [股票字型] 屬性到裝置內容中。

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>參數

*pDC*<br/>
將選取字型的裝置內容。

### <a name="return-value"></a>傳回值

先前選取之物件的指標 `CFont` 。 當您完成時，您應該使用[CDC：： SelectObject](../../mfc/reference/cdc-class.md#selectobject)來選取此字型回到裝置內容中。

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a>COleControl：： SerializeExtent

序列化或初始化分配給控制項之顯示空間的狀態。

```cpp
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>參數

*ar*<br/>
要在其中 `CArchive` 序列化的物件。

### <a name="remarks"></a>備註

您可以使用 `SerializeExtent` 、和覆寫，來改善控制項的二進位持續性效能 `SerializeStockProps` `SerializeVersion` `COleControl::Serialize` 。 請參閱下方的範例。 如需優化初始化的進一步資訊，請參閱[ActiveX 控制項：優化](../../mfc/mfc-activex-controls-optimization.md)。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a>COleControl：： SerializeStockProps

序列化或初始化 stock 屬性的狀態 `COleControl` ：外觀、背景色彩、BorderStyle、標題、已啟用、字型、前景和文字。

```cpp
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>參數

*ar*<br/>
要在其中 `CArchive` 序列化的物件。

### <a name="remarks"></a>備註

如需庫存屬性的說明，請參閱[ActiveX 控制項：加入](../../mfc/mfc-activex-controls-adding-stock-properties.md)內建屬性。

您可以使用 `SerializeStockProps` 、和覆寫，來改善控制項的二進位持續性效能 `SerializeExtent` `SerializeVersion` `COleControl::Serialize` 。 如需範例，請參閱程式碼，網址為[SerializeExtent](#serializeextent)。 如需優化初始化的進一步資訊，請參閱[ActiveX 控制項：優化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a>COleControl：： SerializeVersion

序列化或初始化控制項版本資訊的狀態。

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>參數

*ar*<br/>
要在其中 `CArchive` 序列化的物件。

*dwVersionDefault*<br/>
控制項的目前版本號碼。

*bConvert*<br/>
指出保存的資料是否應該在儲存時轉換成最新的格式，或以載入時所擁有的相同格式來進行維護。

### <a name="return-value"></a>傳回值

控制項的版本號碼。 如果指定的封存正在載入，則會傳回 `SerializeVersion` 從該封存載入的版本。 否則，它會傳回目前載入的版本。

### <a name="remarks"></a>備註

您可以使用 `SerializeVersion` 、和覆寫，來改善控制項的二進位持續性效能 `SerializeExtent` `SerializeStockProps` `COleControl::Serialize` 。 如需範例，請參閱程式碼，網址為[SerializeExtent](#serializeextent)。 如需優化初始化的進一步資訊，請參閱[ActiveX 控制項：優化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a>COleControl：： SetAppearance

設定控制項的存貨外觀屬性值。

```cpp
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>參數

*sAppearance*<br/>
**`short`** 要用於控制面板的（VT_I2）值。 值為零會將控制項的外觀設定為平面，而值為1會將控制項的外觀設定為3D。

### <a name="remarks"></a>備註

如需庫存屬性的詳細資訊，請參閱[ActiveX 控制項：屬性](../../mfc/mfc-activex-controls-properties.md)。

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a>COleControl：： SetBackColor

設定控制項的庫存背景色彩屬性值。

```cpp
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>參數

*dwBackColor*<br/>
要用於控制項之背景繪製的 OLE_COLOR 值。

### <a name="remarks"></a>備註

如需使用此屬性和其他相關屬性的詳細資訊，請參閱[ActiveX 控制項：屬性](../../mfc/mfc-activex-controls-properties.md)一文。

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a>COleControl：： SetBorderStyle

設定控制項的 [stock] 屬性值。

```cpp
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>參數

*sBorderStyle*<br/>
控制項的新框線樣式。0表示沒有框線，而1表示一般框線。

### <a name="remarks"></a>備註

接著會重新建立並呼叫控制項視窗 `OnBorderStyleChanged` 。

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a>COleControl：： SetCapture

使控制項的 [容器] 視窗代表控制項擁有滑鼠捕捉。

```
CWnd* SetCapture();
```

### <a name="return-value"></a>傳回值

`CWnd`先前收到滑鼠輸入之 window 物件的指標。

### <a name="remarks"></a>備註

如果控制項已啟動且無視窗，則此函式會讓控制項的容器視窗代表控制項擁有滑鼠捕捉。 否則，此函式會讓控制項本身擁有滑鼠捕捉（與相同 `CWnd::SetCapture` ）。

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a>COleControl：： SetControlSize

設定 OLE 控制項視窗的大小，並通知控制項網站正在變更的容器。

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>參數

*cx*<br/>
指定控制項的新寬度（以圖元為單位）。

*cy*<br/>
指定控制項的新高度（以圖元為單位）。

### <a name="return-value"></a>傳回值

如果呼叫成功，則為非零;否則為0。

### <a name="remarks"></a>備註

此函式不應在控制項的函式中使用。

請注意，控制項視窗的所有座標都會相對於控制項的左上角。

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a>COleControl：： SetEnabled

設定控制項的已啟用庫存屬性值。

```cpp
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>參數

*bEnabled*<br/>
如果要啟用控制項，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

設定這個屬性之後， `OnEnabledChange` 會呼叫。

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a>COleControl：： SetFocus

使控制項的 [容器] 視窗擁有代表控制項的輸入焦點。

```
CWnd* SetFocus();
```

### <a name="return-value"></a>傳回值

`CWnd`先前具有輸入焦點的 window 物件指標，如果沒有這種視窗，則為 Null。

### <a name="remarks"></a>備註

如果控制項已啟動且無視窗，則此函式會讓控制項的容器視窗代表控制項擁有輸入焦點。 輸入焦點會將鍵盤輸入導向容器的視窗，而容器會將所有後續的鍵盤訊息分派至呼叫的 OLE 物件 `SetFocus` 。 任何先前具有輸入焦點的視窗都會失去它。

如果控制項不是無視窗，則此函式會讓控制項本身擁有輸入焦點（與相同 `CWnd::SetFocus` ）。

## <a name="colecontrolsetfont"></a><a name="setfont"></a>COleControl：： SetFont

設定控制項的股票字型屬性。

```cpp
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>參數

*pFontDisp*<br/>
字型分派介面的指標。

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a>COleControl：： SetForeColor

設定控制項的存貨前景屬性值。

```cpp
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>參數

*dwForeColor*<br/>
要用於控制項前景繪製的 OLE_COLOR 值。

### <a name="remarks"></a>備註

如需使用此屬性和其他相關屬性的詳細資訊，請參閱[ActiveX 控制項：屬性](../../mfc/mfc-activex-controls-properties.md)一文。

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a>COleControl：： SetInitialDataFormats

由架構呼叫以初始化控制項支援的資料格式清單。

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>備註

預設的實值會指定兩個格式： CF_METAFILEPICT 和持續性屬性集。

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a>COleControl：： SetInitialSize

設定 OLE 控制項第一次顯示在容器中的大小。

```cpp
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>參數

*cx*<br/>
OLE 控制項的初始寬度（以圖元為單位）。

*cy*<br/>
OLE 控制項的初始高度（以圖元為單位）。

### <a name="remarks"></a>備註

在您的函式中呼叫此函式，以設定控制項的初始大小。 初始大小以裝置單位或圖元為單位。 建議您在控制項的函式中進行此呼叫。

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a>COleControl：： SetModifiedFlag

變更控制項的修改狀態。

```cpp
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>參數

*bModified*<br/>
控制項已修改旗標的新值。 TRUE 表示控制項的狀態已修改;FALSE 表示已儲存控制項的狀態。

### <a name="remarks"></a>備註

每當發生會影響控制項持續狀態的變更時，呼叫此函式。 例如，如果持續性屬性的值變更，請使用*bModified* **TRUE**來呼叫此函式。

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a>COleControl：： SetNotPermitted

指出編輯要求已失敗。

```cpp
void SetNotPermitted();
```

### <a name="remarks"></a>備註

當失敗時，呼叫此函式 `BoundPropertyRequestEdit` 。 此函式會擲回類型的例外狀況， `COleDispScodeException` 表示不允許設定作業。

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a>COleControl：： SetNotSupported

防止使用者修改控制項的屬性值。

```cpp
void SetNotSupported();
```

### <a name="remarks"></a>備註

呼叫此函式來取代任何屬性的 Set 函式，此函式不支援修改控制項使用者的屬性值。 其中一個範例是唯讀的屬性。

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a>COleControl：： SetRectInContainer

設定控制項相對於容器的矩形座標（以裝置單位表示）。

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
矩形的指標，其中包含控制項相對於容器的新座標。

### <a name="return-value"></a>傳回值

如果呼叫成功，則為非零;否則為0。

### <a name="remarks"></a>備註

如果控制項已開啟，則會調整大小;否則，會呼叫容器的函式 `OnPosRectChanged` 。

## <a name="colecontrolsettext"></a><a name="settext"></a>COleControl：： SetText

設定控制項的股票標題或文字屬性的值。

```cpp
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>參數

*pszText*<br/>
字元字串的指標。

### <a name="remarks"></a>備註

請注意，[內建標題] 和 [文字] 屬性都會對應到相同的值。 這表示對任一屬性進行的任何變更都會自動變更這兩個屬性。 一般來說，控制項應該支援 [內建標題] 或 [Text] 屬性，而不是兩者。

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a>COleControl：： ThrowError

表示控制項中發生錯誤的信號。

```cpp
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>參數

*sc*<br/>
要報告的狀態碼值。 如需可能程式碼的完整清單，請參閱[ActiveX 控制項： Advanced 主題](../../mfc/mfc-activex-controls-advanced-topics.md)文章。

*nDescriptionID*<br/>
要報告之例外狀況的字串資源識別碼。

*nHelpID*<br/>
要報告之主題的說明識別碼。

*pszDescription*<br/>
字串，其中包含要報告之例外狀況的說明。

### <a name="remarks"></a>備註

只有在 OLE 屬性的 Get 或 Set 函式或 OLE automation 方法的執行中，才能呼叫此函式。 如果您需要通知在其他時間發生的錯誤，您應該引發 stock 錯誤事件。

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a>COleControl：： TransformCoords

轉換 HIMETRIC 單位與容器原生單位之間的座標值。

```cpp
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>參數

*lpptlHimetric*<br/>
結構的指標， `POINTL` 包含 HIMETRIC 單位中的座標。

*lpptfContainer*<br/>
結構的指標， `POINTF` 其中包含容器單位大小中的座標。

*flags*<br/>
下列值的組合：

- XFORMCOORDS_POSITION 容器中的位置。

- XFORMCOORDS_SIZE 容器中的大小。

- XFORMCOORDS_HIMETRICTOCONTAINER 將 HIMETRIC 單位轉換為容器的單位。

- XFORMCOORDS_CONTAINERTOHIMETRIC 將容器的單位轉換成 HIMETRIC 單位。

### <a name="remarks"></a>備註

前兩個旗標，XFORMCOORDS_POSITION 和 XFORMCOORDS_SIZE，指出座標是否應視為位置或大小。 其餘的兩個旗標表示轉換的方向。

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a>COleControl：： TranslateColor

將色彩值從 OLE_COLOR 資料類型轉換成[COLORREF](/windows/win32/gdi/colorref)資料類型。

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>參數

*clrColor*<br/>
OLE_COLOR 的資料類型。 如需詳細資訊，請參閱 Windows [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor)函數。

*hpal*<br/>
選用調色板的控制碼;可以是 Null。

### <a name="return-value"></a>傳回值

RGB （紅色、綠色、藍色）32位色彩值，定義最接近裝置可代表之*clrColor*值的純色。

### <a name="remarks"></a>備註

這個函數適用于將內建前景和背景色彩屬性轉譯為[CDC](../../mfc/reference/cdc-class.md)成員函式所使用的 COLORREF 類型。

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a>COleControl：： WillAmbientsBeValidDuringLoad

決定您的控制項是否應使用環境屬性的值做為預設值，之後再從其持續性狀態載入。

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>傳回值

非零表示環境屬性將有效;否則環境屬性將會無效。

### <a name="remarks"></a>備註

在某些容器中，在對的覆寫初始呼叫期間，您的控制項可能無法存取其環境屬性 `COleControl::DoPropExchange` 。 如果容器在呼叫[IOleObject：： SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite)之前呼叫[IPersistStreamInit：： load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load)或[IPersistStorage：： load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) （也就是，如果不接受 OLEMISC_SETCLIENTSITEFIRST 狀態位），就會發生這種情況。

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a>COleControl：： WindowProc

提供物件的 Windows 程式 `COleControl` 。

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>參數

*message*<br/>
指定要處理的 Windows 訊息。

*wParam*<br/>
提供用來處理訊息的其他資訊。 參數值取決於訊息。

*lParam*<br/>
提供用來處理訊息的其他資訊。 參數值取決於訊息。

### <a name="return-value"></a>傳回值

已分派訊息的傳回值。

### <a name="remarks"></a>備註

呼叫此函式可透過控制項的訊息對應來分派特定訊息。

## <a name="see-also"></a>另請參閱

[MFC 範例 CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC 範例 TESTHELP](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage 類別](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd 類別](../../mfc/reference/cwnd-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder 類別](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder 類別](../../mfc/reference/cpictureholder-class.md)<br/>
