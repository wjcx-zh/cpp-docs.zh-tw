---
title: CToolBarCtrl 類別
ms.date: 11/04/2016
f1_keywords:
- CToolBarCtrl
- AFXCMN/CToolBarCtrl
- AFXCMN/CToolBarCtrl::CToolBarCtrl
- AFXCMN/CToolBarCtrl::AddBitmap
- AFXCMN/CToolBarCtrl::AddButtons
- AFXCMN/CToolBarCtrl::AddString
- AFXCMN/CToolBarCtrl::AddStrings
- AFXCMN/CToolBarCtrl::AutoSize
- AFXCMN/CToolBarCtrl::ChangeBitmap
- AFXCMN/CToolBarCtrl::CheckButton
- AFXCMN/CToolBarCtrl::CommandToIndex
- AFXCMN/CToolBarCtrl::Create
- AFXCMN/CToolBarCtrl::CreateEx
- AFXCMN/CToolBarCtrl::Customize
- AFXCMN/CToolBarCtrl::DeleteButton
- AFXCMN/CToolBarCtrl::EnableButton
- AFXCMN/CToolBarCtrl::GetAnchorHighlight
- AFXCMN/CToolBarCtrl::GetBitmap
- AFXCMN/CToolBarCtrl::GetBitmapFlags
- AFXCMN/CToolBarCtrl::GetButton
- AFXCMN/CToolBarCtrl::GetButtonCount
- AFXCMN/CToolBarCtrl::GetButtonInfo
- AFXCMN/CToolBarCtrl::GetButtonSize
- AFXCMN/CToolBarCtrl::GetColorScheme
- AFXCMN/CToolBarCtrl::GetDisabledImageList
- AFXCMN/CToolBarCtrl::GetDropTarget
- AFXCMN/CToolBarCtrl::GetExtendedStyle
- AFXCMN/CToolBarCtrl::GetHotImageList
- AFXCMN/CToolBarCtrl::GetHotItem
- AFXCMN/CToolBarCtrl::GetImageList
- AFXCMN/CToolBarCtrl::GetInsertMark
- AFXCMN/CToolBarCtrl::GetInsertMarkColor
- AFXCMN/CToolBarCtrl::GetItemRect
- AFXCMN/CToolBarCtrl::GetMaxSize
- AFXCMN/CToolBarCtrl::GetMaxTextRows
- AFXCMN/CToolBarCtrl::GetMetrics
- AFXCMN/CToolBarCtrl::GetPadding
- AFXCMN/CToolBarCtrl::GetPressedImageList
- AFXCMN/CToolBarCtrl::GetRect
- AFXCMN/CToolBarCtrl::GetRows
- AFXCMN/CToolBarCtrl::GetState
- AFXCMN/CToolBarCtrl::GetString
- AFXCMN/CToolBarCtrl::GetStyle
- AFXCMN/CToolBarCtrl::GetToolTips
- AFXCMN/CToolBarCtrl::HideButton
- AFXCMN/CToolBarCtrl::HitTest
- AFXCMN/CToolBarCtrl::Indeterminate
- AFXCMN/CToolBarCtrl::InsertButton
- AFXCMN/CToolBarCtrl::InsertMarkHitTest
- AFXCMN/CToolBarCtrl::IsButtonChecked
- AFXCMN/CToolBarCtrl::IsButtonEnabled
- AFXCMN/CToolBarCtrl::IsButtonHidden
- AFXCMN/CToolBarCtrl::IsButtonHighlighted
- AFXCMN/CToolBarCtrl::IsButtonIndeterminate
- AFXCMN/CToolBarCtrl::IsButtonPressed
- AFXCMN/CToolBarCtrl::LoadImages
- AFXCMN/CToolBarCtrl::MapAccelerator
- AFXCMN/CToolBarCtrl::MarkButton
- AFXCMN/CToolBarCtrl::MoveButton
- AFXCMN/CToolBarCtrl::PressButton
- AFXCMN/CToolBarCtrl::ReplaceBitmap
- AFXCMN/CToolBarCtrl::RestoreState
- AFXCMN/CToolBarCtrl::SaveState
- AFXCMN/CToolBarCtrl::SetAnchorHighlight
- AFXCMN/CToolBarCtrl::SetBitmapSize
- AFXCMN/CToolBarCtrl::SetButtonInfo
- AFXCMN/CToolBarCtrl::SetButtonSize
- AFXCMN/CToolBarCtrl::SetButtonStructSize
- AFXCMN/CToolBarCtrl::SetButtonWidth
- AFXCMN/CToolBarCtrl::SetCmdID
- AFXCMN/CToolBarCtrl::SetColorScheme
- AFXCMN/CToolBarCtrl::SetDisabledImageList
- AFXCMN/CToolBarCtrl::SetDrawTextFlags
- AFXCMN/CToolBarCtrl::SetExtendedStyle
- AFXCMN/CToolBarCtrl::SetHotImageList
- AFXCMN/CToolBarCtrl::SetHotItem
- AFXCMN/CToolBarCtrl::SetImageList
- AFXCMN/CToolBarCtrl::SetIndent
- AFXCMN/CToolBarCtrl::SetInsertMark
- AFXCMN/CToolBarCtrl::SetInsertMarkColor
- AFXCMN/CToolBarCtrl::SetMaxTextRows
- AFXCMN/CToolBarCtrl::SetMetrics
- AFXCMN/CToolBarCtrl::SetOwner
- AFXCMN/CToolBarCtrl::SetPadding
- AFXCMN/CToolBarCtrl::SetPressedImageList
- AFXCMN/CToolBarCtrl::SetRows
- AFXCMN/CToolBarCtrl::SetState
- AFXCMN/CToolBarCtrl::SetStyle
- AFXCMN/CToolBarCtrl::SetToolTips
- AFXCMN/CToolBarCtrl::SetWindowTheme
helpviewer_keywords:
- CToolBarCtrl [MFC], CToolBarCtrl
- CToolBarCtrl [MFC], AddBitmap
- CToolBarCtrl [MFC], AddButtons
- CToolBarCtrl [MFC], AddString
- CToolBarCtrl [MFC], AddStrings
- CToolBarCtrl [MFC], AutoSize
- CToolBarCtrl [MFC], ChangeBitmap
- CToolBarCtrl [MFC], CheckButton
- CToolBarCtrl [MFC], CommandToIndex
- CToolBarCtrl [MFC], Create
- CToolBarCtrl [MFC], CreateEx
- CToolBarCtrl [MFC], Customize
- CToolBarCtrl [MFC], DeleteButton
- CToolBarCtrl [MFC], EnableButton
- CToolBarCtrl [MFC], GetAnchorHighlight
- CToolBarCtrl [MFC], GetBitmap
- CToolBarCtrl [MFC], GetBitmapFlags
- CToolBarCtrl [MFC], GetButton
- CToolBarCtrl [MFC], GetButtonCount
- CToolBarCtrl [MFC], GetButtonInfo
- CToolBarCtrl [MFC], GetButtonSize
- CToolBarCtrl [MFC], GetColorScheme
- CToolBarCtrl [MFC], GetDisabledImageList
- CToolBarCtrl [MFC], GetDropTarget
- CToolBarCtrl [MFC], GetExtendedStyle
- CToolBarCtrl [MFC], GetHotImageList
- CToolBarCtrl [MFC], GetHotItem
- CToolBarCtrl [MFC], GetImageList
- CToolBarCtrl [MFC], GetInsertMark
- CToolBarCtrl [MFC], GetInsertMarkColor
- CToolBarCtrl [MFC], GetItemRect
- CToolBarCtrl [MFC], GetMaxSize
- CToolBarCtrl [MFC], GetMaxTextRows
- CToolBarCtrl [MFC], GetMetrics
- CToolBarCtrl [MFC], GetPadding
- CToolBarCtrl [MFC], GetPressedImageList
- CToolBarCtrl [MFC], GetRect
- CToolBarCtrl [MFC], GetRows
- CToolBarCtrl [MFC], GetState
- CToolBarCtrl [MFC], GetString
- CToolBarCtrl [MFC], GetStyle
- CToolBarCtrl [MFC], GetToolTips
- CToolBarCtrl [MFC], HideButton
- CToolBarCtrl [MFC], HitTest
- CToolBarCtrl [MFC], Indeterminate
- CToolBarCtrl [MFC], InsertButton
- CToolBarCtrl [MFC], InsertMarkHitTest
- CToolBarCtrl [MFC], IsButtonChecked
- CToolBarCtrl [MFC], IsButtonEnabled
- CToolBarCtrl [MFC], IsButtonHidden
- CToolBarCtrl [MFC], IsButtonHighlighted
- CToolBarCtrl [MFC], IsButtonIndeterminate
- CToolBarCtrl [MFC], IsButtonPressed
- CToolBarCtrl [MFC], LoadImages
- CToolBarCtrl [MFC], MapAccelerator
- CToolBarCtrl [MFC], MarkButton
- CToolBarCtrl [MFC], MoveButton
- CToolBarCtrl [MFC], PressButton
- CToolBarCtrl [MFC], ReplaceBitmap
- CToolBarCtrl [MFC], RestoreState
- CToolBarCtrl [MFC], SaveState
- CToolBarCtrl [MFC], SetAnchorHighlight
- CToolBarCtrl [MFC], SetBitmapSize
- CToolBarCtrl [MFC], SetButtonInfo
- CToolBarCtrl [MFC], SetButtonSize
- CToolBarCtrl [MFC], SetButtonStructSize
- CToolBarCtrl [MFC], SetButtonWidth
- CToolBarCtrl [MFC], SetCmdID
- CToolBarCtrl [MFC], SetColorScheme
- CToolBarCtrl [MFC], SetDisabledImageList
- CToolBarCtrl [MFC], SetDrawTextFlags
- CToolBarCtrl [MFC], SetExtendedStyle
- CToolBarCtrl [MFC], SetHotImageList
- CToolBarCtrl [MFC], SetHotItem
- CToolBarCtrl [MFC], SetImageList
- CToolBarCtrl [MFC], SetIndent
- CToolBarCtrl [MFC], SetInsertMark
- CToolBarCtrl [MFC], SetInsertMarkColor
- CToolBarCtrl [MFC], SetMaxTextRows
- CToolBarCtrl [MFC], SetMetrics
- CToolBarCtrl [MFC], SetOwner
- CToolBarCtrl [MFC], SetPadding
- CToolBarCtrl [MFC], SetPressedImageList
- CToolBarCtrl [MFC], SetRows
- CToolBarCtrl [MFC], SetState
- CToolBarCtrl [MFC], SetStyle
- CToolBarCtrl [MFC], SetToolTips
- CToolBarCtrl [MFC], SetWindowTheme
ms.assetid: 8f2f8ad2-05d7-4975-8715-3f2eed795248
ms.openlocfilehash: e62d1a6773e1b65eaa1d2f0a8050873c673b5039
ms.sourcegitcommit: 1839405b97036891b6e4d37c99def044d6f37eff
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/18/2020
ms.locfileid: "88561852"
---
# <a name="ctoolbarctrl-class"></a>CToolBarCtrl 類別

提供 Windows 工具列通用控制項的功能。

## <a name="syntax"></a>語法

```
class CToolBarCtrl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CToolBarCtrl：： CToolBarCtrl](#ctoolbarctrl)|建構 `CToolBarCtrl` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CToolBarCtrl：： AddBitmap](#addbitmap)|將一或多個點陣圖按鈕影像新增至工具列控制項可用的按鈕影像清單。|
|[CToolBarCtrl：： AddButtons](#addbuttons)|將一或多個按鈕加入至工具列控制項。|
|[CToolBarCtrl：： AddString](#addstring)|將作為資源識別碼傳遞的新字串新增至工具列的內部字串清單。|
|[CToolBarCtrl：： AddStrings](#addstrings)|將以 null 分隔字串緩衝區形式傳遞的新字串或字串，加入至工具列的字串的內部清單。|
|[CToolBarCtrl：： AutoSize](#autosize)|調整工具列控制項的大小。|
|[CToolBarCtrl：： ChangeBitmap](#changebitmap)|變更目前工具列控制項中按鈕的點陣圖。|
|[CToolBarCtrl：： CheckButton](#checkbutton)|檢查或清除工具列控制項中的指定按鈕。|
|[CToolBarCtrl：： CommandToIndex](#commandtoindex)|針對與指定的命令識別碼相關聯的按鈕，取得以零為基底的索引。|
|[CToolBarCtrl：： Create](#create)|建立工具列控制項並將其附加至 `CToolBarCtrl` 物件。|
|[CToolBarCtrl：： CreateEx](#createex)|建立具有指定之 Windows 擴充樣式的工具列控制項，並將其附加至 `CToolBarCtrl` 物件。|
|[CToolBarCtrl：：自訂](#customize)|顯示 [自訂工具列] 對話方塊。|
|[CToolBarCtrl：:D eleteButton](#deletebutton)|從工具列控制項刪除按鈕。|
|[CToolBarCtrl：： EnableButton](#enablebutton)|在工具列控制項中啟用或停用指定的按鈕。|
|[CToolBarCtrl：： GetAnchorHighlight](#getanchorhighlight)|抓取工具列的錨點醒目提示設定。|
|[CToolBarCtrl：： GetBitmap](#getbitmap)|抓取與工具列中的按鈕相關聯的點陣圖索引。|
|[CToolBarCtrl：： GetBitmapFlags](#getbitmapflags)|取得與工具列點陣圖相關聯的旗標。|
|[CToolBarCtrl：： GetButton](#getbutton)|抓取工具列控制項中指定之按鈕的相關資訊。|
|[CToolBarCtrl：： GetButtonCount](#getbuttoncount)|抓取工具列控制項中目前的按鈕計數。|
|[CToolBarCtrl：： GetButtonInfo](#getbuttoninfo)|抓取工具列中按鈕的資訊。|
|[CToolBarCtrl：： GetButtonSize](#getbuttonsize)|抓取工具列按鈕目前的寬度和高度（以圖元為單位）。|
|[CToolBarCtrl：： GetColorScheme](#getcolorscheme)|抓取目前工具列控制項的色彩配置。|
|[CToolBarCtrl：： GetDisabledImageList](#getdisabledimagelist)|抓取工具列控制項用來顯示停用按鈕的影像清單。|
|[CToolBarCtrl：： GetDropTarget](#getdroptarget)|抓取工具列控制項的 [IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) 介面。|
|[CToolBarCtrl：： GetExtendedStyle](#getextendedstyle)|抓取工具列控制項的延伸樣式。|
|[CToolBarCtrl：： GetHotImageList](#gethotimagelist)|抓取工具列控制項用來顯示「熱」按鈕的影像清單。 當滑鼠指標在上方時，就會反白顯示熱按鈕。|
|[CToolBarCtrl：： GetHotItem](#gethotitem)|抓取工具列中熱專案的索引。|
|[CToolBarCtrl：： GetImageList](#getimagelist)|抓取工具列控制項用來顯示其預設狀態之按鈕的影像清單。|
|[CToolBarCtrl：： GetInsertMark](#getinsertmark)|抓取工具列目前的插入標記。|
|[CToolBarCtrl：： GetInsertMarkColor](#getinsertmarkcolor)|抓取用來繪製工具列之插入標記的色彩。|
|[CToolBarCtrl：： GetItemRect](#getitemrect)|抓取工具列控制項中按鈕的周框。|
|[CToolBarCtrl：： GetMaxSize](#getmaxsize)|抓取工具列中所有可見按鈕和分隔符號的總大小。|
|[CToolBarCtrl：： GetMaxTextRows](#getmaxtextrows)|抓取工具列按鈕上顯示之文字資料列的最大數目。|
|[CToolBarCtrl：： GetMetrics](#getmetrics)|抓取工具列控制項的度量。|
|[CToolBarCtrl：： GetPadding](#getpadding)|抓取目前工具列控制項的水準和垂直邊框距離。|
|[CToolBarCtrl：： GetPressedImageList](#getpressedimagelist)|抓取目前的工具列控制項用來表示處於按下狀態之按鈕的影像清單。|
|[CToolBarCtrl：： GetRect](#getrect)|抓取指定之工具列按鈕的周框。|
|[CToolBarCtrl：： GetRows](#getrows)|抓取工具列中目前顯示之按鈕的列數。|
|[CToolBarCtrl：： >getstate](#getstate)|抓取工具列控制項中所指定按鈕的狀態相關資訊，例如是否啟用、按下或選取。|
|[CToolBarCtrl：： GetString](#getstring)|抓取工具列字串。|
|[CToolBarCtrl：： GetStyle](#getstyle)|抓取工具列控制項目前使用的樣式。|
|[CToolBarCtrl：： GetToolTips](#gettooltips)|抓取與工具列控制項相關聯之工具提示控制項（如果有的話）的控制碼。|
|[CToolBarCtrl：： HideButton](#hidebutton)|在工具列控制項中隱藏或顯示指定的按鈕。|
|[CToolBarCtrl：： System.windows.media.visualtreehelper.hittest](#hittest)|判中斷點位於工具列控制項中的位置。|
|[CToolBarCtrl：：不定](#indeterminate)|在工具列控制項中，設定或清除指定按鈕的不定 (灰色) 狀態。|
|[CToolBarCtrl：： InsertButton](#insertbutton)|在工具列控制項中插入按鈕。|
|[CToolBarCtrl：： InsertMarkHitTest](#insertmarkhittest)|抓取工具列中某個點的插入標記資訊。|
|[CToolBarCtrl：： IsButtonChecked](#isbuttonchecked)|指出是否已核取工具列控制項中指定的按鈕。|
|[CToolBarCtrl：： IsButtonEnabled](#isbuttonenabled)|指出是否已啟用工具列控制項中指定的按鈕。|
|[CToolBarCtrl：： IsButtonHidden](#isbuttonhidden)|指出是否隱藏工具列控制項中指定的按鈕。|
|[CToolBarCtrl：： IsButtonHighlighted](#isbuttonhighlighted)|檢查工具列按鈕的醒目提示狀態。|
|[CToolBarCtrl：： IsButtonIndeterminate](#isbuttonindeterminate)|指出工具列控制項中指定按鈕的狀態是否為不定 (灰色) 。|
|[CToolBarCtrl：： IsButtonPressed](#isbuttonpressed)|指出是否已按下工具列控制項中指定的按鈕。|
|[CToolBarCtrl：： LoadImages](#loadimages)|將點陣圖載入工具列控制項的影像清單。|
|[CToolBarCtrl：： MapAccelerator](#mapaccelerator)|將快速鍵字元對應至工具列按鈕。|
|[CToolBarCtrl：： MarkButton](#markbutton)|在工具列控制項中設定指定按鈕的醒目提示狀態。|
|[CToolBarCtrl：： MoveButton](#movebutton)|將按鈕從一個索引移至另一個索引。|
|[CToolBarCtrl：:P ressButton](#pressbutton)|在工具列控制項中按下或放開指定的按鈕。|
|[CToolBarCtrl：： ReplaceBitmap](#replacebitmap)|以新的點陣圖取代目前工具列控制項中的現有點陣圖。|
|[CToolBarCtrl：： RestoreState](#restorestate)|還原工具列控制項的狀態。|
|[CToolBarCtrl：： SaveState](#savestate)|儲存工具列控制項的狀態。|
|[CToolBarCtrl：： SetAnchorHighlight](#setanchorhighlight)|設定工具列的錨點醒目提示設定。|
|[CToolBarCtrl：： SetBitmapSize](#setbitmapsize)|設定要新增至工具列控制項之點陣圖影像的大小。|
|[CToolBarCtrl：： SetButtonInfo](#setbuttoninfo)|設定工具列中現有按鈕的資訊。|
|[CToolBarCtrl：： SetButtonSize](#setbuttonsize)|設定要新增至工具列控制項的按鈕大小。|
|[CToolBarCtrl：： SetButtonStructSize](#setbuttonstructsize)|指定結構的大小 `TBBUTTON` 。|
|[CToolBarCtrl：： SetButtonWidth](#setbuttonwidth)|設定工具列控制項中的最小和最大按鈕寬度。|
|[CToolBarCtrl：： SetCmdID](#setcmdid)|設定當按下指定的按鈕時，要傳送至擁有者視窗的命令識別碼。|
|[CToolBarCtrl：： SetColorScheme](#setcolorscheme)|設定目前工具列控制項的色彩配置。|
|[CToolBarCtrl：： SetDisabledImageList](#setdisabledimagelist)|設定工具列控制項將用來顯示停用按鈕的影像清單。|
|[CToolBarCtrl：： SetDrawTextFlags](#setdrawtextflags)|設定 Win32 函式 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)中的旗標，此旗標是用來繪製指定之矩形中的文字，並根據旗標的設定方式進行格式化。|
|[CToolBarCtrl：： SetExtendedStyle](#setextendedstyle)|設定工具列控制項的延伸樣式。|
|[CToolBarCtrl：： SetHotImageList](#sethotimagelist)|設定工具列控制項將用來顯示「熱」按鈕的影像清單。|
|[CToolBarCtrl：： SetHotItem](#sethotitem)|設定工具列中的熱專案。|
|[CToolBarCtrl：： SetImageList](#setimagelist)|設定工具列將用來顯示處於預設狀態之按鈕的影像清單。|
|[CToolBarCtrl：： SetIndent](#setindent)|設定工具列控制項中第一個按鈕的縮排。|
|[CToolBarCtrl：： SetInsertMark](#setinsertmark)|設定工具列的目前插入標記。|
|[CToolBarCtrl：： SetInsertMarkColor](#setinsertmarkcolor)|設定用來繪製工具列之插入標記的色彩。|
|[CToolBarCtrl：： SetMaxTextRows](#setmaxtextrows)|設定工具列按鈕上顯示之文字資料列的最大數目。|
|[CToolBarCtrl：： SetMetrics](#setmetrics)|設定工具列控制項的度量。|
|[CToolBarCtrl：： SetOwner](#setowner)|設定要從工具列控制項接收通知訊息的視窗。|
|[CToolBarCtrl：： SetPadding](#setpadding)|設定目前工具列控制項的水準和垂直邊框距離。|
|[CToolBarCtrl：： SetPressedImageList](#setpressedimagelist)|設定目前工具列控制項用來表示處於按下狀態之按鈕的影像清單。|
|[CToolBarCtrl：： SetRows](#setrows)|設定工具列中顯示的按鈕列數。|
|[CToolBarCtrl：： SetState](#setstate)|在工具列控制項中設定指定之按鈕的狀態。|
|[CToolBarCtrl：： >setstyle](#setstyle)|設定工具列控制項的樣式。|
|[CToolBarCtrl：： SetToolTips](#settooltips)|將工具提示控制項與工具列控制項產生關聯。|
|[CToolBarCtrl：： SetWindowTheme](#setwindowtheme)|設定工具列控制項的視覺化樣式。|

## <a name="remarks"></a>備註

此控制項 (，因此 `CToolBarCtrl` 類別) 僅適用于在 Windows 95/98 和 Windows NT 3.51 版和更新版本下執行的程式。

Windows 工具列通用控制項是包含一或多個按鈕的矩形子視窗。 這些按鈕可以顯示點陣圖影像、字串或兩者。 當使用者選擇按鈕時，會將命令訊息傳送至工具列的擁有者視窗。 通常，工具列中的按鈕會對應到應用程式功能表中的專案;它們提供更直接的方式讓使用者存取應用程式的命令。

`CToolBarCtrl` 物件包含幾個重要的內部資料結構：按鈕影像點陣圖的清單、影像清單、按鈕標籤字串清單，以及 `TBBUTTON` 用來將影像和/或字串與按鈕的位置、樣式、狀態和命令識別碼產生關聯的結構清單。 這些資料結構的每個專案都是由以零為基底的索引所參考。 在您可以使用 `CToolBarCtrl` 物件之前，您必須先設定這些資料結構。 字串清單只能用於按鈕標籤;您無法從工具列取出字串。

若要使用 `CToolBarCtrl` 物件，您通常會執行下列步驟：

1. 建構 `CToolBarCtrl` 物件。

1. 呼叫 [create](#create) 以建立 Windows 工具列通用控制項，並將其附加至 `CToolBarCtrl` 物件。 使用樣式（例如透明工具列的 TBSTYLE_TRANSPARENT，或支援下拉式樣式按鈕的工具列 TBSTYLE_DROPDOWN）來指出工具列的樣式。

1. 識別您想要如何顯示工具列上的按鈕：

   - 若要使用按鈕的點陣圖影像，請呼叫 [AddBitmap](#addbitmap)，將按鈕點陣圖新增至工具列。

   - 若要使用顯示自影像清單中的按鈕，請呼叫 [SetImageList](#setimagelist)、 [SetHotImageList](#sethotimagelist)或 [SetDisabledImageList](#setdisabledimagelist)來指定影像清單。

   - 若要使用按鈕的字串標籤，請呼叫 [AddString](#addstring) 和/或 [AddStrings](#addstrings)，將字串加入至工具列。

1. 藉由呼叫 [AddButtons](#addbuttons)，將按鈕結構加入工具列。

1. 如果您想要在非的主控視窗中使用工具列按鈕的工具提示 `CFrameWnd` ，您必須在工具列的 [擁有者] 視窗中處理 TTN_NEEDTEXT 的訊息，如 [處理工具提示通知](../../mfc/handling-tool-tip-notifications.md)中所述。 如果工具列的父視窗衍生自 `CFrameWnd` ，則會顯示工具提示，而不會產生任何額外的工作，因為 `CFrameWnd` 提供預設處理常式。

1. 如果您想要讓使用者能夠自訂工具列，請在主控視窗中處理自訂通知訊息，如 [處理自訂通知](../../mfc/handling-customization-notifications.md)中所述。

您可以使用 [SaveState](#savestate) 將工具列控制項的目前狀態儲存在登錄中，而 [RestoreState](#restorestate) 則會根據先前儲存在登錄中的資訊來還原狀態。 除了在應用程式的使用方式之間儲存工具列狀態以外，應用程式通常會在使用者開始自訂工具列之前儲存狀態，以防使用者稍後想要將工具列還原為其原始狀態。

## <a name="support-for-internet-explorer-version-40-and-later"></a>Internet Explorer 4.0 版和更新版本的支援

為了支援 Internet Explorer 4.0 和更新版本中引進的功能，MFC 提供了影像清單支援，以及工具列控制項的透明和平面樣式。

透明的工具列可讓工具列下的用戶端顯示。 若要建立透明的工具列，請使用 TBSTYLE_FLAT 和 TBSTYLE_TRANSPARENT 樣式。 透明工具列功能熱追蹤;也就是說，當滑鼠指標移至工具列上的熱按鈕時，按鈕的外觀會變更。 只使用 TBSTYLE_FLAT 樣式所建立的工具列會包含非透明的按鈕。

影像清單支援可讓您控制預設行為、熱影像和停用映射的更大彈性。 使用 [GetImageList](#getimagelist)、 [GetHotImageList](#gethotimagelist)和 [GetDisabledImageList](#getdisabledimagelist) 搭配透明工具列，以根據其狀態操作影像：

如需使用的詳細資訊 `CToolBarCtrl` ，請參閱 [控制項](../../mfc/controls-mfc.md) 和 [使用 CToolBarCtrl](../../mfc/using-ctoolbarctrl.md)。

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CToolBarCtrl`

## <a name="requirements"></a>規格需求

**標頭：** afxcmn.h

## <a name="ctoolbarctrladdbitmap"></a><a name="addbitmap"></a> CToolBarCtrl：： AddBitmap

將一或多個按鈕影像新增至工具列控制項中所儲存的按鈕影像清單。

```
int AddBitmap(
    int nNumButtons,
    UINT nBitmapID);

int AddBitmap(
    int nNumButtons,
    CBitmap* pBitmap);
```

### <a name="parameters"></a>參數

*nNumButtons*<br/>
點陣圖中的按鈕影像數目。

*nBitmapID*<br/>
包含要加入之按鈕影像或影像的點陣圖資源識別碼。

*pBitmap*<br/>
物件的指標，該 `CBitmap` 物件包含要加入的按鈕影像或影像。

### <a name="return-value"></a>傳回值

如果成功，則為第一個新影像以零為基底的索引;否則為-1。

### <a name="remarks"></a>備註

您可以使用 Windows API [CreateMappedBitmap](/windows/win32/api/commctrl/nf-commctrl-createmappedbitmap) 來對應色彩，然後再將點陣圖新增至工具列。 如果您傳遞物件的指標 `CBitMap` ，則必須先確定點陣圖未損毀，直到工具列終結為止。

## <a name="ctoolbarctrladdbuttons"></a><a name="addbuttons"></a> CToolBarCtrl：： AddButtons

將一或多個按鈕加入至工具列控制項。

```
BOOL AddButtons(
    int nNumButtons,
    LPTBBUTTON lpButtons);
```

### <a name="parameters"></a>參數

*nNumButtons*<br/>
要加入的按鈕數目。

*lpButtons*<br/>
結構陣列的位址 `TBBUTTON` ，其中包含要加入之按鈕的相關資訊。 陣列中的元素數目必須與 *nNumButtons*所指定的按鈕相同。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

*LpButtons*指標指向結構的陣列 `TBBUTTON` 。 每個 `TBBUTTON` 結構都會將加入的按鈕與按鈕的樣式、影像和/或字串、命令識別碼、狀態和使用者定義資料產生關聯：

```cpp
typedef struct _TBBUTTON {
    int iBitmap;    // zero-based index of button image
    int idCommand;  // command to be sent when button pressed
    BYTE fsState;   // button state--see below
    BYTE fsStyle;   // button style--see below
    DWORD dwData;   // application-defined value
    int iString;    // zero-based index of button label string
} TBBUTTON;
```

成員如下所示：

- `iBitmap`

   按鈕影像以零為基底的索引，如果沒有此按鈕的影像，則為-1。

- `idCommand`

   與按鈕相關聯的命令識別碼。 當您選擇此按鈕時，會在 WM_COMMAND 訊息中傳送此識別碼。 如果 `fsStyle` 成員具有 TBSTYLE_SEP 值，則這個成員必須為零。

- `fsState`

   按鈕狀態旗標。 它可以是下列值的組合：

  - TBSTATE_CHECKED 按鈕具有 TBSTYLE_CHECKED 樣式，且正在按下。

  - TBSTATE_ENABLED 按鈕接受使用者輸入。 沒有此狀態的按鈕不接受使用者輸入，而且會變成灰色。

  - TBSTATE_HIDDEN 不會顯示按鈕，也無法接收使用者輸入。

  - TBSTATE_INDETERMINATE 按鈕會呈現灰色。

  - TBSTATE_PRESSED 按下按鈕。

  - TBSTATE_WRAP 在按鈕之後的分行符號。 此按鈕也必須有 TBSTATE_ENABLED 狀態。

- `fsStyle`

   按鈕樣式。 它可以是下列值的組合：

  - TBSTYLE_BUTTON 建立標準的推播按鈕。

  - TBSTYLE_CHECK 會建立按鈕，在每次使用者按一下時，切換已按下和 unpressed 的狀態。 當按鈕處於按下狀態時，該按鈕具有不同的背景色彩。

  - TBSTYLE_CHECKGROUP 會在按下群組中的另一個按鈕之前，建立保持按下的複選按鈕。

  - TBSTYLE_GROUP 會建立保持按下的按鈕，直到按下群組中的另一個按鈕為止。

  - TBSTYLE_SEP 會建立分隔符號，在按鈕群組之間提供小間距。 具有此樣式的按鈕不會接收使用者輸入。

- `dwData`

   使用者定義資料。

- `iString`

   要做為按鈕標籤之字串的以零為起始的索引，如果沒有此按鈕的字串，則為-1。

您所提供之索引的影像和/或字串必須先前已使用 [AddBitmap](#addbitmap)、 [AddString](#addstring)和/或 [AddStrings](#addstrings)加入工具列控制項的清單中。

## <a name="ctoolbarctrladdstring"></a><a name="addstring"></a> CToolBarCtrl：： AddString

將作為資源識別碼傳遞的新字串新增至工具列的內部字串清單。

```
int AddString(UINT nStringID);
```

### <a name="parameters"></a>參數

*nStringID*<br/>
要加入工具列控制項字串清單中之字串資源的資源識別碼。

### <a name="return-value"></a>傳回值

如果成功，則為第一個新增字串的以零為基底的索引;否則為-1。

## <a name="ctoolbarctrladdstrings"></a><a name="addstrings"></a> CToolBarCtrl：： AddStrings

將新字串或字串加入至工具列控制項可用的字串清單。

```
int AddStrings(LPCTSTR lpszStrings);
```

### <a name="parameters"></a>參數

*lpszStrings*<br/>
緩衝區的位址，其中包含一個或多個以 null 終止的字串，以加入至工具列的字串清單。 最後一個字串必須以兩個 null 字元結束。

### <a name="return-value"></a>傳回值

如果成功，則為第一個新增字串的以零為基底的索引;否則為-1。

### <a name="remarks"></a>備註

緩衝區中的字串必須以 null 字元分隔。 您必須確認最後一個字串有兩個 null 結束字元。 若要適當地格式化常數位串，您可能會將它寫成：

[!code-cpp[NVC_MFCControlLadenDialog#72](../../mfc/codesnippet/cpp/ctoolbarctrl-class_1.cpp)]

或者：

[!code-cpp[NVC_MFCControlLadenDialog#73](../../mfc/codesnippet/cpp/ctoolbarctrl-class_2.cpp)]

您不應該將物件傳遞至此函式， `CString` 因為在中無法有一個以上的 null 字元 `CString` 。

## <a name="ctoolbarctrlautosize"></a><a name="autosize"></a> CToolBarCtrl：： AutoSize

調整整個工具列控制項的大小。

```cpp
void AutoSize();
```

### <a name="remarks"></a>備註

當父視窗的大小變更時，或當工具列的大小變更 (例如當您設定按鈕或點陣圖大小，或) 加入字串時，您應該呼叫此函式。

## <a name="ctoolbarctrlchangebitmap"></a><a name="changebitmap"></a> CToolBarCtrl：： ChangeBitmap

變更目前工具列控制項中按鈕的點陣圖。

```
BOOL ChangeBitmap(
    int idButton,
    int iBitmap);
```

### <a name="parameters"></a>參數

*idButton*\
在要接收新點陣圖之按鈕的命令識別碼。

*iBitmap*\
在在目前的工具列控制項影像清單中，影像以零為起始的索引。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

如果這個方法成功，系統會在指定的按鈕中顯示指定的影像。

這個方法會傳送 [TB_CHANGEBITMAP](/windows/win32/Controls/tb-changebitmap) 的訊息，如 Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會將 [**關於**] 按鈕的 [**儲存**] 按鈕點陣圖變更為點陣圖。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_3.cpp)]

## <a name="ctoolbarctrlcheckbutton"></a><a name="checkbutton"></a> CToolBarCtrl：： CheckButton

檢查或清除工具列控制項中的指定按鈕。

```
BOOL CheckButton(
    int nID,
    BOOL bCheck = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
要檢查或清除之按鈕的命令識別碼。

*bCheck*<br/>
TRUE 表示勾選按鈕，否則為 FALSE。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

核取按鈕後，就會出現已按下的狀態。 如果您想要變更一個以上的按鈕狀態，請考慮改為呼叫 [SetState](#setstate) 。

## <a name="ctoolbarctrlcommandtoindex"></a><a name="commandtoindex"></a> CToolBarCtrl：： CommandToIndex

針對與指定的命令識別碼相關聯的按鈕，取得以零為基底的索引。

```
UINT CommandToIndex(UINT nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
您要尋找其按鈕索引的命令識別碼。

### <a name="return-value"></a>傳回值

與命令識別碼相關聯之按鈕的以零為基底的索引。

### <a name="remarks"></a>備註

## <a name="ctoolbarctrlcreate"></a><a name="create"></a> CToolBarCtrl：： Create

建立工具列控制項並將其附加至 `CToolBarCtrl` 物件。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
指定工具列控制項的樣式。 工具列必須一律具有 WS_CHILD 樣式。 此外，您可以指定工具列樣式和視窗樣式的任意組合，如 [ **備註**] 底下所述。

*矩形*<br/>
（選擇性）指定工具列控制項的大小和位置。 它可以是 [CRect](../../atl-mfc-shared/reference/crect-class.md) 物件或 [RECT](/windows/win32/api/windef/ns-windef-rect) 結構。

*pParentWnd*<br/>
指定工具列控制項的父視窗。 它不得為 NULL。

*nID*<br/>
指定工具列控制項的識別碼。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

您可以 `CToolBarCtrl` 用兩個步驟來建立。 首先，呼叫此函式，然後呼叫 `Create` ，以建立工具列控制項並將其附加至 `CToolBarCtrl` 物件。 將下列視窗樣式套用至工具列控制項。

- 一律 WS_CHILD

- 通常 WS_VISIBLE

- WS_DISABLED 很少

如需視窗樣式的說明，請參閱 Windows SDK 中的 [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) 。

（選擇性）套用 [通用控制項樣式](/windows/win32/Controls/common-control-styles)的組合，如 Windows SDK 所述。

將工具列樣式的組合套用至控制項或按鈕本身。 樣式如 Windows SDK 中的主題 [工具列控制項和按鈕樣式](/windows/win32/Controls/toolbar-control-and-button-styles) 所述。

若要使用擴充的工具列樣式，請在呼叫之後呼叫 [SetExtendedStyle](#setextendedstyle) `Create` 。 若要建立具有擴充視窗樣式的工具列，請呼叫 [CToolBarCtrl：： CreateEx](#createex) 而不是 `Create` 。

工具列控制項會自動設定工具列視窗的大小和位置。 高度是以工具列中按鈕的高度為基礎。 寬度與父視窗工作區的寬度相同。 CCS_TOP 和 CCS_BOTTOM 的樣式會決定工具列是否位於工作區的頂端或底部。 依預設，工具列會有 CCS_TOP 的樣式。

## <a name="ctoolbarctrlcreateex"></a><a name="createex"></a> CToolBarCtrl：： CreateEx

 (子視窗) 建立控制項，並將它與物件產生關聯 `CToolBarCtrl` 。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwExStyle*<br/>
指定要建立之控制項的延伸樣式。 如需擴充 Windows 樣式的清單，請參閱 Windows SDK 中[CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw)的*dwExStyle*參數。

*dwStyle*<br/>
指定工具列控制項的樣式。 工具列必須一律具有 WS_CHILD 樣式。 此外，您可以依照 [[建立](#create)] 的 [**備註**] 區段中所述，指定任何工具列樣式和視窗樣式的組合。

*矩形*<br/>
[矩形](/windows/win32/api/windef/ns-windef-rect)結構的參考，描述要建立之視窗的大小和位置（以*pParentWnd*的用戶端座標表示）。

*pParentWnd*<br/>
視窗的指標，該視窗為控制項的父代。

*nID*<br/>
控制項的子視窗識別碼。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

使用 `CreateEx` instead Of [Create](#create) 來套用延伸的 windows 樣式（依 Windows 擴充樣式的 "前言 **WS_EX_** 指定）。 `CreateEx` 使用 *dwExStyle*所指定的擴充 Windows 樣式來建立控制項。 使用 [SetExtendedStyle](#setextendedstyle)設定控制項特定的擴充樣式。 例如，使用將 `CreateEx` 這類樣式設定為 WS_EX_CONTEXTHELP，但用 `SetExtendedStyle` 來將這類樣式設定為 TBSTYLE_EX_DRAWDDARROWS。 如需詳細資訊，請參閱 Windows SDK 中的 [工具列擴充樣式](/windows/win32/Controls/toolbar-extended-styles) 中所述的樣式。

## <a name="ctoolbarctrlctoolbarctrl"></a><a name="ctoolbarctrl"></a> CToolBarCtrl：： CToolBarCtrl

建構 `CToolBarCtrl` 物件。

```
CToolBarCtrl();
```

### <a name="remarks"></a>備註

您必須呼叫 [Create](#create) 才能讓工具列變成可用。

## <a name="ctoolbarctrlcustomize"></a><a name="customize"></a> CToolBarCtrl：：自訂

顯示 [自訂工具列] 對話方塊。

```cpp
void Customize();
```

### <a name="remarks"></a>備註

此對話方塊可讓使用者藉由新增和刪除按鈕來自訂工具列。 若要支援自訂，工具列的父視窗必須處理自訂通知訊息，如 [處理自訂通知](../../mfc/handling-customization-notifications.md)中所述。 您的工具列也必須使用 CCS_ADJUSTABLE 的樣式來建立，如 [CToolBarCtrl：： Create](#create)所述。

## <a name="ctoolbarctrldeletebutton"></a><a name="deletebutton"></a> CToolBarCtrl：:D eleteButton

從工具列控制項刪除按鈕。

```
BOOL DeleteButton(int nIndex);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
要刪除的按鈕之以零為基底的索引。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

## <a name="ctoolbarctrlenablebutton"></a><a name="enablebutton"></a> CToolBarCtrl：： EnableButton

在工具列控制項中啟用或停用指定的按鈕。

```
BOOL EnableButton(
    int nID,
    BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
要啟用或停用之按鈕的命令識別碼。

*bEnable*<br/>
TRUE 表示啟用按鈕;FALSE 表示停用按鈕。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

啟用按鈕之後，您可以按下並核取按鈕。 如果您想要變更一個以上的按鈕狀態，請考慮改為呼叫 [SetState](#setstate) 。

## <a name="ctoolbarctrlgetanchorhighlight"></a><a name="getanchorhighlight"></a> CToolBarCtrl：： GetAnchorHighlight

抓取工具列的錨點醒目提示設定。

```
BOOL GetAnchorHighlight() const;
```

### <a name="return-value"></a>傳回值

若為非零值，則會啟用錨點反白顯示。 如果為零，則會停用錨點反白顯示。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_GETANCHORHIGHLIGHT](/windows/win32/Controls/tb-getanchorhighlight)的行為。

## <a name="ctoolbarctrlgetbitmap"></a><a name="getbitmap"></a> CToolBarCtrl：： GetBitmap

抓取與工具列中的按鈕相關聯的點陣圖索引。

```
int GetBitmap(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
要取出其點陣圖索引之按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果成功，則傳回點陣圖的索引，否則為零。

### <a name="remarks"></a>備註

在 Windows SDK 中執行 [TB_GETBITMAP](/windows/win32/Controls/tb-getbitmap) 的功能。

## <a name="ctoolbarctrlgetbitmapflags"></a><a name="getbitmapflags"></a> CToolBarCtrl：： GetBitmapFlags

從工具列抓取點陣圖旗標。

```
UINT GetBitmapFlags() const;
```

### <a name="return-value"></a>傳回值

如果顯示器可以支援大型工具列點陣圖，則為已設定 TBBF_LARGE 旗標的 UINT，否則請清除。

### <a name="remarks"></a>備註

您應該在建立工具列之後，但在將點陣圖加入工具列之前呼叫它。 傳回值會指出顯示器是否支援大型點陣圖。 如果顯示器支援大型點陣圖，且您選擇使用它們，請先呼叫 [SetBitmapSize](#setbitmapsize) 和 [SetButtonSize](#setbuttonsize) ，然後再使用 [AddBitmap](#addbitmap)新增您的大型點陣圖。

## <a name="ctoolbarctrlgetbutton"></a><a name="getbutton"></a> CToolBarCtrl：： GetButton

抓取工具列控制項中指定之按鈕的相關資訊。

```
BOOL GetButton(
    int nIndex,
    LPTBBUTTON lpButton) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
以零為基底的按鈕索引，用來取得資訊。

*lpButton*<br/>
`TBBUTTON`接收按鈕資訊複本的結構位址。 如需結構的詳細資訊，請參閱 [CToolBarCtrl：： AddButtons](#addbuttons) `TBBUTTON` 。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

## <a name="ctoolbarctrlgetbuttoncount"></a><a name="getbuttoncount"></a> CToolBarCtrl：： GetButtonCount

抓取工具列控制項中目前的按鈕計數。

```
int GetButtonCount() const;
```

### <a name="return-value"></a>傳回值

按鈕的計數。

## <a name="ctoolbarctrlgetbuttoninfo"></a><a name="getbuttoninfo"></a> CToolBarCtrl：： GetButtonInfo

抓取工具列中按鈕的資訊。

```
int GetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
按鈕識別碼。

*ptbbi*<br/>
接收按鈕資訊之 [TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow) 結構的指標。

### <a name="return-value"></a>傳回值

如果成功，則為按鈕的以零為基底的索引;否則為-1。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_GETBUTTONINFO](/windows/win32/Controls/tb-getbuttoninfo)的行為。

## <a name="ctoolbarctrlgetbuttonsize"></a><a name="getbuttonsize"></a> CToolBarCtrl：： GetButtonSize

取得工具列按鈕的大小。

```
DWORD GetButtonSize() const;
```

### <a name="return-value"></a>傳回值

DWORD 值，分別包含 LOWORD 和 HIWORD 中的寬度和高度值。

## <a name="ctoolbarctrlgetbuttontext"></a><a name="getbuttontext"></a> CToolBarCtrl：： GetButtonText

抓取目前工具列控制項上指定按鈕的顯示文字。

```
CString GetButtonText(int idButton) const;
```

### <a name="parameters"></a>參數

*idButton*\
在要抓取其顯示文字之按鈕的識別碼。

### <a name="return-value"></a>傳回值

[CString](../../atl-mfc-shared/using-cstring.md) ，包含指定按鈕的顯示文字。

### <a name="remarks"></a>備註

這個方法會傳送 [TB_GETBUTTONTEXT](/windows/win32/Controls/tb-getbuttontext) 的訊息，如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetcolorscheme"></a><a name="getcolorscheme"></a> CToolBarCtrl：： GetColorScheme

抓取目前工具列控制項的色彩配置。

```
BOOL GetColorScheme(COLORSCHEME* lpColorScheme) const;
```

### <a name="parameters"></a>參數

*lpColorScheme*\
擴展 [COLORSCHEME](/windows/win32/api/commctrl/ns-commctrl-colorscheme) 結構的指標，此結構會接收色彩配置資訊。 當此方法傳回時，結構會描述工具列控制項的醒目提示色彩和陰影色彩。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送 [TB_GETCOLORSCHEME](/windows/win32/Controls/tb-getcolorscheme) 的訊息，如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetdisabledimagelist"></a><a name="getdisabledimagelist"></a> CToolBarCtrl：： GetDisabledImageList

抓取工具列控制項用來顯示停用按鈕的影像清單。

```
CImageList* GetDisabledImageList() const;
```

### <a name="return-value"></a>傳回值

[CImageList](../../mfc/reference/cimagelist-class.md)物件的指標，如果未設定任何已停用的影像清單，則為 Null。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_GETDISABLEDIMAGELIST](/windows/win32/Controls/tb-getdisabledimagelist)的行為。 的 MFC 實 `GetDisabledImageList` 使用 `CImageList` 包含工具列控制項按鈕影像的物件，而不是影像清單的控制碼。

## <a name="ctoolbarctrlgetdroptarget"></a><a name="getdroptarget"></a> CToolBarCtrl：： GetDropTarget

抓取工具列控制項的 [IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) 介面。

```
HRESULT GetDropTarget(IDropTarget** ppDropTarget) const;
```

### <a name="parameters"></a>參數

*ppDropTarget*<br/>
[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)介面指標的指標。 如果發生錯誤，則會在此位址中放置 Null 指標。

### <a name="return-value"></a>傳回值

傳回 HRESULT 值，指出作業成功或失敗。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_GETOBJECT](/windows/win32/Controls/tb-getobject)的行為。

## <a name="ctoolbarctrlgetextendedstyle"></a><a name="getextendedstyle"></a> CToolBarCtrl：： GetExtendedStyle

抓取工具列控制項的延伸樣式。

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>傳回值

DWORD，表示目前用於工具列控制項的延伸樣式。 如需樣式的清單，請參閱 Windows SDK 中的 [工具列延伸樣式](/windows/win32/Controls/toolbar-extended-styles)。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_GETEXTENDEDSTYLE](/windows/win32/Controls/tb-getextendedstyle)的行為。

## <a name="ctoolbarctrlgethotimagelist"></a><a name="gethotimagelist"></a> CToolBarCtrl：： GetHotImageList

抓取工具列控制項用來顯示「熱」按鈕的影像清單。 當滑鼠指標在上方時，就會反白顯示熱按鈕。

```
CImageList* GetHotImageList() const;
```

### <a name="return-value"></a>傳回值

[CImageList](../../mfc/reference/cimagelist-class.md)物件的指標，如果未設定任何已停用的影像清單，則為 Null。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_GETHOTIMAGELIST](/windows/win32/Controls/tb-gethotimagelist)的行為。 當滑鼠指標在上方時，就會反白顯示熱按鈕。

## <a name="ctoolbarctrlgethotitem"></a><a name="gethotitem"></a> CToolBarCtrl：： GetHotItem

抓取工具列中熱專案的索引。

```
int GetHotItem() const;
```

### <a name="return-value"></a>傳回值

工具列中熱專案的以零為基底的索引。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_GETHOTITEM](/windows/win32/Controls/tb-gethotitem)的行為。

## <a name="ctoolbarctrlgetimagelist"></a><a name="getimagelist"></a> CToolBarCtrl：： GetImageList

抓取工具列控制項用來顯示其預設狀態之按鈕的影像清單。

```
CImageList* GetImageList() const;
```

### <a name="return-value"></a>傳回值

[CImageList](../../mfc/reference/cimagelist-class.md)物件的指標; 如果未設定影像清單，則為 Null。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_GETIMAGELIST](/windows/win32/Controls/tb-getimagelist)的行為。

## <a name="ctoolbarctrlgetinsertmark"></a><a name="getinsertmark"></a> CToolBarCtrl：： GetInsertMark

抓取工具列目前的插入標記。

```cpp
void GetInsertMark(TBINSERTMARK* ptbim) const;
```

### <a name="parameters"></a>參數

*ptbim*<br/>
[TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark)結構的指標，此結構會接收插入標記。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_GETINSERTMARK](/windows/win32/Controls/tb-getinsertmark)的行為。

## <a name="ctoolbarctrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a> CToolBarCtrl：： GetInsertMarkColor

抓取用來繪製工具列之插入標記的色彩。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>傳回值

COLORRE光圈值，其中包含目前的插入標記色彩。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_GETINSERTMARKCOLOR](/windows/win32/Controls/tb-getinsertmarkcolor)的行為。

## <a name="ctoolbarctrlgetitemrect"></a><a name="getitemrect"></a> CToolBarCtrl：： GetItemRect

抓取工具列控制項中按鈕的周框。

```
BOOL GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
以零為基底的按鈕索引，用來取得資訊。

*lpRect*<br/>
[矩形](/windows/win32/api/windef/ns-windef-rect)結構或接收周框座標之[CRect](../../atl-mfc-shared/reference/crect-class.md)物件的位址。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

如果按鈕的 [狀態] 設定為 [TBSTATE_HIDDEN]，則此函式不會取得周框。

## <a name="ctoolbarctrlgetmaxsize"></a><a name="getmaxsize"></a> CToolBarCtrl：： GetMaxSize

抓取工具列中所有可見按鈕和分隔符號的總大小。

```
BOOL GetMaxSize(LPSIZE pSize) const;
```

### <a name="parameters"></a>參數

*pSize*<br/>
[大小](/windows/win32/api/windef/ns-windef-size)結構的指標，該結構會接收專案的大小。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_GETMAXSIZE](/windows/win32/Controls/tb-getmaxsize)的行為。

## <a name="ctoolbarctrlgetmaxtextrows"></a><a name="getmaxtextrows"></a> CToolBarCtrl：： GetMaxTextRows

抓取工具列按鈕上顯示之文字資料列的最大數目。

```
int GetMaxTextRows() const;
```

### <a name="return-value"></a>傳回值

工具列按鈕上顯示的文字資料列數目上限。

## <a name="ctoolbarctrlgetmetrics"></a><a name="getmetrics"></a> CToolBarCtrl：： GetMetrics

抓取物件的度量 `CToolBarCtrl` 。

```cpp
void GetMetrics(LPTBMETRICS ptbm) const;
```

### <a name="parameters"></a>參數

*ptbm*<br/>
物件之 [TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics) 結構的指標 `CToolBarCtrl` 。

### <a name="remarks"></a>備註

此成員函式會模擬 [TB_GETMETRICS](/windows/win32/Controls/tb-getmetrics) 訊息的功能，如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetpadding"></a><a name="getpadding"></a> CToolBarCtrl：： GetPadding

抓取目前工具列控制項的水準和垂直邊框距離。

```
BOOL GetPadding(
    int* pnHorzPadding,
    int* pnVertPadding) const;
```

### <a name="parameters"></a>參數

*pnHorzPadding*\
擴展以圖元為單位的整數，可接收工具列控制項的水準填補（以圖元為單位）。

*pnVertPadding*\
擴展以圖元為單位的整數，可接收工具列控制項的垂直填補。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送 [TB_GETPADDING](/windows/win32/Controls/tb-getpadding) 的訊息，如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetpressedimagelist"></a><a name="getpressedimagelist"></a> CToolBarCtrl：： GetPressedImageList

抓取目前的工具列控制項用來表示處於按下狀態之按鈕的影像清單。

```
CImageList* GetPressedImageList();
```

### <a name="return-value"></a>傳回值

[CImageList](../../mfc/reference/cimagelist-class.md)的指標，其中包含目前控制項的影像清單，如果沒有設定這類影像清單，則為 Null。

### <a name="remarks"></a>備註

這個方法會傳送 [TB_GETPRESSEDIMAGELIST](/windows/win32/Controls/tb-getpressedimagelist) 的訊息，如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetrect"></a><a name="getrect"></a> CToolBarCtrl：： GetRect

抓取指定之工具列按鈕的周框。

```
BOOL GetRect(
    int nID,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
按鈕識別碼。

*lpRect*<br/>
[矩形](/windows/win32/api/windef/ns-windef-rect)結構的指標，用來接收周框的資訊。

### <a name="return-value"></a>傳回值

如果成功，則為 TRUE，否則為 FALSE。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_GETRECT](/windows/win32/Controls/tb-getrect)的行為。

## <a name="ctoolbarctrlgetrows"></a><a name="getrows"></a> CToolBarCtrl：： GetRows

抓取工具列控制項目前顯示之按鈕的資料列數目。

```
int GetRows() const;
```

### <a name="return-value"></a>傳回值

目前顯示在工具列上的按鈕數目。

### <a name="remarks"></a>備註

請注意，除非使用 TBSTYLE_WRAPABLE 樣式建立工具列，否則資料列的數目一律會是1。

## <a name="ctoolbarctrlgetstate"></a><a name="getstate"></a> CToolBarCtrl：： >getstate

抓取工具列控制項中所指定按鈕的狀態相關資訊，例如是否啟用、按下或選取。

```
int GetState(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
要取得其資訊之按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果成功，則為按鈕狀態資訊，否則為-1。 按鈕狀態資訊可以是 [CToolBarCtrl：： AddButtons](#addbuttons)中所列的值組合。

### <a name="remarks"></a>備註

如果您想要取出一個以上的按鈕狀態，這個函數特別有用。 若要只取得一個狀態，請使用下列其中一個成員函式： [IsButtonEnabled](#isbuttonenabled)、 [IsButtonChecked](#isbuttonchecked)、 [IsButtonPressed](#isbuttonpressed)、 [IsButtonHidden](#isbuttonhidden)或 [IsButtonIndeterminate](#isbuttonindeterminate)。 不過，成員函式 `GetState` 是偵測 TBSTATE_WRAP 按鈕狀態的唯一方式。

## <a name="ctoolbarctrlgetstring"></a><a name="getstring"></a> CToolBarCtrl：： GetString

抓取工具列字串。

```
int GetString(
    int nString,
    LPTSTR lpstrString,
    int cchMaxLen) const;

int GetString(
    int nString,
    CString& str) const;
```

### <a name="parameters"></a>參數

*nString*<br/>
字串的索引。

*lpstrString*<br/>
用來傳回字串的緩衝區指標。

*cchMaxLen*<br/>
緩衝區的長度（以位元組為單位）。

*Str*<br/>
字串。

### <a name="return-value"></a>傳回值

如果成功，則為字串的長度，如果不成功，則為-1。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_GETSTRING](/windows/win32/Controls/tb-getstring)的行為。

## <a name="ctoolbarctrlgetstyle"></a><a name="getstyle"></a> CToolBarCtrl：： GetStyle

取得目前套用至工具列控制項的樣式。

```
DWORD GetStyle() const;
```

### <a name="return-value"></a>傳回值

DWORD，其中包含 [工具列控制項樣式](/windows/win32/Controls/toolbar-control-and-button-styles)的組合，如 Windows SDK 所述。

## <a name="ctoolbarctrlgettooltips"></a><a name="gettooltips"></a> CToolBarCtrl：： GetToolTips

抓取與工具列控制項相關聯之工具提示控制項（如果有的話）的控制碼。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>傳回值

與此工具列相關聯之 [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) 物件的指標; 如果工具列沒有相關聯的工具提示控制項，則為 Null。

### <a name="remarks"></a>備註

由於工具列控制項通常會建立和維護自己的工具提示控制項，因此大部分的程式都不需要呼叫此函式。

## <a name="ctoolbarctrlhittest"></a><a name="hittest"></a> CToolBarCtrl：： System.windows.media.visualtreehelper.hittest

判中斷點位於工具列控制項中的位置。

```
int HitTest(LPPOINT ppt) const;
```

### <a name="parameters"></a>參數

*Ppt*<br/>
[點](/windows/win32/api/windef/ns-windef-point)結構的指標，其中包含成員中點擊測試的 x 座標 `x` ，以及成員中點擊測試的 y 座標 `y` 。 座標是相對於工具列的工作區。

### <a name="return-value"></a>傳回值

整數值，指出工具列上某個點的位置。 如果值為零或正值，則這個傳回值是以零為起始的 nonseparator 專案索引，也就是點所在的位置。

如果傳回值為負數，則點不在按鈕中。 傳回值的絕對值是分隔符號專案或最接近 nonseparator 專案的索引。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_HITTEST](/windows/win32/Controls/tb-hittest)的行為。

## <a name="ctoolbarctrlhidebutton"></a><a name="hidebutton"></a> CToolBarCtrl：： HideButton

在工具列控制項中隱藏或顯示指定的按鈕。

```
BOOL HideButton(
    int nID,
    BOOL bHide = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
要隱藏或顯示之按鈕的命令識別碼。

*bHide*<br/>
TRUE 表示隱藏按鈕，否則為 FALSE。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

如果您想要變更一個以上的按鈕狀態，請考慮改為呼叫 [SetState](#setstate) 。

## <a name="ctoolbarctrlindeterminate"></a><a name="indeterminate"></a> CToolBarCtrl：：不定

在工具列控制項中設定或清除指定之按鈕的不定狀態。

```
BOOL Indeterminate(
    int nID,
    BOOL bIndeterminate = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
要設定或清除其不定狀態之按鈕的命令識別碼。

*bIndeterminate*<br/>
TRUE 表示為指定的按鈕設定不定狀態，否則為 FALSE。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

不定的按鈕會顯示為灰色，例如，當所選的文字同時包含粗體和一般字元時，文字處理器工具列上的粗體字按鈕會如何查看。 如果您想要變更一個以上的按鈕狀態，請考慮改為呼叫 [SetState](#setstate) 。

## <a name="ctoolbarctrlinsertbutton"></a><a name="insertbutton"></a> CToolBarCtrl：： InsertButton

在工具列控制項中插入按鈕。

```
BOOL InsertButton(
    int nIndex,
    LPTBBUTTON lpButton);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
以零為基底的按鈕索引。 此函式會將新按鈕插入此按鈕的左邊。

*lpButton*<br/>
結構的位址， `TBBUTTON` 其中包含要插入之按鈕的相關資訊。 如需結構的說明，請參閱 [CToolBarCtrl：： AddButtons](#addbuttons) `TBBUTTON` 。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

您所提供之索引的影像和/或字串必須先前已使用 [AddBitmap](#addbitmap)、 [AddString](#addstring)和/或 [AddStrings](#addstrings)加入工具列控制項的清單中。

## <a name="ctoolbarctrlinsertmarkhittest"></a><a name="insertmarkhittest"></a> CToolBarCtrl：： InsertMarkHitTest

抓取工具列中某個點的插入標記資訊。

```
BOOL InsertMarkHitTest(
    LPPOINT ppt,
    LPTBINSERTMARK ptbim) const;
```

### <a name="parameters"></a>參數

*Ppt*<br/>
[點](/windows/win32/api/windef/ns-windef-point)結構的指標，其中包含點擊測試座標（相對於工具列的工作區）。

*ptbim*<br/>
[TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark)結構的指標，此結構會接收插入標記資訊。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_INSERTMARKHITTEST](/windows/win32/Controls/tb-insertmarkhittest)的行為。

## <a name="ctoolbarctrlisbuttonchecked"></a><a name="isbuttonchecked"></a> CToolBarCtrl：： IsButtonChecked

決定是否選取工具列控制項中的指定按鈕。

```
BOOL IsButtonChecked(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
工具列中按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果已核取按鈕，則為非零;否則為零。

### <a name="remarks"></a>備註

如果您想要取出一個以上的按鈕狀態，請考慮呼叫 [>getstate](#getstate) 。

## <a name="ctoolbarctrlisbuttonenabled"></a><a name="isbuttonenabled"></a> CToolBarCtrl：： IsButtonEnabled

判斷是否已啟用工具列控制項中指定的按鈕。

```
BOOL IsButtonEnabled(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
工具列中按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果已啟用按鈕則為非零;否則為零。

### <a name="remarks"></a>備註

如果您想要取出一個以上的按鈕狀態，請考慮呼叫 [>getstate](#getstate) 。

## <a name="ctoolbarctrlisbuttonhidden"></a><a name="isbuttonhidden"></a> CToolBarCtrl：： IsButtonHidden

判斷是否隱藏工具列控制項中指定的按鈕。

```
BOOL IsButtonHidden(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
工具列中按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果按鈕是隱藏的，則為非零;否則為零。

### <a name="remarks"></a>備註

如果您想要取出一個以上的按鈕狀態，請考慮呼叫 [>getstate](#getstate) 。

## <a name="ctoolbarctrlisbuttonhighlighted"></a><a name="isbuttonhighlighted"></a> CToolBarCtrl：： IsButtonHighlighted

檢查工具列按鈕的醒目提示狀態。

```
BOOL IsButtonHighlighted(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
在工具列按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果按鈕已反白顯示，則為正整數，如果未反白顯示按鈕，則為 0; 如果發生錯誤，則為-1。

## <a name="ctoolbarctrlisbuttonindeterminate"></a><a name="isbuttonindeterminate"></a> CToolBarCtrl：： IsButtonIndeterminate

判斷工具列控制項中指定的按鈕是否不定。

```
BOOL IsButtonIndeterminate(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
在工具列中按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果按鈕是不定的，則為正整數，如果按鈕不是不定，則為零; 如果發生錯誤，則為-1。

### <a name="remarks"></a>備註

不定按鈕會顯示為暗灰色，例如，當選取的文字同時包含粗體和一般字元時，文字處理器工具列上的粗體字按鈕會如何查看。 如果您想要取出一個以上的按鈕狀態，請考慮呼叫 [>getstate](#getstate) 。

## <a name="ctoolbarctrlisbuttonpressed"></a><a name="isbuttonpressed"></a> CToolBarCtrl：： IsButtonPressed

決定是否按下工具列控制項中指定的按鈕。

```
BOOL IsButtonPressed(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
工具列中按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果已按下按鈕則為非零，否則為零。

### <a name="remarks"></a>備註

如果您想要取出一個以上的按鈕狀態，請考慮呼叫 [>getstate](#getstate) 。

## <a name="ctoolbarctrlloadimages"></a><a name="loadimages"></a> CToolBarCtrl：： LoadImages

將點陣圖載入工具列控制項的影像清單。

```cpp
void LoadImages(
    int iBitmapID,
    HINSTANCE hinst);
```

### <a name="parameters"></a>參數

*iBitmapID*<br/>
包含要載入之影像的點陣圖識別碼。 若要指定您自己的點陣圖資源，請將此參數設定為點陣圖資源的識別碼，並將 *hInst* 設定為 Null。 您的點陣圖資源將會以單一影像的形式新增至影像清單。 您可以將 *hinst* 設定為 HINST_COMMCTRL，並將此參數設定為下列其中一個識別碼，藉以新增標準的系統定義點陣圖：

|點陣圖識別碼|描述|
|---------------|-----------------|
|IDB_HIST_LARGE_COLOR|Explorer 點陣圖大小很大|
|IDB_HIST_SMALL_COLOR|Explorer 點陣圖（小型大小）|
|IDB_STD_LARGE_COLOR|大小較大的標準點陣圖|
|IDB_STD_SMALL_COLOR|小規模的標準點陣圖|
|IDB_VIEW_LARGE_COLOR|以大尺寸觀看點陣圖|
|IDB_VIEW_SMALL_COLOR|以小尺寸觀看點陣圖|

*hinst*<br/>
呼叫應用程式的程式實例控制碼。 您可以 HINST_COMMCTRL 這個參數載入標準影像清單。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_LOADIMAGES](/windows/win32/Controls/tb-loadimages)的行為。

## <a name="ctoolbarctrlmapaccelerator"></a><a name="mapaccelerator"></a> CToolBarCtrl：： MapAccelerator

將快速鍵字元對應至工具列按鈕。

```
BOOL MapAccelerator(
    TCHAR chAccel,
    UINT* pIDBtn);
```

### <a name="parameters"></a>參數

*chAccel*<br/>
要對應的快速鍵字元。 這個字元是按鈕文字中加上底線的相同字元。

*pIDBtn*<br/>
UINT 的指標，此指標會接收對應于 *chAccel*中所指定快速鍵的按鈕命令識別碼。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_MAPACCELERATOR](/windows/win32/Controls/tb-mapaccelerator)的行為。

## <a name="ctoolbarctrlmarkbutton"></a><a name="markbutton"></a> CToolBarCtrl：： MarkButton

在工具列控制項中設定指定按鈕的醒目提示狀態。

```
BOOL MarkButton(
    int nID,
    BOOL fHighlight = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
按鈕識別碼。

*fHighlight*<br/>
指定要設定的醒目提示狀態。 預設為 TRUE。 如果設定為 FALSE，則按鈕會設定為其預設狀態。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_MARKBUTTON](/windows/win32/Controls/tb-markbutton)的行為。

## <a name="ctoolbarctrlmovebutton"></a><a name="movebutton"></a> CToolBarCtrl：： MoveButton

將按鈕從一個索引移至另一個索引。

```
BOOL MoveButton(
    UINT nOldPos,
    UINT nNewPos);
```

### <a name="parameters"></a>參數

*nOldPos*<br/>
要移動之按鈕的以零為基底的索引。

*nNewPos*<br/>
按鈕目的地以零為基底的索引。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_MOVEBUTTON](/windows/win32/Controls/tb-movebutton)的行為。

## <a name="ctoolbarctrlpressbutton"></a><a name="pressbutton"></a> CToolBarCtrl：:P ressButton

在工具列控制項中按下或放開指定的按鈕。

```
BOOL PressButton(int nID, BOOL bPress = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
在要按或放開之按鈕的命令識別碼。

*bPress*<br/>
在TRUE 表示按下指定的按鈕;FALSE 表示釋放指定的按鈕。 預設值為 TRUE。

### <a name="return-value"></a>傳回值

如果方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

如果您想要變更一個以上的按鈕狀態，請考慮改為呼叫 [SetState](#setstate) 。

這個方法會傳送 [TB_PRESSBUTTON](/windows/win32/Controls/tb-pressbutton) 的訊息，如 Windows SDK 中所述。

## <a name="ctoolbarctrlreplacebitmap"></a><a name="replacebitmap"></a> CToolBarCtrl：： ReplaceBitmap

以新的點陣圖取代目前工具列控制項中的現有點陣圖。

```
BOOL ReplaceBitmap(LPTBREPLACEBITMAP pReplaceBitmap);
```

### <a name="parameters"></a>參數

*pReplaceBitmap*\
在描述要取代之點陣圖和新點陣圖的 [TBREPLACEBITMAP](/windows/win32/api/commctrl/ns-commctrl-tbreplacebitmap) 結構指標。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送 [TB_REPLACEBITMAP](/windows/win32/Controls/tb-replacebitmap) 的訊息，如 Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會以不同的點陣圖取代標準工具列的點陣圖。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_4.cpp)]

## <a name="ctoolbarctrlrestorestate"></a><a name="restorestate"></a> CToolBarCtrl：： RestoreState

從參數所指定之登錄中的位置，還原工具列控制項的狀態。

```cpp
void RestoreState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>參數

*hKeyRoot*<br/>
識別登錄中目前開啟的金鑰，或下列任何預先定義的保留控制碼值：

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
指向以 null 終止的字串，其中包含與值相關聯的子機碼名稱。 這個參數可以是 null 或空字串的指標。 如果參數為 Null，則會將值新增至 *hKeyRoot* 參數所識別的索引鍵。

*lpszValueName*<br/>
指向包含要取得之值名稱的字串。 如果索引鍵中沒有這個名稱的值，則函式會將它新增至索引鍵。

## <a name="ctoolbarctrlsavestate"></a><a name="savestate"></a> CToolBarCtrl：： SaveState

將工具列控制項的狀態儲存在參數所指定之登錄中的位置。

```cpp
void SaveState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>參數

*hKeyRoot*<br/>
識別登錄中目前開啟的金鑰，或下列任何預先定義的保留控制碼值：

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
指向以 null 終止的字串，其中包含與值相關聯的子機碼名稱。 這個參數可以是 null 或空字串的指標。 如果參數為 Null，則會將值新增至 *hKeyRoot* 參數所識別的索引鍵。

*lpszValueName*<br/>
指向包含要設定之值名稱的字串。 如果索引鍵中沒有這個名稱的值，則函式會將它新增至索引鍵。

## <a name="ctoolbarctrlsetanchorhighlight"></a><a name="setanchorhighlight"></a> CToolBarCtrl：： SetAnchorHighlight

設定工具列的錨點醒目提示設定。

```
BOOL SetAnchorHighlight(BOOL fAnchor = TRUE);
```

### <a name="parameters"></a>參數

*fAnchor*<br/>
在指定錨點反白顯示是否為啟用或停用。 如果此值為非零值，則會啟用錨點反白顯示。 如果此值為零，將會停用錨點反白顯示

### <a name="return-value"></a>傳回值

先前的錨定設定。 如果已啟用反白顯示，此值為非零值。 如果未啟用反白顯示，則此值為零。

### <a name="remarks"></a>備註

這個方法會執行 Win32 訊息 [TB_SETANCHORHIGHLIGHT](/windows/win32/Controls/tb-setanchorhighlight)的行為，如 Windows SDK 中所述。

## <a name="ctoolbarctrlsetbitmapsize"></a><a name="setbitmapsize"></a> CToolBarCtrl：： SetBitmapSize

設定要新增至工具列控制項之實際點陣圖影像的大小。

```
BOOL SetBitmapSize(CSize size);
```

### <a name="parameters"></a>參數

*size*<br/>
點陣圖影像的寬度和高度（以圖元為單位）。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

只有在將任何點陣圖新增至工具列之前，才必須呼叫此函式。 如果應用程式未明確設定點陣圖大小，則預設為 16 x 15 圖元。

## <a name="ctoolbarctrlsetbuttoninfo"></a><a name="setbuttoninfo"></a> CToolBarCtrl：： SetButtonInfo

設定工具列中現有按鈕的資訊。

```
BOOL SetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi);
```

### <a name="parameters"></a>參數

*nID*<br/>
按鈕識別碼。

*ptbbi*<br/>
接收按鈕資訊之 [TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow) 結構的指標。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

成員函式會執行 Win32 訊息 [TB_SETBUTTONINFO](/windows/win32/Controls/tb-setbuttoninfo)的行為，如 Windows SDK 中所述。

## <a name="ctoolbarctrlsetbuttonsize"></a><a name="setbuttonsize"></a> CToolBarCtrl：： SetButtonSize

設定工具列控制項中的按鈕大小。

```
BOOL SetButtonSize(CSize size);
```

### <a name="parameters"></a>參數

*size*<br/>
按鈕的寬度和高度（以圖元為單位）。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

按鈕大小一律必須至少和它所括住的點陣圖大小一樣大。 只有在將任何點陣圖新增至工具列之前，才必須呼叫此函式。 如果應用程式未明確設定按鈕大小，則預設為24乘以22圖元。

### <a name="example"></a>範例

  請參閱 [CToolBar：： GetToolBarCtrl](../../mfc/reference/ctoolbar-class.md#gettoolbarctrl)的範例。

## <a name="ctoolbarctrlsetbuttonstructsize"></a><a name="setbuttonstructsize"></a> CToolBarCtrl：： SetButtonStructSize

指定結構的大小 `TBBUTTON` 。

```cpp
void SetButtonStructSize(int nSize);
```

### <a name="parameters"></a>參數

*nSize*<br/>
結構的大小（以位元組為單位） `TBBUTTON` 。

### <a name="remarks"></a>備註

如果您想要在結構中儲存額外的資料 `TBBUTTON` ，您可以從衍生新的結構 `TBBUTTON` 、加入您需要的成員，或建立包含 `TBBUTTON` 結構作為其第一個成員的新結構。 然後您會呼叫這個函式，告訴工具列控制項新結構的大小。

如需結構的詳細資訊，請參閱 [CToolBarCtrl：： AddButtons](#addbuttons) `TBBUTTON` 。

## <a name="ctoolbarctrlsetbuttonwidth"></a><a name="setbuttonwidth"></a> CToolBarCtrl：： SetButtonWidth

設定工具列控制項中的最小和最大按鈕寬度。

```
BOOL SetButtonWidth(
    int cxMin,
    int cxMax);
```

### <a name="parameters"></a>參數

*cxMin*<br/>
按鈕寬度下限（以圖元為單位）。 工具列按鈕絕不會比這個值窄。

*cxMax*<br/>
最大按鈕寬度（以圖元為單位）。 如果按鈕文字太寬，控制項會以省略號點顯示。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_SETBUTTONWIDTH](/windows/win32/Controls/tb-setbuttonwidth)的行為。

## <a name="ctoolbarctrlsetcmdid"></a><a name="setcmdid"></a> CToolBarCtrl：： SetCmdID

設定當按下指定的按鈕時，將傳送至主控視窗的命令識別碼。

```
BOOL SetCmdID(
    int nIndex,
    UINT nID);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
要設定其命令識別碼之按鈕的以零為基底的索引。

*nID*<br/>
要將選取的按鈕設定為的命令識別碼。

### <a name="return-value"></a>傳回值

如果成功，則傳回非零;否則為零。

## <a name="ctoolbarctrlsetcolorscheme"></a><a name="setcolorscheme"></a> CToolBarCtrl：： SetColorScheme

設定目前工具列控制項的色彩配置。

```cpp
void SetColorScheme(const COLORSCHEME* lpColorScheme);
```

### <a name="parameters"></a>參數

*lpColorScheme*\
在 [COLORSCHEME](/windows/win32/api/commctrl/ns-commctrl-colorscheme) 結構的指標，描述工具列控制項的醒目提示色彩和陰影色彩。

### <a name="remarks"></a>備註

如果已設定 Windows Vista 視覺效果主題，則這個方法不會有任何作用。

這個方法會傳送 [TB_SETCOLORSCHEME](/windows/win32/Controls/tb-setcolorscheme) 的訊息，如 Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會設定目前工具列控制項的色彩配置。 程式碼範例會讓每個工具按鈕的左邊和上邊緣成為紅色，右邊和下邊緣藍色。 當使用者按下按鈕時，按鈕的紅色邊緣會變成藍色，而其藍色邊緣會變成紅色。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_5.cpp)]

## <a name="ctoolbarctrlsetdisabledimagelist"></a><a name="setdisabledimagelist"></a> CToolBarCtrl：： SetDisabledImageList

設定工具列控制項將用來顯示停用按鈕的影像清單。

```
CImageList* SetDisabledImageList(CImageList* pImageList);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
物件的指標，該 `CImageList` 物件包含工具列控制項用來顯示已停用按鈕影像的影像。

### <a name="return-value"></a>傳回值

[CImageList](../../mfc/reference/cimagelist-class.md)物件的指標，該物件先前由工具列控制項用來顯示停用的按鈕影像。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_SETDISABLEDIMAGELIST](/windows/win32/Controls/tb-setdisabledimagelist)的行為。 的 MFC 實 `SetDisabledImageList` 使用 `CImageList` 包含工具列控制項停用按鈕影像的物件，而不是影像清單的控制碼。

## <a name="ctoolbarctrlsetdrawtextflags"></a><a name="setdrawtextflags"></a> CToolBarCtrl：： SetDrawTextFlags

設定 Win32 函式 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)中的旗標，此旗標是用來繪製指定之矩形中的文字，並根據旗標的設定方式進行格式化。

```
DWORD SetDrawTextFlags(
    DWORD dwMask,
    DWORD dwDTFlags);
```

### <a name="parameters"></a>參數

*dwMask*<br/>
一或多個 DT_ 旗標的組合，指定于 Win32 函式 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)中，表示在繪製文字時，將使用 *dwDTFlags* 中的哪個位。

*dwDTFlags*<br/>
Win32 函式中指定的一或多個 DT_ 旗標的組合， `DrawText` 指出按鈕文字的繪製方式。 此值會在 `DrawText` 繪製按鈕文字時傳遞給。

### <a name="return-value"></a>傳回值

包含先前文字繪圖旗標的 DWORD。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_SETDRAWTEXTFLAGS](/windows/win32/Controls/tb-setdrawtextflags)的行為。 此成員函式會在 Win32 函式中設定旗標，此函式 `DrawText` 會在指定的矩形中繪製文字，並根據旗標的設定方式進行格式化。

## <a name="ctoolbarctrlsetextendedstyle"></a><a name="setextendedstyle"></a> CToolBarCtrl：： SetExtendedStyle

設定工具列控制項的延伸樣式。

```
DWORD SetExtendedStyle(DWORD dwExStyle);
```

### <a name="parameters"></a>參數

*dwExStyle*<br/>
值，指定新的延伸樣式。 這個參數可以是工具列延伸樣式的組合。

### <a name="return-value"></a>傳回值

表示先前擴充樣式的 DWORD。 如需樣式的清單，請參閱 Windows SDK 中的 [工具列延伸樣式](/windows/win32/Controls/toolbar-extended-styles)。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_SETEXTENDEDSTYLE](/windows/win32/Controls/tb-setextendedstyle)的行為。

## <a name="ctoolbarctrlsethotimagelist"></a><a name="sethotimagelist"></a> CToolBarCtrl：： SetHotImageList

設定工具列控制項將用來顯示「熱」按鈕的影像清單。

```
CImageList* SetHotImageList(CImageList* pImageList);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
物件的指標，該 `CImageList` 物件包含工具列控制項用來顯示熱按鈕影像的影像。

### <a name="return-value"></a>傳回值

[CImageList](../../mfc/reference/cimagelist-class.md)物件的指標，該物件先前由工具列控制項用來顯示熱按鈕影像。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_SETHOTIMAGELIST](/windows/win32/Controls/tb-sethotimagelist)的行為。

的 MFC 實 `SetHotImageList` 使用 `CImageList` 包含工具列控制項之熱按鈕影像的物件，而不是影像清單的控制碼。 當指標在上方時，[熱] 按鈕會反白顯示。

## <a name="ctoolbarctrlsethotitem"></a><a name="sethotitem"></a> CToolBarCtrl：： SetHotItem

設定工具列中的熱專案。

```
int SetHotItem(int nHot);
```

### <a name="parameters"></a>參數

*nHot*<br/>
將設為經常性存取之專案的以零為基底的索引編號。 如果這個值是-1，則沒有任何專案會是經常性的。

### <a name="return-value"></a>傳回值

先前熱專案的索引，如果沒有熱專案，則為-1。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_SETHOTITEM](/windows/win32/Controls/tb-sethotitem)的行為。

## <a name="ctoolbarctrlsetimagelist"></a><a name="setimagelist"></a> CToolBarCtrl：： SetImageList

設定工具列將用來顯示處於預設狀態之按鈕的影像清單。

```
CImageList* SetImageList(CImageList* pImageList);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
物件的指標，該 `CImageList` 物件包含工具列控制項在其預設狀態下顯示按鈕影像時所要使用的影像。

### <a name="return-value"></a>傳回值

[CImageList](../../mfc/reference/cimagelist-class.md)物件的指標，該物件先前由工具列控制項用來顯示其預設狀態下的按鈕影像。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_SETIMAGELIST](/windows/win32/Controls/tb-setimagelist)的行為。

的 MFC 實 `SetImageList` 使用 `CImageList` 包含工具列控制項按鈕影像的物件，而不是影像清單的控制碼。

## <a name="ctoolbarctrlsetindent"></a><a name="setindent"></a> CToolBarCtrl：： SetIndent

設定工具列控制項中第一個按鈕的縮排。

```
BOOL SetIndent(int iIndent);
```

### <a name="parameters"></a>參數

*iIndent*<br/>
指定縮排的值（以圖元為單位）。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

## <a name="ctoolbarctrlsetinsertmark"></a><a name="setinsertmark"></a> CToolBarCtrl：： SetInsertMark

設定工具列的目前插入標記。

```cpp
void SetInsertMark(TBINSERTMARK* ptbim);
```

### <a name="parameters"></a>參數

*ptbim*<br/>
包含插入標記之 [TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark) 結構的指標。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_SETINSERTMARK](/windows/win32/Controls/tb-setinsertmark)的行為。

## <a name="ctoolbarctrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a> CToolBarCtrl：： SetInsertMarkColor

設定用來繪製工具列之插入標記的色彩。

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>參數

*clrNew*<br/>
包含新插入標記色彩的 COLORRE光圈值。

### <a name="return-value"></a>傳回值

COLORRE光圈值，其中包含先前的插入標記色彩。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TB_SETINSERTMARKCOLOR](/windows/win32/Controls/tb-setinsertmarkcolor)的行為。

## <a name="ctoolbarctrlsetmaxtextrows"></a><a name="setmaxtextrows"></a> CToolBarCtrl：： SetMaxTextRows

設定工具列按鈕上顯示之文字資料列的最大數目。

```
BOOL SetMaxTextRows(int iMaxRows);
```

### <a name="parameters"></a>參數

*iMaxRows*<br/>
要設定的資料列數目上限。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

## <a name="ctoolbarctrlsetmetrics"></a><a name="setmetrics"></a> CToolBarCtrl：： SetMetrics

設定物件的度量 `CToolBarCtrl` 。

```cpp
void SetMetrics(LPTBMETRICS ptbm);
```

### <a name="parameters"></a>參數

*ptbm*<br/>
物件之 [TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics) 結構的指標 `CToolBarCtrl` 。

### <a name="remarks"></a>備註

此成員函式會模擬 [TB_SETMETRICS](/windows/win32/Controls/tb-setmetrics) 訊息的功能，如 Windows SDK 中所述。

## <a name="ctoolbarctrlsetowner"></a><a name="setowner"></a> CToolBarCtrl：： SetOwner

設定工具列控制項的擁有者視窗。

```cpp
void SetOwner(CWnd* pWnd);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
指向 `CWnd` 或 `CWnd` 衍生物件的指標，該物件將成為工具列控制項的新擁有者視窗。

### <a name="remarks"></a>備註

擁有者視窗是從工具列接收通知的視窗。

## <a name="ctoolbarctrlsetpadding"></a><a name="setpadding"></a> CToolBarCtrl：： SetPadding

設定目前工具列控制項的水準和垂直邊框距離。

```
DWORD SetPadding(
    int nHorzPadding,
    int nVertPadding);
```

### <a name="parameters"></a>參數

*nHorzPadding*\
在指定工具列控制項的水準填補（以圖元為單位）。

*nVertPadding*\
在指定工具列控制項的垂直填補（以圖元為單位）。

### <a name="return-value"></a>傳回值

DWORD，其下限字包含先前的水準填補值，且最大的單字包含先前的垂直填補值。 填補值是以圖元為單位。

### <a name="remarks"></a>備註

這個方法會傳送 [TB_SETPADDING](/windows/win32/Controls/tb-setpadding) 的訊息，如 Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會將目前工具列控制項的水準和垂直填補設定為20圖元。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_6.cpp)]

## <a name="ctoolbarctrlsetpressedimagelist"></a><a name="setpressedimagelist"></a> CToolBarCtrl：： SetPressedImageList

設定目前工具列控制項用來表示處於按下狀態之按鈕的影像清單。

```
CImagelist* SetPressedImageList(
    int iImageID,
    CImageList* pImageList);
```

### <a name="parameters"></a>參數

*iImageID*\
在影像清單之以零為起始的索引。 如果您只使用一個影像清單，請將此參數設定為零。

*pImageList*\
在 [CImageList](../../mfc/reference/cimagelist-class.md) 的指標，其中包含新的影像清單。

### <a name="return-value"></a>傳回值

[CImageList](../../mfc/reference/cimagelist-class.md)的指標，其中包含目前控制項的先前影像清單，如果沒有設定這類影像清單，則為 Null。

### <a name="remarks"></a>備註

這個方法會傳送 [TB_SETPRESSEDIMAGELIST](/windows/win32/Controls/tb-setpressedimagelist) 的訊息，如 Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會將按下的影像清單設定為與預設影像清單相同。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_7.cpp)]

## <a name="ctoolbarctrlsetrows"></a><a name="setrows"></a> CToolBarCtrl：： SetRows

要求工具列控制項將本身的大小調整為要求的資料列數目。

```cpp
void SetRows(
    int nRows,
    BOOL bLarger,
    LPRECT lpRect);
```

### <a name="parameters"></a>參數

*nRows*<br/>
要求的資料列數目。

*bLarger*<br/>
當工具列無法調整為要求的資料列數目時，指出是否要使用更多的資料列或較少的資料列。

*lpRect*<br/>
指向將接收工具列新周框矩形的 [CRect](../../atl-mfc-shared/reference/crect-class.md) 物件或 [RECT](/windows/win32/api/windef/ns-windef-rect) 結構。

### <a name="remarks"></a>備註

如果工具列無法將自己的大小調整為所要求的數目或資料列，它會根據 *bLarger*的值，將本身調整為下一個較大或下一個較小的有效大小。 如果 *bLarger* 為 TRUE，新的資料列數目將會大於所要求的數目。 如果 *bLarger* 為 FALSE，則新的資料列數目會小於要求的數目。

如果按鈕可以排列，則指定的資料列數目對工具列而言是有效的，因為所有資料列都有相同數目的按鈕 (除了最後一個資料列) 。 例如，包含四個按鈕的工具列無法調整大小為三個數據列，因為最後兩個數據列的長度必須較短。 如果您嘗試將其大小調整為三個數據列，則如果 *bLarger* 為 TRUE，則會收到四個數據列，而如果 *bLarger* 為 FALSE，則會得到兩個

如果工具列中有分隔符號，當指定的資料列數目有效時，規則會比較複雜。 系統會計算版面配置，讓按鈕群組 (按鈕群組，而群組中的最後一個按鈕) 永遠不會在多個資料列上中斷，除非該群組無法容納在一個資料列。

如果群組不符合某個資料列，則會在下一個資料列上啟動下一個群組，即使該群組適合大型群組結束的資料列。 這項規則的目的是要讓大型群組之間的分隔更加明顯。 產生的垂直分隔符號會計算為數據列。

另請注意， `SetRows` 成員函式一律會選擇會產生最小工具欄大小的版面配置。 使用 TBSTYLE_WRAPABLE 樣式建立工具列，然後調整控制項的大小，只會套用上面所述的方法，並指定控制項的寬度。

只有使用 TBSTYLE_WRAPABLE 樣式所建立的工具列，才能呼叫此函式。

## <a name="ctoolbarctrlsetstate"></a><a name="setstate"></a> CToolBarCtrl：： SetState

在工具列控制項中設定指定之按鈕的狀態。

```
BOOL SetState(
    int nID,
    UINT nState);
```

### <a name="parameters"></a>參數

*nID*<br/>
按鈕的命令識別碼。

*nState*<br/>
狀態旗標。 它可以是 [CToolBarCtrl：： AddButtons](#addbuttons)中，按鈕狀態所列的值組合。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

如果您想要設定一個以上的按鈕狀態，這個功能特別有用。 若要只設定一個狀態，請使用下列其中一個成員函式： [EnableButton](#enablebutton)、 [CheckButton](#checkbutton)、 [HideButton](#hidebutton)、 [不定](#indeterminate)或 [PressButton](#pressbutton)。

## <a name="ctoolbarctrlsetstyle"></a><a name="setstyle"></a> CToolBarCtrl：： >setstyle

設定工具列控制項的樣式。

```cpp
void SetStyle(DWORD dwStyle);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
DWORD，其中包含 [工具列控制項樣式](/windows/win32/Controls/toolbar-control-and-button-styles)的組合，如 Windows SDK 所述。

## <a name="ctoolbarctrlsettooltips"></a><a name="settooltips"></a> CToolBarCtrl：： SetToolTips

將工具提示控制項與工具列控制項產生關聯。

```cpp
void SetToolTips(CToolTipCtrl* pTip);
```

### <a name="parameters"></a>參數

*pTip*<br/>
[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)物件的指標。

## <a name="ctoolbarctrlsetwindowtheme"></a><a name="setwindowtheme"></a> CToolBarCtrl：： SetWindowTheme

設定物件的視覺化樣式 `CToolBarCtrl` 。

```
HRESULT SetWindowTheme(LPCWSTR pszSubAppName);
```

### <a name="parameters"></a>參數

*pszSubAppName*<br/>
Unicode 字串的指標，其中包含要設定的工具列視覺效果樣式。

### <a name="return-value"></a>傳回值

未使用傳回值。

### <a name="remarks"></a>備註

此成員函式會模擬 [TB_SETWINDOWTHEME](/windows/win32/Controls/tb-setwindowtheme) 訊息的功能，如 Windows SDK 中所述。

## <a name="see-also"></a>另請參閱

[MFC 範例 CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[MFC 範例 MFCIE](../../overview/visual-cpp-samples.md)<br/>
[CWnd 類別](../../mfc/reference/cwnd-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[CToolBar 類別](../../mfc/reference/ctoolbar-class.md)
