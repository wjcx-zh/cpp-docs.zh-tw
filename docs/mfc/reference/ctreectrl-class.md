---
title: CTreeCtrl Class
ms.date: 11/04/2016
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
ms.openlocfilehash: e193af8cb5c92f4a3f1ca7381783d90102e0764f
ms.sourcegitcommit: 1839405b97036891b6e4d37c99def044d6f37eff
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/18/2020
ms.locfileid: "88561813"
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class

提供 Windows 通用樹狀檢閱控制項的功能。

## <a name="syntax"></a>語法

```
class CTreeCtrl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CTreeCtrl：： CTreeCtrl](#ctreectrl)|建構 `CTreeCtrl` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CTreeCtrl：： Create](#create)|建立樹狀檢視控制項，並將其附加至 `CTreeCtrl` 物件。|
|[CTreeCtrl：： CreateDragImage](#createdragimage)|建立指定樹狀檢視專案的拖曳點陣圖。|
|[CTreeCtrl：： CreateEx](#createex)|建立具有指定之 Windows 擴充樣式的樹狀目錄控制項，並將其附加至 `CTreeCtrl` 物件。|
|[CTreeCtrl：:D eleteAllItems](#deleteallitems)|刪除樹狀檢視控制項中的所有專案。|
|[CTreeCtrl：:D eleteItem](#deleteitem)|刪除樹狀檢視控制項中的新專案。|
|[CTreeCtrl：： EditLabel](#editlabel)|就地編輯指定的樹狀檢視專案。|
|[CTreeCtrl：： EndEditLabelNow](#endeditlabelnow)|取消目前樹狀檢視控制項中樹狀檢視專案的標籤上的編輯作業。|
|[CTreeCtrl：： EnsureVisible](#ensurevisible)|確保樹狀檢視專案會顯示在其樹狀檢視控制項中。|
|[CTreeCtrl：： Expand](#expand)|展開或折迭指定之樹狀檢視專案的子專案。|
|[CTreeCtrl：： GetBkColor](#getbkcolor)|抓取控制項目前的背景色彩。|
|[CTreeCtrl：： GetCheck](#getcheck)|捕獲樹狀目錄控制項專案的檢查狀態。|
|[CTreeCtrl：： GetChildItem](#getchilditem)|抓取指定樹狀檢視專案的子系。|
|[CTreeCtrl：： GetCount](#getcount)|抓取與樹狀檢視控制項相關聯的樹狀目錄專案數目。|
|[CTreeCtrl：： GetDropHilightItem](#getdrophilightitem)|捕獲拖放作業的目標。|
|[CTreeCtrl：： GetEditControl](#geteditcontrol)|抓取編輯控制項的控制碼，這個控制項是用來編輯指定的樹狀檢視專案。|
|[CTreeCtrl：： GetExtendedStyle](#getextendedstyle)|抓取目前的樹狀檢視控制項所使用的擴充樣式。|
|[CTreeCtrl：： GetFirstVisibleItem](#getfirstvisibleitem)|抓取指定樹狀檢視專案的第一個可見的專案。|
|[CTreeCtrl：： GetImageList](#getimagelist)|捕獲與樹狀檢視控制項相關聯之影像清單的控制碼。|
|[CTreeCtrl：： Setindent](#getindent)|以圖元) 為單位，從父代的樹狀檢視專案中抓取位移 (（以圖元為單位）。|
|[CTreeCtrl：： GetInsertMarkColor](#getinsertmarkcolor)|抓取用來繪製樹狀檢視之插入標記的色彩。|
|[CTreeCtrl：： GetItem](#getitem)|抓取指定樹狀檢視專案的屬性。|
|[CTreeCtrl：： GetItemData](#getitemdata)|傳回與專案相關聯的應用程式特定值。|
|[CTreeCtrl：： GetItemExpandedImageIndex](#getitemexpandedimageindex)|抓取目前樹狀檢視控制項的指定專案處於展開狀態時，所要顯示的影像索引。|
|[CTreeCtrl：： GetItemHeight](#getitemheight)|抓取樹狀檢視專案目前的高度。|
|[CTreeCtrl：： GetItemImage](#getitemimage)|抓取與專案相關聯的影像。|
|[CTreeCtrl：： GetItemPartRect](#getitempartrect)|抓取目前樹狀檢視控制項中指定專案之指定部分的周框。|
|[CTreeCtrl：： GetItemRect](#getitemrect)|抓取樹狀檢視專案的周框。|
|[CTreeCtrl：： GetItemState](#getitemstate)|傳回專案的狀態。|
|[CTreeCtrl：： GetItemStateEx](#getitemstateex)|抓取目前樹狀檢視控制項中所指定專案的擴充狀態。|
|[CTreeCtrl：： GetItemText](#getitemtext)|傳回專案的文字。|
|[CTreeCtrl：： GetLastVisibleItem](#getlastvisibleitem)|抓取目前樹狀檢視控制項中最後展開的專案。|
|[CTreeCtrl：： GetLineColor](#getlinecolor)|抓取樹狀檢視控制項的目前線條色彩。|
|[CTreeCtrl：： GetNextItem](#getnextitem)|抓取符合指定之關聯性的下一個樹狀檢視專案。|
|[CTreeCtrl：： GetNextSiblingItem](#getnextsiblingitem)|抓取指定樹狀檢視專案的下一個同級。|
|[CTreeCtrl：： GetNextVisibleItem](#getnextvisibleitem)|抓取指定樹狀檢視專案的下一個可見專案。|
|[CTreeCtrl：： GetParentItem](#getparentitem)|抓取指定樹狀檢視專案的父系。|
|[CTreeCtrl：： GetPrevSiblingItem](#getprevsiblingitem)|抓取指定樹狀檢視專案的上一個同級。|
|[CTreeCtrl：： GetPrevVisibleItem](#getprevvisibleitem)|抓取指定樹狀檢視專案的先前可見專案。|
|[CTreeCtrl：： GetRootItem](#getrootitem)|抓取指定樹狀檢視專案的根目錄。|
|[CTreeCtrl：： GetScrollTime](#getscrolltime)|抓取樹狀檢視控制項的最大滾動時間。|
|[CTreeCtrl：： GetSelectedCount](#getselectedcount)|抓取目前樹狀檢視控制項中選取的專案數目。|
|[CTreeCtrl：： GetSelectedItem](#getselecteditem)|抓取目前選取的樹狀檢視專案。|
|[CTreeCtrl：： GetTextColor](#gettextcolor)|抓取控制項目前的文字色彩。|
|[CTreeCtrl：： GetToolTips](#gettooltips)|抓取樹狀檢視控制項所使用之子工具提示控制項的控制碼。|
|[CTreeCtrl：： GetVisibleCount](#getvisiblecount)|抓取與樹狀檢視控制項相關聯之可見樹狀專案的數目。|
|[CTreeCtrl：： System.windows.media.visualtreehelper.hittest](#hittest)|傳回與物件相關之資料指標的目前位置 `CTreeCtrl` 。|
|[CTreeCtrl：： InsertItem](#insertitem)|在樹狀檢視控制項中插入新專案。|
|[CTreeCtrl：： ItemHasChildren](#itemhaschildren)|如果指定的專案有子專案，則傳回非零。|
|[CTreeCtrl：： MapAccIdToItem](#mapaccidtoitem)|將指定的協助工具識別碼對應至目前樹狀檢視控制項中樹狀檢視專案的控制碼。|
|[CTreeCtrl：： MapItemToAccID](#mapitemtoaccid)|將指定的控制碼對應到目前樹狀檢視控制項中的樹狀檢視專案，以提供協助工具識別碼。|
|[CTreeCtrl：： Select](#select)|選取、滾動查看或重新繪製指定的樹狀檢視專案。|
|[CTreeCtrl：： SelectDropTarget](#selectdroptarget)|將樹狀目錄專案重新繪製為拖放作業的目標。|
|[CTreeCtrl：： SelectItem](#selectitem)|選取指定的樹狀檢視專案。|
|[CTreeCtrl：： SelectSetFirstVisible](#selectsetfirstvisible)|選取指定的樹狀檢視專案做為第一個可見的專案。|
|[CTreeCtrl：： SetAutoscrollInfo](#setautoscrollinfo)|設定目前樹狀檢視控制項的 autoscroll 率。|
|[CTreeCtrl：： SetBkColor](#setbkcolor)|設定控制項的背景色彩。|
|[CTreeCtrl：： SetCheck](#setcheck)|設定樹狀目錄控制項專案的檢查狀態。|
|[CTreeCtrl：： SetExtendedStyle](#setextendedstyle)|設定目前樹狀檢視控制項的延伸樣式。|
|[CTreeCtrl：： SetImageList](#setimagelist)|設定與樹狀檢視控制項相關聯之影像清單的控制碼。|
|[CTreeCtrl：： SetIndent](#setindent)|以圖元為單位，設定樹狀檢視專案與其父系之間的位移 (（以圖元為單位）) 。|
|[CTreeCtrl：： SetInsertMark](#setinsertmark)|設定樹狀檢視控制項中的插入標記。|
|[CTreeCtrl：： SetInsertMarkColor](#setinsertmarkcolor)|設定用來繪製樹狀檢視之插入標記的色彩。|
|[CTreeCtrl：： SetItem](#setitem)|設定指定之樹狀檢視專案的屬性。|
|[CTreeCtrl：： SetItemData](#setitemdata)|設定與專案相關聯的應用程式特定值。|
|[CTreeCtrl：： SetItemExpandedImageIndex](#setitemexpandedimageindex)|設定當目前樹狀檢視控制項的指定專案處於展開狀態時，所要顯示的影像索引。|
|[CTreeCtrl：： SetItemHeight](#setitemheight)|設定樹狀檢視專案的高度。|
|[CTreeCtrl：： SetItemImage](#setitemimage)|將影像與專案產生關聯。|
|[CTreeCtrl：： SetItemState](#setitemstate)|設定專案的狀態。|
|[CTreeCtrl：： SetItemStateEx](#setitemstateex)|在目前的樹狀檢視控制項中，設定指定之專案的擴充狀態。|
|[CTreeCtrl：： SetItemText](#setitemtext)|設定專案的文字。|
|[CTreeCtrl：： SetLineColor](#setlinecolor)|設定樹狀檢視控制項的目前線條色彩。|
|[CTreeCtrl：： SetScrollTime](#setscrolltime)|設定樹狀檢視控制項的最大滾動時間。|
|[CTreeCtrl：： SetTextColor](#settextcolor)|設定控制項的文字色彩。|
|[CTreeCtrl：： SetToolTips](#settooltips)|設定樹狀檢視控制項的子工具提示控制項。|
|[CTreeCtrl：： ShowInfoTip](#showinfotip)|顯示目前樹狀檢視控制項中所指定專案的提示。|
|[CTreeCtrl：： SortChildren](#sortchildren)|排序給定父專案的子系。|
|[CTreeCtrl：： SortChildrenCB](#sortchildrencb)|使用應用程式定義的排序函數，排序指定之父專案的子系。|

## <a name="remarks"></a>備註

「樹狀檢視控制項」是顯示專案階層式清單的視窗，例如檔中的標題、索引中的專案，或磁片上的檔案和目錄。 每個項目都包含標籤和選擇性點陣圖影像，因此，每個項目都可以擁有與自己相關的子項目清單。 使用者可以按一下項目以展開和摺疊子項目的關聯清單。

此控制項 (，因此 `CTreeCtrl` 類別) 僅適用于在 Windows 98 和 Windows NT 第4版和更新版本下執行的程式。

如需使用的詳細資訊 `CTreeCtrl` ，請參閱：

- [控制項](../../mfc/controls-mfc.md)

- [使用 CTreeCtrl](../../mfc/using-ctreectrl.md)

- Windows SDK 中的[樹狀檢視控制項參考](/windows/win32/Controls/tree-view-control-reference)。

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CTreeCtrl`

## <a name="requirements"></a>規格需求

**標頭：** afxcmn.h

## <a name="ctreectrlcreate"></a><a name="create"></a> CTreeCtrl：： Create

如果您在對話方塊範本中指定樹狀目錄控制項，或您使用 [CTreeView](../../mfc/reference/ctreeview-class.md)，則在建立對話方塊或視圖時，會自動建立您的樹狀目錄控制項。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
指定樹狀檢視控制項的樣式。 套用 [ [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww)] 中所述的視窗樣式，以及 [樹狀檢視控制項樣式](/windows/win32/Controls/tree-view-control-window-styles) 的任意組合（如 Windows SDK 所述）。

*矩形*<br/>
指定樹狀檢視控制項的大小和位置。 它可以是 [CRect](../../atl-mfc-shared/reference/crect-class.md) 物件或 [RECT](/windows/win32/api/windef/ns-windef-rect) 結構。

*pParentWnd*<br/>
指定樹狀檢視控制項的父視窗，通常是 `CDialog` 。 它不得為 NULL。

*nID*<br/>
指定樹狀檢視控制項的識別碼。

### <a name="return-value"></a>傳回值

如果初始化成功，則為非零;否則為0。

### <a name="remarks"></a>備註

如果您想要建立樹狀目錄控制項做為其他視窗的子視窗，請使用成員函式 `Create` 。 如果您使用建立樹狀目錄控制項 `Create` ，除了其他樹狀檢視樣式之外，您還必須將它 WS_VISIBLE 傳遞給它。

您可以 `CTreeCtrl` 用兩個步驟來建立。 先呼叫此函式，然後呼叫 `Create` ，它會建立樹狀檢視控制項並將其附加至 `CTreeCtrl` 物件。

若要建立具有擴充視窗樣式的樹狀目錄控制項，請呼叫 [CreateEx](#createex) ，而不是 `Create` 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]

## <a name="ctreectrlcreateex"></a><a name="createex"></a> CTreeCtrl：： CreateEx

呼叫此函式可 (子視窗) 建立控制項，並將它與物件產生關聯 `CTreeCtrl` 。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwExStyle*<br/>
指定要建立之控制項的延伸樣式。 如需擴充 Windows 樣式的清單，請參閱 Windows SDK 中[CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw)的*dwExStyle*參數。

*dwStyle*<br/>
指定樹狀檢視控制項的樣式。 套用 [ [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww)] 中所述的視窗樣式，以及 [樹狀檢視控制項樣式](/windows/win32/Controls/tree-view-control-window-styles) 的任意組合（如 Windows SDK 所述）。

*矩形*<br/>
[矩形](/windows/win32/api/windef/ns-windef-rect)結構的參考，描述要建立之視窗的大小和位置（以*pParentWnd*的用戶端座標表示）。

*pParentWnd*<br/>
視窗的指標，該視窗為控制項的父代。

*nID*<br/>
控制項的子視窗識別碼。

### <a name="return-value"></a>傳回值

如果成功則為非零，否則為0。

### <a name="remarks"></a>備註

使用 `CreateEx` instead Of [Create](#create) 來套用延伸的 windows 樣式（依 Windows 擴充樣式的 "前言 **WS_EX_** 指定）。

## <a name="ctreectrlcreatedragimage"></a><a name="createdragimage"></a> CTreeCtrl：： CreateDragImage

呼叫此函式可針對樹狀檢視控制項中的指定專案建立拖曳點陣圖、建立點陣圖的影像清單，然後將點陣圖加入影像清單中。

```
CImageList* CreateDragImage(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要拖曳之樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果成功，則為已加入拖曳點陣圖之影像清單的指標;否則為 Null。

### <a name="remarks"></a>備註

當拖曳專案時，應用程式會使用影像清單功能來顯示影像。

`CImageList`物件是永久性的，而且您必須在完成時將它刪除。 例如：

[!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]

## <a name="ctreectrlctreectrl"></a><a name="ctreectrl"></a> CTreeCtrl：： CTreeCtrl

建構 `CTreeCtrl` 物件。

```
CTreeCtrl();
```

## <a name="ctreectrldeleteallitems"></a><a name="deleteallitems"></a> CTreeCtrl：:D eleteAllItems

呼叫此函式可刪除樹狀檢視控制項中的所有專案。

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]

## <a name="ctreectrldeleteitem"></a><a name="deleteitem"></a> CTreeCtrl：:D eleteItem

呼叫此函式可從樹狀檢視控制項中刪除專案。

```
BOOL DeleteItem(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要刪除之樹狀結構專案的控制碼。 如果 *hitem* 具有 TVI_ROOT 值，則會從樹狀檢視控制項中刪除所有專案。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]

## <a name="ctreectrleditlabel"></a><a name="editlabel"></a> CTreeCtrl：： EditLabel

呼叫此函式以開始就地編輯指定專案的文字。

```
CEdit* EditLabel(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要編輯之樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果成功，則為 `CEdit` 用來編輯專案文字之物件的指標; 否則為 Null。

### <a name="remarks"></a>備註

將專案的文字取代為包含文字的單行編輯控制項，即可完成編輯。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]

## <a name="ctreectrlendeditlabelnow"></a><a name="endeditlabelnow"></a> CTreeCtrl：： EndEditLabelNow

結束目前樹狀檢視控制項中樹狀檢視專案的標籤上的編輯作業。

```
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```

### <a name="parameters"></a>參數

*fCancelWithoutSave*\
在TRUE 表示在結束編輯作業之前捨棄樹狀檢視專案的變更，或 FALSE 表示在結束作業之前儲存樹狀檢視專案的變更。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送 [TVM_ENDEDITLABELNOW](/windows/win32/Controls/tvm-endeditlabelnow) 的訊息，如 Windows SDK 中所述。

## <a name="ctreectrlensurevisible"></a><a name="ensurevisible"></a> CTreeCtrl：： EnsureVisible

呼叫此函式可確保樹狀檢視專案可見。

```
BOOL EnsureVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
顯示之樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果系統滾動樹狀檢視控制項中的專案，以確保可以看見指定的專案，則傳回 TRUE。 否則，傳回值為 FALSE。

### <a name="remarks"></a>備註

如有必要，此函式會展開父項目或滾動樹狀檢視控制項，以顯示該專案。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]

## <a name="ctreectrlexpand"></a><a name="expand"></a> CTreeCtrl：： Expand

呼叫此函式可展開或折迭子專案（如果有的話）的清單（如果有的話），並與指定的父專案相關聯。

```
BOOL Expand(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要展開之樹狀結構專案的控制碼。

*nCode*<br/>
旗標，表示要採取的動作類型。 此旗標可以具有下列其中一個值：

- TVE_COLLAPSE 折迭清單。

- TVE_COLLAPSERESET 折迭清單並移除子專案。 TVIS_EXPANDEDONCE 狀態旗標會重設。 此旗標必須搭配 TVE_COLLAPSE 旗標使用。

- TVE_EXPAND 展開清單。

- 如果目前展開清單，TVE_TOGGLE 折迭清單，如果目前已折迭，則將其展開。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： EnsureVisible](#ensurevisible)的範例。

## <a name="ctreectrlgetbkcolor"></a><a name="getbkcolor"></a> CTreeCtrl：： GetBkColor

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_GETBKCOLOR](/windows/win32/Controls/tvm-getbkcolor)的行為。

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>傳回值

COLORRE光圈值，表示控制項目前的視窗背景色彩。 如果這個值是-1，則控制項會使用系統視窗色彩。 在此情況下，您可以使用 `::GetSysColor(COLOR_WINDOW)` 來取得目前控制項所使用的系統色彩。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： SetTextColor](#settextcolor)的範例。

## <a name="ctreectrlgetcheck"></a><a name="getcheck"></a> CTreeCtrl：： GetCheck

呼叫這個成員函式，以取得專案的檢查狀態。

```
BOOL GetCheck(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要接收狀態資訊的 HTREEITEM。

### <a name="return-value"></a>傳回值

如果已核取樹狀目錄控制項，則為非零;否則為0。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： SetCheck](#setcheck)的範例。

## <a name="ctreectrlgetchilditem"></a><a name="getchilditem"></a> CTreeCtrl：： GetChildItem

呼叫此函式可取得樹狀檢視專案，此專案為 *hItem*所指定專案的子系。

```
HTREEITEM GetChildItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果成功，則為子專案的控制碼;否則為 Null。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]

## <a name="ctreectrlgetcount"></a><a name="getcount"></a> CTreeCtrl：： GetCount

呼叫此函式可取得樹狀檢視控制項中專案的計數。

```
UINT GetCount() const;
```

### <a name="return-value"></a>傳回值

樹狀檢視控制項中的專案數。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]

## <a name="ctreectrlgetdrophilightitem"></a><a name="getdrophilightitem"></a> CTreeCtrl：： GetDropHilightItem

呼叫此函式，以抓取做為拖放作業之目標的專案。

```
HTREEITEM GetDropHilightItem() const;
```

### <a name="return-value"></a>傳回值

如果成功，則會捨棄專案的控制碼;否則為 Null。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlgeteditcontrol"></a><a name="geteditcontrol"></a> CTreeCtrl：： GetEditControl

呼叫此函式可取得編輯控制項的控制碼，這個控制項是用來編輯樹狀檢視專案的文字。

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>傳回值

如果成功，則為用來編輯專案文字之編輯控制項的指標。否則為 Null。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]

## <a name="ctreectrlgetextendedstyle"></a><a name="getextendedstyle"></a> CTreeCtrl：： GetExtendedStyle

抓取目前的樹狀檢視控制項所使用的擴充樣式。

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>傳回值

值，其中包含目前樹狀檢視控制項的擴充樣式 (或) 的位組合。 如需詳細資訊，請參閱 [樹狀檢視控制項擴充樣式](/windows/win32/Controls/tree-view-control-window-extended-styles)。

### <a name="remarks"></a>備註

這個方法會傳送 [TVM_GETEXTENDEDSTYLE](/windows/win32/Controls/tvm-getextendedstyle) 的訊息，如 Windows SDK 中所述。

## <a name="ctreectrlgetfirstvisibleitem"></a><a name="getfirstvisibleitem"></a> CTreeCtrl：： GetFirstVisibleItem

呼叫此函式可取出樹狀檢視控制項的第一個可見專案。

```
HTREEITEM GetFirstVisibleItem() const;
```

### <a name="return-value"></a>傳回值

第一個可見專案的控制碼;否則為 Null。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： SetCheck](#setcheck)的範例。

## <a name="ctreectrlgetimagelist"></a><a name="getimagelist"></a> CTreeCtrl：： GetImageList

呼叫此函式可取得與樹狀檢視控制項相關聯之一般或狀態影像清單的控制碼。

```
CImageList* GetImageList(UINT nImageList) const;
```

### <a name="parameters"></a>參數

*nImageList*<br/>
要取出的影像清單類型。 影像清單可以是下列其中一個值：

- TVSIL_NORMAL 抓取標準影像清單，其中包含樹狀檢視專案的已選取和 nonselected 影像。

- TVSIL_STATE 抓取狀態影像清單，其中包含處於使用者定義狀態之樹狀檢視專案的影像。

### <a name="return-value"></a>傳回值

如果成功，則為控制項影像清單的指標。否則為 Null。

### <a name="remarks"></a>備註

樹狀檢視控制項中的每個專案都可以有一對與其相關聯的點陣圖影像。 當選取專案時，就會顯示一個影像，而另一個影像則會在未選取專案時顯示。 例如，在選取專案時，專案可能會顯示已開啟的資料夾，並顯示未選取的資料夾。

如需影像清單的詳細資訊，請參閱 [CImageList](../../mfc/reference/cimagelist-class.md) 類別。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]

## <a name="ctreectrlgetindent"></a><a name="getindent"></a> CTreeCtrl：： Setindent

呼叫此函式，以圖元為單位來抓取子專案相對於其父代專案的縮排量（以圖元為單位）。

```
UINT GetIndent() const;
```

### <a name="return-value"></a>傳回值

以圖元為單位的縮排量。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]

## <a name="ctreectrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a> CTreeCtrl：： GetInsertMarkColor

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_GETINSERTMARKCOLOR](/windows/win32/Controls/tvm-getinsertmarkcolor)的行為。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>傳回值

COLORRE光圈值，其中包含目前的插入標記色彩。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]

## <a name="ctreectrlgetitem"></a><a name="getitem"></a> CTreeCtrl：： GetItem

呼叫此函式可取得指定之樹狀檢視專案的屬性。

```
BOOL GetItem(TVITEM* pItem) const;
```

### <a name="parameters"></a>參數

*pItem*<br/>
[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)結構的指標，如 Windows SDK 所述。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

  請參閱 CTreeCtrl 的範例 [：:D eleteitem](#deleteitem)。

## <a name="ctreectrlgetitemdata"></a><a name="getitemdata"></a> CTreeCtrl：： GetItemData

呼叫此函式，以取得與指定之專案相關聯的應用程式特定值。

```
DWORD_PTR GetItemData(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要抓取其資料的專案之控制碼。

### <a name="return-value"></a>傳回值

與 *hItem*指定的專案相關聯之指標大小的應用程式特定值。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]

## <a name="ctreectrlgetitemexpandedimageindex"></a><a name="getitemexpandedimageindex"></a> CTreeCtrl：： GetItemExpandedImageIndex

抓取目前樹狀檢視控制項的指定專案處於展開狀態時，所要顯示的影像索引。

```
int GetItemExpandedImageIndex(HTREEITEM hItem)const;
```

### <a name="parameters"></a>參數

*hItem*\
在樹狀檢視控制項專案的控制碼。

### <a name="return-value"></a>傳回值

當指定的專案處於展開狀態時，所要顯示的影像索引。

### <a name="remarks"></a>備註

這個方法會傳送 [TVM_GETITEM](/windows/win32/Controls/tvm-getitem) 的訊息，如 Windows SDK 中所述。 該訊息會傳回描述樹狀檢視控制項專案的 [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) 結構，然後這個方法會 `iExpandedImage` 從該結構中抓取該成員。

## <a name="ctreectrlgetitemheight"></a><a name="getitemheight"></a> CTreeCtrl：： GetItemHeight

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_GETITEMHEIGHT](/windows/win32/Controls/tvm-getitemheight)的行為。

```
SHORT GetItemHeight() const;
```

### <a name="return-value"></a>傳回值

專案的高度（以圖元為單位）。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]

## <a name="ctreectrlgetitemimage"></a><a name="getitemimage"></a> CTreeCtrl：： GetItemImage

樹狀檢視控制項中的每個專案都可以有一對與其相關聯的點陣圖影像。

```
BOOL GetItemImage(
    HTREEITEM hItem,
    int& nImage,
    int& nSelectedImage) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要抓取其影像之專案的控制碼。

*n*<br/>
整數，這個整數會接收樹狀檢視控制項影像清單中專案影像的索引。

*nSelectedImage*<br/>
整數，這個整數會在樹狀檢視控制項的影像清單中，接收專案所選取影像的索引。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

影像會出現在專案標籤的左邊。 當選取專案時，就會顯示一個影像，而另一個影像則會在未選取專案時顯示。 例如，在選取專案時，專案可能會顯示已開啟的資料夾，並顯示未選取的資料夾。

呼叫此函式可在樹狀檢視控制項的影像清單中，取得專案影像的索引和其選取的影像。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]

## <a name="ctreectrlgetitempartrect"></a><a name="getitempartrect"></a> CTreeCtrl：： GetItemPartRect

抓取目前樹狀檢視控制項中指定專案之指定部分的周框。

```
BOOL GetItemPartRect(
    HTREEITEM hItem,
    int nPart,
    LPRECT lpRect)const;
```

### <a name="parameters"></a>參數

*hItem*\
在樹狀檢視控制項專案的控制碼。

*nPart*\
在元件的識別碼。 必須設定為 TVGIPR_BUTTON。

*lpRect*\
擴展 [矩形](/windows/win32/api/windef/ns-windef-rect) 結構的指標。 如果這個方法成功，結構會接收 *hItem* 和 *nPart*所指定之元件的矩形座標。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

每個樹狀目錄控制項專案都是由圖形矩形所限制。 只要按一下該矩形中的某個點， *就會叫用該*專案。 這個方法會傳回最大的矩形，如此一來，當按下矩形中的點時，就會叫用 *hItem* 參數所識別的專案。

這個方法會傳送 TVM_GETITEMPARTRECT 的訊息，如 Windows SDK 中所述。 如需詳細資訊，請參閱 [TreeView_GetItemPartRect](/windows/win32/api/commctrl/nf-commctrl-treeview_getitempartrect) 宏。

### <a name="example"></a>範例

下列程式碼範例 `m_treeCtrl` 會定義用來存取目前樹狀檢視控制項的變數。 程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會使用存取範圍識別碼和 [CTreeCtrl：： MapAccIdToItem](#mapaccidtoitem) 方法，來取得根樹狀檢視專案的控制碼。 然後，此範例會使用控制碼和 [CTreeCtrl：： GetItemPartRect](#getitempartrect) 方法，在該專案周圍繪製3d 矩形。 在程式碼範例的先前部分（未顯示）中，我們建立了一個樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及這些州城市的樹狀專案。 我們使用了 [CTreeCtrl：： MapItemToAccID](#mapitemtoaccid) 方法，將根樹狀檢視專案與存取範圍識別碼產生關聯。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlgetitemrect"></a><a name="getitemrect"></a> CTreeCtrl：： GetItemRect

呼叫此函式以抓取 *hItem* 的周框，並判斷是否為可見的。

```
BOOL GetItemRect(
    HTREEITEM hItem,
    LPRECT lpRect,
    BOOL bTextOnly) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀檢視控制項專案的控制碼。

*lpRect*<br/>
接收周框 [的矩形結構指標](/windows/win32/api/windef/ns-windef-rect) 。 座標相對於樹狀檢視控制項的左上角。

*bTextOnly*<br/>
如果這個參數不是零，則周框只會包含專案的文字。 否則，它會包含專案在樹狀檢視控制項中所占的整個行。

### <a name="return-value"></a>傳回值

如果專案是可見的，則為非零，包含 *lpRect*中包含的周框。 否則為0， *lpRect* 未初始化。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]

## <a name="ctreectrlgetitemstate"></a><a name="getitemstate"></a> CTreeCtrl：： GetItemState

傳回 *hItem*指定之專案的狀態。

```
UINT GetItemState(
    HTREEITEM hItem,
    UINT nStateMask) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要抓取其狀態之專案的控制碼。

*nStateMask*<br/>
表示要抓取的一或多個狀態的遮罩。 如需 *nStateMask*可能值的詳細資訊，請參閱 `state` `stateMask` Windows SDK 中 [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) 結構的和成員的討論。

### <a name="return-value"></a>傳回值

包含 nStateMask 所指定之值位 OR 的 UINT。 如需可能值的詳細資訊，請參閱 [CTreeCtrl：： GetItem](#getitem)。 若要尋找特定狀態的值，請執行 state 值和傳回值的位 AND 運算，如下列範例所示。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]

## <a name="ctreectrlgetitemstateex"></a><a name="getitemstateex"></a> CTreeCtrl：： GetItemStateEx

抓取目前樹狀檢視控制項中所指定專案的擴充狀態。

```
UINT GetItemStateEx(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*\
在樹狀檢視控制項專案的控制碼。

### <a name="return-value"></a>傳回值

專案的擴充狀態。 如需詳細資訊，請參閱 `uStateEx` [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) 結構的成員。

### <a name="remarks"></a>備註

這個方法會傳送 [TVM_GETITEM](/windows/win32/Controls/tvm-getitem) 的訊息，如 Windows SDK 中所述。 該訊息會傳回描述樹狀檢視控制項專案的 [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) 結構，而這個方法會 `uStateEx` 從該結構中抓取該成員。

## <a name="ctreectrlgetitemtext"></a><a name="getitemtext"></a> CTreeCtrl：： GetItemText

傳回 *hItem*指定之專案的文字。

```
CString GetItemText(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要取出其文字之專案的控制碼。

### <a name="return-value"></a>傳回值

`CString`物件，包含專案的文字。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： GetNextItem](#getnextitem)的範例。

## <a name="ctreectrlgetlastvisibleitem"></a><a name="getlastvisibleitem"></a> CTreeCtrl：： GetLastVisibleItem

抓取目前樹狀檢視控制項中的最後一個未展開節點專案。

```
HTREEITEM GetLastVisibleItem() const;
```

### <a name="return-value"></a>傳回值

如果方法成功，則為最後一個未展開節點專案的控制碼;否則為 Null。

### <a name="remarks"></a>備註

這個方法會傳送 [TVM_GETNEXTITEM](/windows/win32/Controls/tvm-getnextitem) 的訊息，如 Windows SDK 中所述。 如需詳細資訊，請參閱該訊息之 *旗* 標參數中的 TVGN_LASTVISIBLE 旗標。

### <a name="example"></a>範例

下列程式碼範例 `m_treeCtrl` 會定義用來存取目前樹狀檢視控制項的變數。 程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 在下一個範例中，會使用其中一或多個變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會抓取最後未展開之樹狀檢視節點專案的控制碼，然後在該專案周圍繪製3D 矩形。 在程式碼範例的先前部分（未顯示）中，我們建立了一個樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及這些州城市的樹狀專案。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]

## <a name="ctreectrlgetlinecolor"></a><a name="getlinecolor"></a> CTreeCtrl：： GetLineColor

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_GETLINECOLOR](/windows/win32/Controls/tvm-getlinecolor)的行為。

```
COLORREF GetLineColor() const;
```

### <a name="return-value"></a>傳回值

目前的線條色彩。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]

## <a name="ctreectrlgetnextitem"></a><a name="getnextitem"></a> CTreeCtrl：： GetNextItem

呼叫此函式可將具有指定關聯性的樹狀檢視專案（由 *nCode* 參數指定）抓取至 *hItem*。

```
HTREEITEM GetNextItem(
    HTREEITEM hItem,
    UINT nCode) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

*nCode*<br/>
旗標，表示要 *hItem*之關聯性的類型。 此旗標可以是下列其中一個值：

- TVGN_CARET 抓取目前選取的專案。

- TVGN_CHILD 會抓取 *hItem* 參數所指定之專案的第一個子專案。

- TVGN_DROPHILITE 會抓取拖放作業的目標專案。

- TVGN_FIRSTVISIBLE 抓取第一個可見的專案。

- TVGN_LASTVISIBLE 抓取樹狀結構中最後展開的專案。 這不會取出樹狀檢視視窗中顯示的最後一個專案。

- TVGN_NEXT 抓取下一個同級專案。

- TVGN_NEXTVISIBLE 抓取位於指定專案之後的下一個可見專案。

- TVGN_PARENT 抓取指定之專案的父系。

- TVGN_PREVIOUS 抓取上一個同級專案。

- TVGN_PREVIOUSVISIBLE 抓取指定專案之前的第一個可見專案。

- TVGN_ROOT 抓取指定的專案所屬之根項目的第一個子專案。

### <a name="return-value"></a>傳回值

如果成功，則為下一個專案的控制碼;否則為 Null。

### <a name="remarks"></a>備註

如果要抓取的專案是樹狀結構的根節點，則此函式會傳回 Null。 例如，如果您在樹狀檢視根節點的第一個層級子系上使用此訊息搭配 TVGN_PARENT 旗標，訊息將會傳回 Null。

### <a name="example"></a>範例

如需 `GetNextItem` 在迴圈中使用的範例，請參閱 [CTreeCtrl：:D eleteitem](#deleteitem)。

[!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]

## <a name="ctreectrlgetnextsiblingitem"></a><a name="getnextsiblingitem"></a> CTreeCtrl：： GetNextSiblingItem

呼叫此函式可取出 *hItem*的下一個同級。

```
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

下一個同級專案的控制碼;否則為 Null。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]

## <a name="ctreectrlgetnextvisibleitem"></a><a name="getnextvisibleitem"></a> CTreeCtrl：： GetNextVisibleItem

呼叫此函式可取出 *hItem*的下一個可見專案。

```
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

下一個可見專案的控制碼;否則為 Null。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： SetCheck](#setcheck)的範例。

## <a name="ctreectrlgetparentitem"></a><a name="getparentitem"></a> CTreeCtrl：： GetParentItem

呼叫此函式可取出 *hItem*的父系。

```
HTREEITEM GetParentItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

父專案的控制碼;否則為 Null。

### <a name="remarks"></a>備註

如果指定之專案的父系是樹狀結構的根節點，則此函式會傳回 Null。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： EnsureVisible](#ensurevisible)的範例。

## <a name="ctreectrlgetprevsiblingitem"></a><a name="getprevsiblingitem"></a> CTreeCtrl：： GetPrevSiblingItem

呼叫此函式以抓取 *hItem*的前一個同級。

```
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

上一個同級的控制碼;否則為 Null。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]

## <a name="ctreectrlgetprevvisibleitem"></a><a name="getprevvisibleitem"></a> CTreeCtrl：： GetPrevVisibleItem

呼叫此函式以抓取 *hItem*的先前可見專案。

```
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

先前可見專案的控制碼;否則為 Null。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]

## <a name="ctreectrlgetrootitem"></a><a name="getrootitem"></a> CTreeCtrl：： GetRootItem

呼叫此函式可取得樹狀檢視控制項的根專案。

```
HTREEITEM GetRootItem() const;
```

### <a name="return-value"></a>傳回值

根專案的控制碼;否則為 Null。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： EditLabel](#editlabel)的範例。

## <a name="ctreectrlgetscrolltime"></a><a name="getscrolltime"></a> CTreeCtrl：： GetScrollTime

呼叫這個成員函式，以取得樹狀檢視控制項的最大滾動時間。

```
UINT GetScrollTime() const;
```

### <a name="return-value"></a>傳回值

最大滾動時間（以毫秒為單位）。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_GETSCROLLTIME](/windows/win32/Controls/tvm-getscrolltime)的行為。

## <a name="ctreectrlgetselectedcount"></a><a name="getselectedcount"></a> CTreeCtrl：： GetSelectedCount

抓取目前樹狀檢視控制項中選取的專案數目。

```
UINT GetSelectedCount();
```

### <a name="return-value"></a>傳回值

選取的專案數目。

### <a name="remarks"></a>備註

這個方法會傳送 [TVM_GETSELECTEDCOUNT](/windows/win32/Controls/tvm-getselectedcount) 的訊息，如 Windows SDK 中所述。

## <a name="ctreectrlgetselecteditem"></a><a name="getselecteditem"></a> CTreeCtrl：： GetSelectedItem

呼叫此函式可取出樹狀檢視控制項的目前選取專案。

```
HTREEITEM GetSelectedItem() const;
```

### <a name="return-value"></a>傳回值

選取之專案的控制碼;否則為 Null。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]

## <a name="ctreectrlgettextcolor"></a><a name="gettextcolor"></a> CTreeCtrl：： GetTextColor

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_GETTEXTCOLOR](/windows/win32/Controls/tvm-gettextcolor)的行為。

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>傳回值

表示目前文字色彩的 COLORRE光圈值。 如果這個值是-1，表示控制項使用的是文字色彩的系統色彩。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： SetTextColor](#settextcolor)的範例。

## <a name="ctreectrlgettooltips"></a><a name="gettooltips"></a> CTreeCtrl：： GetToolTips

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_GETTOOLTIPS](/windows/win32/Controls/tvm-gettooltips)的行為。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>傳回值

樹狀目錄控制項所要使用之 [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) 物件的指標。 如果 [Create](#create) 成員函式使用樣式 TVS_NOTOOLTIPS，則不會使用任何工具提示，而且會傳回 Null。

### <a name="remarks"></a>備註

的 MFC 實 `GetToolTips` `CToolTipCtrl` 會傳回樹狀目錄控制項所使用的物件，而不是工具提示控制項的控制碼。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]

## <a name="ctreectrlgetvisiblecount"></a><a name="getvisiblecount"></a> CTreeCtrl：： GetVisibleCount

呼叫此函式可取得樹狀檢視控制項中可見專案的計數。

```
UINT GetVisibleCount() const;
```

### <a name="return-value"></a>傳回值

樹狀檢視控制項中可見的專案數目;否則為-1。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： SetCheck](#setcheck)的範例。

## <a name="ctreectrlhittest"></a><a name="hittest"></a> CTreeCtrl：： System.windows.media.visualtreehelper.hittest

呼叫此函式可判斷指定點相對於樹狀檢視控制項工作區的位置。

```
HTREEITEM HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;

HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;
```

### <a name="parameters"></a>參數

*pt*<br/>
要測試之點的用戶端座標。

*pFlags*<br/>
整數的指標，該整數會接收點擊測試結果的相關資訊。 它可以是 [備註] 區段中的成員下所列的一或多個值 `flags` 。

*pHitTestInfo*<br/>
[TVHITTESTINFO](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo)結構的位址，其中包含點擊測試的位置，以及接收點擊測試結果的相關資訊。

### <a name="return-value"></a>傳回值

如果沒有任何專案佔用點，則為佔用指定點之樹狀檢視專案的控制碼; 如果沒有任何專案，則為 Null。

### <a name="remarks"></a>備註

呼叫此函式時， *pt* 參數會指定要測試之點的座標。 函數會在指定的點傳回專案的控制碼，如果沒有任何專案佔用點，則為 Null。 此外， *pFlags* 參數包含一個值，指出指定點的位置。 可能的值包括：

|||
|-|-|
|值|意義|
|TVHT_ABOVE|在工作區的上方。|
|TVHT_BELOW|在工作區下方。|
|TVHT_NOWHERE|在工作區中，但在最後一個專案之下。|
|TVHT_ONITEM|與專案相關聯的點陣圖或標籤。|
|TVHT_ONITEMBUTTON|與專案相關聯的按鈕。|
|TVHT_ONITEMICON|與專案相關聯的點陣圖。|
|TVHT_ONITEMINDENT|與專案相關聯的縮排。|
|TVHT_ONITEMLABEL|在 [標籤 (字串]) 與專案相關聯。|
|TVHT_ONITEMRIGHT|在專案右邊的區域中。|
|TVHT_ONITEMSTATEICON|在使用者定義狀態之樹狀檢視專案的狀態圖示上。|
|TVHT_TOLEFT|在工作區的左邊。|
|TVHT_TORIGHT|在工作區的右邊。|
|||

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlinsertitem"></a><a name="insertitem"></a> CTreeCtrl：： InsertItem

呼叫此函式以在樹狀檢視控制項中插入新專案。

```
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);

HTREEITEM InsertItem(
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    HTREEITEM hParent,
    HTREEITEM hInsertAfter);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);
```

### <a name="parameters"></a>參數

*lpInsertStruct*<br/>
的指標 `TVINSERTSTRUCT` ，指定要插入之樹狀檢視專案的屬性。

*nMask*<br/>
指定要設定之屬性的整數。 請參閱 `TVITEM` Windows SDK 中的結構。

*lpszItem*<br/>
字串的位址，其中包含專案的文字。

*n*<br/>
樹狀檢視控制項影像清單中專案影像的索引。

*nSelectedImage*<br/>
樹狀檢視控制項影像清單中專案的已選取影像索引。

*nState*<br/>
指定專案狀態的值。 如需適當狀態的清單，請參閱 Windows SDK 中的樹狀檢視控制項專案狀態。

*nStateMask*<br/>
指定要設定的狀態。 請參閱 `TVITEM` Windows SDK 中的結構。

*lParam*<br/>
與專案相關聯之指標大小的應用程式特定值。

*hParent*<br/>
所插入專案之父系的控制碼。

*hInsertAfter*<br/>
專案的控制碼，之後要插入新專案。

### <a name="return-value"></a>傳回值

如果成功，則為新專案的控制碼;否則為 Null。

### <a name="remarks"></a>備註

此範例會示範當您插入樹狀目錄控制項專案時，您可能會想要使用每個版本的函式的情況。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]

## <a name="ctreectrlitemhaschildren"></a><a name="itemhaschildren"></a> CTreeCtrl：： ItemHasChildren

您可以使用此函式來判斷 *hItem* 指定的樹狀結構專案是否有子專案。

```
BOOL ItemHasChildren(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果 *hItem* 指定的樹狀結構專案有子專案，則為非零。如果沒有，則為0。

### <a name="remarks"></a>備註

若是如此，您就可以使用 [CTreeCtrl：： GetChildItem](#getchilditem) 來取出這些子專案。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： GetSelectedItem](#getselecteditem)的範例。

## <a name="ctreectrlmapaccidtoitem"></a><a name="mapaccidtoitem"></a> CTreeCtrl：： MapAccIdToItem

將指定的協助工具識別碼對應至目前樹狀檢視控制項中樹狀檢視專案的控制碼。

```
HTREEITEM MapAccIdToItem(UINT uAccId) const;
```

### <a name="parameters"></a>參數

*uAccId*\
在樹狀檢視專案中元素的協助工具識別碼。

### <a name="return-value"></a>傳回值

樹狀檢視專案的控制碼， ( `HTREEITEM` 對應至 *uAccId* 參數的) 。 如需詳細資訊，請參閱[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的*hItem*成員。

### <a name="remarks"></a>備註

協助工具協助工具是協助殘障人士使用電腦的應用程式。 介面會使用存取 `IAccessible` 範圍識別碼來唯一指定視窗中的元素。 如需協助工具識別碼的詳細資訊，請搜尋 [Microsoft 開發人員網路](https://go.microsoft.com/fwlink/p/?linkid=56322)中的「關於 Active Accessibility 支援」主題。

這個方法會傳送 [TVM_MAPACCIDTOHTREEITEM](/windows/win32/Controls/tvm-mapaccidtohtreeitem) 的訊息，如 Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例 `m_treeCtrl` 會定義用來存取目前樹狀檢視控制項的變數。 程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會使用存取範圍識別碼和 [CTreeCtrl：： MapAccIdToItem](#mapaccidtoitem) 方法，來取得根樹狀檢視專案的控制碼。 此範例會使用控制碼和 [CTreeCtrl：： GetItemPartRect](#getitempartrect) 方法，在該專案周圍繪製3d 矩形。 在程式碼範例的先前部分（未顯示）中，我們建立了一個樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及這些州城市的樹狀專案。 我們使用了 [CTreeCtrl：： MapItemToAccID](#mapitemtoaccid) 方法，將根樹狀檢視專案與存取範圍識別碼產生關聯。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlmapitemtoaccid"></a><a name="mapitemtoaccid"></a> CTreeCtrl：： MapItemToAccID

將目前樹狀檢視控制項中樹狀檢視專案的指定控制碼對應至協助工具識別碼。

```
UINT MapItemToAccID(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*\
在控制項中樹狀檢視專案的控制碼。 如需詳細資訊，請參閱[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的*hItem*成員。

### <a name="return-value"></a>傳回值

對應至 *hItem* 參數的協助工具識別碼。

### <a name="remarks"></a>備註

協助工具協助工具是協助殘障人士使用電腦的應用程式。 介面會使用存取 `IAccessible` 範圍識別碼來唯一指定視窗中的元素。 如需協助工具識別碼的詳細資訊，請搜尋 [Microsoft 開發人員網路](https://go.microsoft.com/fwlink/p/?linkid=56322)中的「關於 Active Accessibility 支援」主題。

這個方法會傳送 [TVM_MAPHTREEITEMTOACCID](/windows/win32/Controls/tvm-maphtreeitemtoaccid) 的訊息，如 Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例 `m_treeCtrl` 會定義用來存取目前樹狀檢視控制項的變數。 程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會取得樹狀檢視控制項專案的識別碼。 在程式碼範例的先前部分（未顯示）中，我們建立了一個樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及這些州城市的樹狀專案。 這個程式碼範例會取得根國家/地區節點的唯一識別碼。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]

## <a name="ctreectrlselect"></a><a name="select"></a> CTreeCtrl：： Select

呼叫此函式可選取指定的樹狀檢視專案、將專案拖曳到視圖中，或是以用來表示拖放作業目標的樣式來重繪專案。

```
BOOL Select(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

*nCode*<br/>
要採取的動作類型。 這個參數可以是下列其中一個值：

- TVGN_CARET 將選取專案設定為指定的專案。

- TVGN_DROPHILITE 會以用來表示拖放作業目標的樣式來重繪指定的專案。

- TVGN_FIRSTVISIBLE 垂直捲動樹狀檢視，讓指定的專案是第一個可見的專案。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果 *nCode* 包含 TVGN_CARET 的值，父視窗會接收 TVN_SELCHANGING 並 TVN_SELCHANGED 通知訊息。 此外，如果指定的專案是折迭父代專案的子系，則會展開父代的子專案清單，以顯示指定的專案。 在此情況下，父視窗會接收 TVN_ITEMEXPANDING 並 TVN_ITEMEXPANDED 通知訊息。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： system.windows.media.visualtreehelper.hittest](#hittest)的範例。

## <a name="ctreectrlselectdroptarget"></a><a name="selectdroptarget"></a> CTreeCtrl：： SelectDropTarget

呼叫此函式以重繪用來表示拖放作業目標的樣式中的專案。

```
BOOL SelectDropTarget(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlselectitem"></a><a name="selectitem"></a> CTreeCtrl：： SelectItem

呼叫此函式可選取指定的樹狀檢視專案。

```
BOOL SelectItem(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果 *hItem* 為 Null，則此函式不會選取任何專案。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlselectsetfirstvisible"></a><a name="selectsetfirstvisible"></a> CTreeCtrl：： SelectSetFirstVisible

呼叫此函式可垂直捲動樹狀檢視，讓指定的專案成為第一個可見的專案。

```
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要設定為第一個可見專案的樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

函數會將訊息傳送至具有 TVM_SELECTITEM 和 TVGN_FIRSTVISIBLE 訊息參數的視窗。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]

## <a name="ctreectrlsetautoscrollinfo"></a><a name="setautoscrollinfo"></a> CTreeCtrl：： SetAutoscrollInfo

設定目前樹狀檢視控制項的 autoscroll 率。

```
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,
    UINT uUpdateTime);
```

### <a name="parameters"></a>參數

*uPixelsPerSec*\
在每秒要滾動的圖元數。

*uUpdateTime*\
在控制項更新之間的時間間隔。

### <a name="return-value"></a>傳回值

一律傳回 TRUE。

### <a name="remarks"></a>備註

Autoscroll 參數是用來將目前看不到的專案，用來進行流覽。 樹狀檢視控制項必須有 TVS_EX_AUTOHSCROLL 的擴充樣式，如 [樹狀檢視控制項擴充樣式](/windows/win32/Controls/tree-view-control-window-extended-styles)中所述。

這個方法會傳送 [TVM_SETAUTOSCROLLINFO](/windows/win32/Controls/tvm-setautoscrollinfo) 的訊息，如 Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例 `m_treeCtrl` 會定義用來存取目前樹狀檢視控制項的變數。 程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會設定目前樹狀檢視控制項的 autoscroll 行為。 在程式碼範例的先前部分（未顯示）中，我們建立了一個樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及這些州城市的樹狀專案。 我們刻意讓樹狀檢視控制項變窄，讓它必須自動滾動以顯示具有焦點的樹狀目錄專案。 程式碼範例會將樹狀檢視控制項設定為每隔5秒自動滾動30個圖元，直到樹狀結構專案處於 view 為止。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]

## <a name="ctreectrlsetbkcolor"></a><a name="setbkcolor"></a> CTreeCtrl：： SetBkColor

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_SETBKCOLOR](/windows/win32/Controls/tvm-setbkcolor)的行為。

```
COLORREF SetBkColor(COLORREF clr);
```

### <a name="parameters"></a>參數

*Clr*<br/>
COLORRE光圈值，其中包含新的背景色彩。 如果這個值是-1，控制項將會還原為使用背景色彩的系統色彩。

### <a name="return-value"></a>傳回值

表示目前文字色彩的 COLORRE光圈值。 如果這個值是-1，表示控制項使用的是文字色彩的系統色彩。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： SetTextColor](#settextcolor)的範例。

## <a name="ctreectrlsetcheck"></a><a name="setcheck"></a> CTreeCtrl：： SetCheck

呼叫這個成員函式，以設定樹狀目錄控制項專案的檢查狀態。

```
BOOL SetCheck(
    HTREEITEM hItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要接收檢查狀態變更的 HTREEITEM。

*來*<br/>
指出是否要檢查或取消選取樹狀目錄控制項專案。 依預設， `SetCheck` 會設定要檢查的專案。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

核取樹狀目錄控制項專案時 ( *來* 設為 TRUE) ，此專案會出現連續的核取記號。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]

### <a name="example"></a>範例

若要使用核取方塊，請在填入樹狀目錄控制項之前，先設定 TVS_CHECKBOXES。

[!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]

## <a name="ctreectrlsetextendedstyle"></a><a name="setextendedstyle"></a> CTreeCtrl：： SetExtendedStyle

設定目前樹狀檢視控制項的延伸樣式。

```
DWORD SetExtendedStyle(
    DWORD dwExMask,
    DWORD dwExStyles);
```

### <a name="parameters"></a>參數

*dwExMask*\
在位元遮罩，指定目前樹狀檢視控制項中的哪些樣式受此方法影響。 如果此參數為零，則會忽略它，並將 *dwExStyles* 參數的值指派給樹狀檢視控制項。 指定零個或一個位元組合 (或在 [樹狀檢視控制項擴充樣式](/windows/win32/Controls/tree-view-control-window-extended-styles)中所描述的樣式) 。

*dwExStyles*\
在位元遮罩，指定要設定或清除的目前樹狀檢視控制項中的樣式。 若要設定樣式的組合，請指定位元組合 (或在 [樹狀檢視控制項擴充樣式](/windows/win32/Controls/tree-view-control-window-extended-styles)中所描述的樣式) 。 若要清除一組樣式，請指定零。

### <a name="return-value"></a>傳回值

值，包含先前的擴充控制項樣式。

### <a name="remarks"></a>備註

此方法會清除 *dwExMask* 參數中指定的樣式，然後設定 *dwExStyles* 參數中指定的樣式。 只有對應至 *dwExMask* 中位的擴充樣式會變更。

這個方法會傳送 [TVM_SETEXTENDEDSTYLE](/windows/win32/Controls/tvm-setextendedstyle) 的訊息，如 Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例 `m_treeCtrl` 會定義用來存取目前樹狀檢視控制項的變數。 程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會將 TVS_EX_AUTOHSCROLL 擴充樣式加入至目前的樹狀檢視控制項。 在程式碼範例的先前部分（未顯示）中，我們建立了一個樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及這些州城市的樹狀專案。 我們刻意讓樹狀檢視控制項變窄，讓它必須自動滾動以顯示具有焦點的樹狀目錄專案。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]

## <a name="ctreectrlsetimagelist"></a><a name="setimagelist"></a> CTreeCtrl：： SetImageList

呼叫此函式以設定樹狀檢視控制項的一般或狀態影像清單，然後使用新的影像來重新繪製控制項。

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
要指派之影像清單的指標。 如果 *pImageList* 為 Null，則會從樹狀檢視控制項中移除所有影像。

*nImageListType*<br/>
要設定之影像清單的類型。 影像清單可以是下列其中一個值：

- TVSIL_NORMAL 設定一般影像清單，其中包含樹狀檢視專案的已選取和 nonselected 影像。 您必須針對重迭影像使用此狀態。

- TVSIL_STATE 設定狀態影像清單，其中包含使用者定義狀態之樹狀檢視專案的影像。

### <a name="return-value"></a>傳回值

上一個影像清單的指標（如果有的話）：否則為 Null。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： GetImageList](#getimagelist)的範例。

## <a name="ctreectrlsetindent"></a><a name="setindent"></a> CTreeCtrl：： SetIndent

呼叫此函式可為樹狀檢視控制項設定縮排的寬度，並重新繪製控制項以反映新的寬度。

```cpp
void SetIndent(UINT nIndent);
```

### <a name="parameters"></a>參數

*nIndent*<br/>
縮排的寬度（以圖元為單位）。 如果 *nIndent* 小於系統定義的最小寬度，則會將新寬度設定為系統定義的最小值。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： setindent](#getindent)的範例。

## <a name="ctreectrlsetinsertmark"></a><a name="setinsertmark"></a> CTreeCtrl：： SetInsertMark

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_SETINSERTMARK](/windows/win32/Controls/tvm-setinsertmark)的行為。

```
BOOL SetInsertMark(
    HTREEITEM hItem,
    BOOL fAfter = TRUE);
```

### <a name="parameters"></a>參數

*hItem*<br/>
HTREEITEM，指定將放置插入標記的專案。 如果這個引數為 Null，則會移除插入標記。

*fAfter*<br/>
布林值，指定插入標記是放置在指定的專案之前或之後。 如果這個引數不是零，則插入標記將放置在專案之後。 如果這個引數為零，則會在專案之前放置插入標記。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]

## <a name="ctreectrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a> CTreeCtrl：： SetInsertMarkColor

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_SETINSERTMARKCOLOR](/windows/win32/Controls/tvm-setinsertmarkcolor)的行為。

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>參數

*clrNew*<br/>
包含新插入標記色彩的 COLORRE光圈值。

### <a name="return-value"></a>傳回值

COLORRE光圈值，其中包含先前的插入標記色彩。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： GetInsertMarkColor](#getinsertmarkcolor)的範例。

## <a name="ctreectrlsetitem"></a><a name="setitem"></a> CTreeCtrl：： SetItem

呼叫此函式可設定指定樹狀檢視專案的屬性。

```
BOOL SetItem(TVITEM* pItem);

BOOL SetItem(
    HTREEITEM hItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);
```

### <a name="parameters"></a>參數

*pItem*<br/>
[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)結構的指標，其中包含新的專案屬性，如 Windows SDK 所述。

*hItem*<br/>
要設定其屬性之專案的控制碼。 請參閱 `hItem` `TVITEM` Windows SDK 中結構的成員。

*nMask*<br/>
指定要設定之屬性的整數。 請參閱 `mask` 結構的成員 `TVITEM` 。

*lpszItem*<br/>
字串的位址，其中包含專案的文字。

*n*<br/>
樹狀檢視控制項影像清單中專案影像的索引。 請參閱 `iImage` 結構的成員 `TVITEM` 。

*nSelectedImage*<br/>
樹狀檢視控制項影像清單中專案的已選取影像索引。 請參閱 `iSelectedImage` 結構的成員 `TVITEM` 。

*nState*<br/>
指定專案狀態的值。 請參閱 `State` 結構的成員 `TVITEM` 。

*nStateMask*<br/>
指定要設定的狀態。 請參閱 `stateMask` 結構的成員 `TVITEM` 。

*lParam*<br/>
與專案相關聯之指標大小的應用程式特定值。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

在 `TVITEM` 結構中， `hItem` 成員會識別專案，而成員會 `mask` 指定要設定的屬性。

如果 `mask` 成員或 *nMask* 參數指定 TVIF_TEXT 值，則 `pszText` 成員或 *lpszItem* 是以 null 終止之字串的位址，而且 `cchTextMax` 會忽略該成員。 如果 `mask` (或 *NMask*) 指定 TVIF_STATE 值，則 `stateMask` 成員或 *nStateMask* 參數會指定要變更的專案狀態，而 `state` 成員或 *nState* 參數會包含這些狀態的值。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]

## <a name="ctreectrlsetitemdata"></a><a name="setitemdata"></a> CTreeCtrl：： SetItemData

呼叫此函式可設定與指定之專案相關聯的應用程式特定值。

```
BOOL SetItemData(
    HTREEITEM hItem,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要抓取其資料的專案之控制碼。

*dwData*<br/>
與 *hItem*指定的專案相關聯之指標大小的應用程式特定值。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]

## <a name="ctreectrlsetitemexpandedimageindex"></a><a name="setitemexpandedimageindex"></a> CTreeCtrl：： SetItemExpandedImageIndex

設定當目前樹狀檢視控制項的指定專案處於展開狀態時，所要顯示的影像索引。

```
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,
    int iExpandedImage);
```

### <a name="parameters"></a>參數

*hItem*\
在樹狀檢視控制項專案的控制碼。

*iExpandedImage*\
在當指定的專案處於展開狀態時，所要顯示的影像索引。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送 [TVM_SETITEM](/windows/win32/Controls/tvm-setitem) 的訊息，如 Windows SDK 中所述。 這個方法會將 *iExpandedImage* 參數指派給 `iExpandedImage` [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) 結構的成員，然後在訊息中使用該結構。

### <a name="example"></a>範例

下列程式碼範例 `m_treeCtrl` 會定義用來存取目前樹狀檢視控制項的變數。 程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例是一個簡單的測試，可判斷 [CTreeCtrl：： GetItemExpandedImageIndex](#getitemexpandedimageindex) 方法是否傳回 [CTreeCtrl：： SetItemExpandedImageIndex](#setitemexpandedimageindex) 方法所設定的值。 在程式碼範例的先前部分（未顯示）中，我們建立了一個樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及這些州城市的樹狀專案。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]

## <a name="ctreectrlsetitemheight"></a><a name="setitemheight"></a> CTreeCtrl：： SetItemHeight

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_SETITEMHEIGHT](/windows/win32/Controls/tvm-setitemheight)的行為。

```
SHORT SetItemHeight(SHORT cyHeight);
```

### <a name="parameters"></a>參數

*cyHeight*<br/>
針對樹狀檢視中的每個專案指定新的高度（以圖元為單位）。 如果這個引數小於影像的高度，則會設定為影像的高度。 如果這個引數不是偶數，則會向下舍入至最接近的偶數值。 如果這個引數是-1，控制項將會還原為使用其預設專案高度。

### <a name="return-value"></a>傳回值

專案的先前高度（以圖元為單位）。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： GetItemHeight](#getitemheight)的範例。

## <a name="ctreectrlsetitemimage"></a><a name="setitemimage"></a> CTreeCtrl：： SetItemImage

將影像與專案產生關聯。

```
BOOL SetItemImage(
    HTREEITEM hItem,
    int nImage,
    int nSelectedImage);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要設定其影像之專案的控制碼。

*n*<br/>
樹狀檢視控制項影像清單中專案影像的索引。

*nSelectedImage*<br/>
樹狀檢視控制項影像清單中專案的已選取影像索引。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

樹狀檢視控制項中的每個專案都可以有一對與其相關聯的點陣圖影像。 影像會出現在專案標籤的左邊。 當選取專案時，就會顯示一個影像，而另一個影像則會在未選取專案時顯示。 例如，在選取專案時，專案可能會顯示已開啟的資料夾，並顯示未選取的資料夾。

呼叫此函式可在樹狀檢視控制項的影像清單中，設定專案影像的索引和其選取的影像。

如需映射的詳細資訊，請參閱 [CImageList](../../mfc/reference/cimagelist-class.md)。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： GetItemImage](#getitemimage)的範例。

## <a name="ctreectrlsetitemstate"></a><a name="setitemstate"></a> CTreeCtrl：： SetItemState

設定 *hItem*所指定之專案的狀態。

```
BOOL SetItemState(
    HTREEITEM hItem,
    UINT nState,
    UINT nStateMask);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要設定其狀態之專案的控制碼。

*nState*<br/>
指定專案的新狀態。

*nStateMask*<br/>
指定要變更的狀態。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如需狀態的詳細資訊，請參閱 [CTreeCtrl：： GetItem](#getitem)。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： GetItemState](#getitemstate)的範例。

## <a name="ctreectrlsetitemstateex"></a><a name="setitemstateex"></a> CTreeCtrl：： SetItemStateEx

在目前的樹狀檢視控制項中，設定指定之專案的擴充狀態。

```
BOOL SetItemStateEx(
    HTREEITEM hItem,
    UINT uStateEx);
```

### <a name="parameters"></a>參數

*hItem*\
在樹狀檢視控制項專案的控制碼。

*uStateEx*\
在專案的擴充狀態。 如需詳細資訊，請參閱 `uStateEx` [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) 結構的成員。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送 [TVM_SETITEM](/windows/win32/Controls/tvm-setitem) 的訊息，如 Windows SDK 中所述。 這個方法會將 *uStateEx* 參數指派給 `uStateEx` [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) 結構的成員，然後在訊息中使用該結構。

### <a name="example"></a>範例

下列程式碼範例 `m_treeCtrl` 會定義用來存取目前樹狀檢視控制項的變數。 程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會將樹狀檢視專案設定為停用狀態。 在程式碼範例的先前部分（未顯示）中，我們建立了一個樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及這些州城市的樹狀專案。 此程式碼範例會將 [賓夕法尼亞] 節點設定為 [已停用] 狀態。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]

## <a name="ctreectrlsetitemtext"></a><a name="setitemtext"></a> CTreeCtrl：： SetItemText

設定 *hItem*所指定之專案的文字。

```
BOOL SetItemText(
    HTREEITEM hItem,
    LPCTSTR lpszItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要設定其文字之專案的控制碼。

*lpszItem*<br/>
字串的位址，其中包含專案的新文字

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]

## <a name="ctreectrlsetlinecolor"></a><a name="setlinecolor"></a> CTreeCtrl：： SetLineColor

呼叫這個成員函式，以設定樹狀檢視控制項的目前線條色彩。

```
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```

### <a name="parameters"></a>參數

*clrNew*<br/>
新的線條色彩。

### <a name="return-value"></a>傳回值

先前的線條色彩。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_SETLINECOLOR](/windows/win32/Controls/tvm-setlinecolor)的行為。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]

## <a name="ctreectrlsetscrolltime"></a><a name="setscrolltime"></a> CTreeCtrl：： SetScrollTime

呼叫這個成員函式，以設定樹狀檢視控制項的最大滾動時間。

```
UINT SetScrollTime(UINT uScrollTime);
```

### <a name="parameters"></a>參數

*uScrollTime*<br/>
新的最大滾動時間（以毫秒為單位）。 如果這個值小於100，則會進位到100。

### <a name="return-value"></a>傳回值

先前的最大滾動時間（以毫秒為單位）。

### <a name="remarks"></a>備註

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_SETSCROLLTIME](/windows/win32/Controls/tvm-setscrolltime)的行為。

## <a name="ctreectrlsettextcolor"></a><a name="settextcolor"></a> CTreeCtrl：： SetTextColor

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_SETTEXTCOLOR](/windows/win32/Controls/tvm-settextcolor)的行為。

```
COLORREF SetTextColor(COLORREF clr);
```

### <a name="parameters"></a>參數

*Clr*<br/>
包含新文字色彩的 COLORRE光圈值。 如果這個引數是-1，則控制項會還原為使用文字色彩的系統色彩。

### <a name="return-value"></a>傳回值

COLORRE光圈值，表示先前的文字色彩。 如果這個值是-1，表示控制項使用的是文字色彩的系統色彩。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]

## <a name="ctreectrlsettooltips"></a><a name="settooltips"></a> CTreeCtrl：： SetToolTips

此成員函式會依照 Windows SDK 所述，執行 Win32 訊息 [TVM_SETTOOLTIPS](/windows/win32/Controls/tvm-settooltips)的行為。

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>參數

*pWndTip*<br/>
樹狀目錄控制項將使用的 [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) 物件指標。

### <a name="return-value"></a>傳回值

[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)物件的指標，其中包含控制項先前使用的工具提示，如果先前未使用工具提示，則為 Null。

### <a name="remarks"></a>備註

若要使用工具提示，請在建立物件時指出 TVS_NOTOOLTIPS 的樣式 `CTreeCtrl` 。

### <a name="example"></a>範例

  請參閱 [CTreeCtrl：： GetToolTips](#gettooltips)的範例。

## <a name="ctreectrlshowinfotip"></a><a name="showinfotip"></a> CTreeCtrl：： ShowInfoTip

顯示目前樹狀檢視控制項中所指定專案的提示。

```cpp
void ShowInfoTip(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*\
在控制項中樹狀檢視專案的控制碼。 如需詳細資訊，請參閱 `hItem` [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) 結構的成員。

### <a name="remarks"></a>備註

如需工具提示與提示之間差異的詳細資訊，請搜尋 [Microsoft 開發人員網路](https://go.microsoft.com/fwlink/p/?linkid=56322)上的「工具提示和提示」主題。

這個方法會傳送 [TVM_SHOWINFOTIP](/windows/win32/Controls/tvm-showinfotip) 的訊息，如 Windows SDK 中所述。

## <a name="ctreectrlsortchildren"></a><a name="sortchildren"></a> CTreeCtrl：： SortChildren

呼叫此函式，以依字母順序排序樹狀檢視控制項中指定之父專案的子專案。

```
BOOL SortChildren(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要排序其子專案的父專案的控制碼。 如果 *hItem* 為 Null，則會從樹狀結構的根目錄進行排序。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

`SortChildren` 將不會在樹狀結構中遞迴;只會排序 *hItem* 的直屬子系。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]

## <a name="ctreectrlsortchildrencb"></a><a name="sortchildrencb"></a> CTreeCtrl：： SortChildrenCB

呼叫此函式，使用會比較專案的應用程式定義回呼函式來排序樹狀檢視專案。

```
BOOL SortChildrenCB(LPTVSORTCB pSort);
```

### <a name="parameters"></a>參數

*pSort*<br/>
[TVSORTCB](/windows/win32/api/commctrl/ns-commctrl-tvsortcb)結構的指標。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果第一個專案應該在第二個專案之前，則結構的比較函式 `lpfnCompare` 必須傳回負值，如果第一個專案應在第二個專案之後，則為正值，如果兩個專案相等，則為零。

*LParam1*和*lParam2*參數會對應至所 `lParam` 比較的兩個專案之[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)結構的成員。 *LParamSort*參數對應至結構的 `lParam` 成員 `TV_SORTCB` 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]

[!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]

## <a name="see-also"></a>另請參閱

[MFC 範例 CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[CWnd 類別](../../mfc/reference/cwnd-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[CImageList 類別](../../mfc/reference/cimagelist-class.md)
